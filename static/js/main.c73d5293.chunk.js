(this["webpackJsonpsorta-cart"]=this["webpackJsonpsorta-cart"]||[]).push([[0],{258:function(e,t,a){e.exports=a(359)},267:function(e,t,a){},358:function(e,t,a){},359:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(17),o=a.n(c),l=a(26),i=(a(267),a(60)),s=a(82),u=a(416),m=a(408),d=a(125),p=a.n(d),f=a(238),h=Object(f.a)({palette:{type:"dark",primary:{main:"#556cd6"},secondary:{main:"#FF4081"},error:{main:p.a.A400}}}),g=Object(f.a)({palette:{type:"light",primary:{main:"#556cd6"},secondary:{main:"#FF4081"},error:{main:p.a.A400}}}),b=a(83),E=a.n(b),y=a(39),v="https://api.marshcoop.org",O=.06175,x="".concat((100*O).toFixed(3),"%"),j={id:"new",status:"new",payment_status:"balance_due",shipment_status:"backorder",total:0,item_count:0,subtotal:0,name:"",email:"",phone:"",address:"",notes:"",createdAt:"",updatedAt:"",OrderLineItems:[]},k="https://js.squareupsandbox.com/v2/paymentform",S="sandbox-sq0idb-JHHiCIhNvJdJH4pJxLaDzA",C="D2MV0BZC6EV9Y",w=function(e){return{type:"SET",user:e}},N=function(e){return{type:"SET_ERROR",error:e}},I=function(e){return{type:"SET_FETCHING",isFetching:e}},F={id:void 0,email:void 0,token:void 0,role:void 0},T=function(e,t){return function(a){return E.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n){a(I(!0)),fetch("".concat(v,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return e.json()})).then((function(e){"ok"===e.msg&&e.user&&e.user.token?(localStorage&&localStorage.setItem("token",e.user.token),a(w(e.user))):a(N({error:"error",reason:e.message}))})).catch((function(e){console.log("login error:",e),a(N({error:"error",reason:"unable to login right now :("}))})).finally((function(){a(I(!1)),n()}))})));case 1:case"end":return n.stop()}}))}},R={dark_mode:"false"},q=function(e){return{type:"SET_PREFERENCES",preferences:e}},_=function(e){return{type:"SET_FETCHING_PREFERENCES",isFetching:e}},B=a(12),D=a(222),A=a.n(D),z=a(219),P=a(411),W=a(159),L=a(218),H=a(84),M=a(201),G=a(139),J=a.n(G),U=a(235),V=a.n(U),$=(a(236),a(140)),Y=a.n($),K=a(6),Z=a(123),Q=a(220),X=a(205),ee=a(409),te=Object(K.a)({paper:{border:"1px solid #d3d4d5"}})((function(e){return r.a.createElement(Z.a,Object.assign({elevation:0,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},e))})),ae=Object(K.a)((function(e){return{root:{}}}))(Q.a);var ne=Object(l.b)((function(e){return{preferencesService:e.preferences.preferencesService,userService:e.session.userService}}),(function(e){return{setPreferences:function(t){return e(function(e){return function(t){return E.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",new Promise((function(a,n){t(_(!0)),e?(localStorage&&localStorage.setItem("preferences",JSON.stringify(e)),t(q(e))):t(q(R)),t(_(!1)),a()})));case 1:case"end":return a.stop()}}))}}(t))},logout:function(){return e((function(e){return E.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){e(I(!0));var a=localStorage&&localStorage.getItem("token");fetch("".concat(v,"/logout"),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)}}).catch(console.warn).finally((function(){localStorage&&localStorage.removeItem("token"),e(w(F)),e(I(!1)),t()}))})));case 1:case"end":return t.stop()}}))}))}}}))(Object(s.f)((function(e){var t=e.anchorEl,a=e.setAnchorEl,c=e.preferencesService,o=e.setPreferences,l=e.userService,i=e.logout,s=e.history,u=Object(n.useState)(null),m=Object(B.a)(u,2),d=m[0],p=m[1];Object(n.useEffect)((function(){!c.isFetching&&c.preferences&&null===d&&p("true"===c.preferences.dark_mode)}),[c]),Object(n.useEffect)((function(){c&&c.preferences&&null!==d&&"true"===c.preferences.dark_mode!==d&&o({dark_mode:d?"true":"false"})}),[d]);var f=function(){a(null)},h=!!(l&&l.user&&l.user.id),g=!(!l||!l.user||"admin"!==l.user.role);return r.a.createElement(r.a.Fragment,null,r.a.createElement(te,{id:"user-menu",anchorEl:t,keepMounted:!0,open:Boolean(t),onClose:f},h&&r.a.createElement(X.a,{primary:l.user&&l.user.email,secondary:l.user&&l.user.role,style:{padding:"0 16px 6px",borderBottom:"thin solid #f60"}}),g&&r.a.createElement(ae,{onClick:function(){f(),window.location.assign("https://admin.marshcoop.org/")}},r.a.createElement(X.a,{primary:"ADMIN"})),h&&r.a.createElement(ae,{onClick:function(){i(),f()}},r.a.createElement(X.a,{primary:"Log out"})),!h&&r.a.createElement(ae,{onClick:function(){s.push("/login"),f()}},r.a.createElement(X.a,{primary:"Sign in"})),!h&&r.a.createElement(ae,{onClick:function(){s.push("/register"),f()}},r.a.createElement(X.a,{primary:"Register"})),r.a.createElement(ae,{onClick:function(){return p((function(e){return!e}))}},r.a.createElement(X.a,null,r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},r.a.createElement("span",null,"Dark Theme"),r.a.createElement(ee.a,{checked:null!==d&&void 0!==d&&d,value:"useDarkTheme",inputProps:{"aria-label":"secondary checkbox"}}))))))}))),re=a(420),ce=a(232),oe=a(239),le=a(233),ie=a(240),se=a(16),ue=(a(357),new(function(e){function t(){var e;return Object(ce.a)(this,t),(e=Object(oe.a)(this,Object(le.a)(t).call(this,"SortaCartDatabase"))).cart=void 0,e.version(1).stores({cart:"++id"}),e.cart=e.table("cart"),e}return Object(ie.a)(t,e),t}(se.a))),me=function(){var e=Object(n.useState)({status:"loading"}),t=Object(B.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)((function(){ue.cart.toArray().then((function(e){return r({status:"loaded",payload:{line_items:e}})})).catch((function(e){r({status:"error",error:e})})),ue.on("changes",(function(e){e.find((function(e){return"cart"===e.table}))&&ue.cart.toArray().then((function(e){console.log("[useCartService] db changes!! "),r({status:"loaded",payload:{line_items:e}})})).catch((function(e){r({status:"error",error:e})}))}))}),[]),a},de=function(){return ue.cart.count().catch((function(e){return console.warn("[useCartItemCount] caught error:",e),0}))},pe=function(){var e=Object(n.useState)(0),t=Object(B.a)(e,2),a=t[0],r=t[1],c=function(e){e.find((function(e){return"cart"===e.table}))&&de().then((function(e){return r(e)}))};return Object(n.useEffect)((function(){return de().then((function(e){return r(e)})),ue.on("changes",c),function(){return ue.on("changes").unsubscribe(c)}}),[]),a},fe=function(e){var t={quantity:1,total:+e.ws_price,selected_unit:"CS",price:+e.ws_price,description:"".concat(e.name," ").concat(e.description).trim(),kind:"product",vendor:e.vendor,data:{product:e}};ue.cart.add(t).catch((function(e){return console.warn("[addToCart] caught error:",e)}))},he=function(e){ue.cart.delete(e).catch((function(e){return console.warn("[removeItemFromCart] caught error:",e)}))},ge=function(){ue.cart.clear().catch((function(e){console.warn("[emptyCart] caught error:",e)}))},be=function(e){e&&e.id&&ue.cart.update(e.id,e).catch((function(e){return console.warn("[updateLineItem] caught error:",e)}))},Ee=a(108),ye=a(230),ve=a(404),Oe=a(212),xe=a(186),je=a(183),ke=a(207),Se=a(187),Ce=a(214),we=a(200),Ne=a(164),Ie=a(234),Fe=a.n(Ie),Te=Object(ye.a)((function(e){return Object(ve.a)({root:{maxWidth:"95vw",padding:e.spacing(1),borderCollapse:"separate","& td":{border:"none"}},qtyinput:{width:"50px"}})}));function Re(e){return void 0===e?"$0.00":"$".concat("string"===typeof e?parseFloat(e).toFixed(2):e.toFixed(2))}function qe(e){var t=e.data&&e.data.product;return t?"EA"===e.selected_unit&&t.u_price?e.quantity*parseFloat(t.u_price):e.quantity*parseFloat(t.ws_price):e.quantity*(e.price||0)}var _e=Object(s.f)((function(e){var t=Te(),a=e.checkout,c=e.summary,o=e.setOrder,l=e.line_items.map((function(e){return e.total})).reduce((function(e,t){return e+t}),0),i=O*l,s=i+l;return Object(n.useEffect)((function(){o&&o((function(e){var t=Object(y.a)({},e,{subtotal:+l.toFixed(2),total:+s.toFixed(2),item_count:e.OrderLineItems.filter((function(e){return"product"===e.kind})).length,OrderLineItems:[].concat(Object(Ee.a)(e.OrderLineItems.filter((function(e){return"tax"!==e.kind}))),[{kind:"tax",description:x,quantity:1,total:+i.toFixed(2)}])});return console.log("cartTable fx newOrder:",t),t}))}),[o,l,i,s]),r.a.createElement(Oe.a,{className:t.root,"aria-label":"cart"},r.a.createElement(ke.a,null,r.a.createElement(Se.a,null,r.a.createElement(je.a,{align:"center"}),r.a.createElement(je.a,null,"Description"),r.a.createElement(je.a,{align:"right"},"Price"),r.a.createElement(je.a,{align:"center"},"Unit"),r.a.createElement(je.a,{align:"right"},"Qty."),r.a.createElement(je.a,{align:"right"},"Total"))),r.a.createElement(xe.a,null,e.line_items.map((function(e,a){return r.a.createElement(Se.a,{key:"li".concat(a)},r.a.createElement(je.a,{align:"center"},!c&&r.a.createElement(L.a,{"aria-label":"remove line item",title:"REMOVE LINE ITEM"},r.a.createElement(W.a,{"aria-label":"delete",size:"small",onClick:function(t){var a;(a=e.id)&&he(a)}},r.a.createElement(Fe.a,{fontSize:"inherit"})))),r.a.createElement(je.a,null,e.description),r.a.createElement(je.a,{align:"right"},r.a.createElement("div",null,Re(e.price)),r.a.createElement("div",null,function(e){var t=e.data&&e.data.product;if(t){var a=[];return t.pk&&1!==t.pk&&a.push(t.pk),t.size&&a.push(t.size),a.join(" / ")}return""}(e))),r.a.createElement(je.a,{align:"center"},c?e.selected_unit:e.data&&e.data.product&&e.data.product.u_price&&e.data.product.u_price!==e.data.product.ws_price?r.a.createElement(Ne.a,{value:e.selected_unit,onChange:function(t){return function(e,t){e.selected_unit=t,e.total=qe(e),be(e)}(e,t.target.value)},margin:"dense"},r.a.createElement(Q.a,{value:"CS"},"Case"),r.a.createElement(Q.a,{value:"EA"},"Each")):e.data&&e.data.product&&"CS"===e.data.product.unit_type?"Case":"Each"),r.a.createElement(je.a,{align:"right"},c?e.quantity:r.a.createElement(we.a,{className:t.qtyinput,type:"number",InputLabelProps:{shrink:!0},margin:"dense",fullWidth:!0,value:e.quantity,onChange:function(t){return function(e,t){e.quantity=t>0?t:1,e.total=qe(e),be(e)}(e,parseInt(t.target.value))},inputProps:{min:"1",step:"1"}})),r.a.createElement(je.a,{align:"right"},Re(e.total)))})),r.a.createElement(Se.a,null,r.a.createElement(je.a,{rowSpan:3,colSpan:3}),r.a.createElement(je.a,null,"Subtotal"),r.a.createElement(je.a,{align:"right"},e.line_items&&e.line_items.length),r.a.createElement(je.a,{align:"right"},Re(l))),r.a.createElement(Se.a,null,r.a.createElement(je.a,null,"Tax"),r.a.createElement(je.a,{align:"right"},x),r.a.createElement(je.a,{align:"right"},Re(i))),r.a.createElement(Se.a,null,r.a.createElement(je.a,null,"Total"),r.a.createElement(je.a,{align:"right",colSpan:2},r.a.createElement("b",null,Re(s))))),!c&&!a&&r.a.createElement(Ce.a,null,r.a.createElement(Se.a,null,r.a.createElement(je.a,{colSpan:3,align:"left"},e.emptyCartAndCloseDrawer&&r.a.createElement(M.a,{variant:"contained",color:"secondary",onClick:e.emptyCartAndCloseDrawer},"Empty Cart")),r.a.createElement(je.a,{colSpan:3,align:"right"},r.a.createElement(M.a,{variant:"contained",color:"primary",onClick:function(){return e.history.push("/checkout")}},"Checkout")))))})),Be=a(74),De=a(138),Ae=a.n(De),ze=a(410),Pe=a(417),We=Object(ye.a)((function(e){return{form:{width:"100%",marginTop:e.spacing(1),display:"flex",flexDirection:"column",justifyContent:"center"},title:{display:"flex",justifyContent:"space-between",alignItems:"flex-end"},submit:{margin:e.spacing(3,0,2)}}}));var Le=Object(l.b)((function(e,t){return{userService:e.session.userService}}),(function(e,t){return{login:function(t,a){return e(T(t,a))}}}))(Object(s.f)((function(e){var t=e.userService,a=e.showTitle,c=e.onLoginFn,o=e.history,l=We(),i=Object(n.useState)(""),s=Object(B.a)(i,2),u=s[0],m=s[1];return Object(n.useEffect)((function(){t.user&&!t.isFetching&&t.user.role&&(console.log("we gotta user!",t.user),c?c():o.push("/"))}),[t,c,o]),r.a.createElement(ze.a,{maxWidth:"sm"},r.a.createElement("form",{onSubmit:function(t){t.preventDefault(),m("");var a=t.currentTarget,n=a.elements.namedItem("email"),r=a.elements.namedItem("password");n&&n.value.length>0&&r&&r.value.length>0&&e.login(n.value,r.value)},className:l.form},a&&r.a.createElement("div",{className:l.title},r.a.createElement(H.a,{variant:"h2",display:"block"},"Sign In")),r.a.createElement(we.a,{label:"email",name:"email",type:"text",autoFocus:!0,fullWidth:!0,required:!0}),r.a.createElement(we.a,{label:"password",name:"password",type:"password",fullWidth:!0,required:!0}),r.a.createElement("div",null,r.a.createElement(M.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",disabled:e.userService.isFetching,className:l.submit},"Login")),r.a.createElement(Pe.a,{color:"error.main"},e.userService.error&&r.a.createElement(r.a.Fragment,null,r.a.createElement(H.a,{variant:"overline",display:"block"},"onoz! an error!"),r.a.createElement(H.a,{variant:"body1",display:"block",gutterBottom:!0},e.userService.error.reason)),u&&r.a.createElement(r.a.Fragment,null,r.a.createElement(H.a,{variant:"overline",display:"block"},"onoz! an error!"),r.a.createElement(H.a,{variant:"body1",display:"block",gutterBottom:!0},u)))))}))),He=Object(ye.a)((function(e){return Object(ve.a)({root:Object(Be.a)({display:"flex",flexDirection:"column",padding:e.spacing(2),alignItems:"center",justifyContent:"center",height:"100%",width:"350px"},e.breakpoints.down("xs"),{width:"100%",padding:e.spacing(1)}),optItem:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:e.spacing(2),width:"100%"}})}));var Me=Object(s.f)((function(e){var t=He(),a=Object(n.useState)(!1),c=Object(B.a)(a,2),o=c[0],l=c[1];return r.a.createElement("div",{className:t.root},o&&r.a.createElement(L.a,{"aria-label":"back",title:"back"},r.a.createElement(W.a,{onClick:function(){return l(!1)}},r.a.createElement(Ae.a,null))),!o&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:t.optItem},r.a.createElement(H.a,{variant:"body1",gutterBottom:!0},"Already a member?"),r.a.createElement(M.a,{variant:"contained",color:"primary",onClick:function(){return l(!0)}},"Sign In")),r.a.createElement("div",{className:t.optItem},r.a.createElement(H.a,{variant:"body1",gutterBottom:!0},"Want to become a member?"),r.a.createElement(M.a,{color:"secondary",onClick:function(){return e.history.push("/register")}},"Register"))),o&&r.a.createElement(Le,null))}));var Ge=Object(l.b)((function(e){return{userService:e.session.userService}}),{})((function(e){var t=e.open,a=e.setOpen,n=e.userService,c=me(),o=!!(n&&n.user&&n.user.id);return r.a.createElement(re.a,{anchor:"right",open:t,onClose:function(){return a(!t)}},"loaded"!==c.status&&"Loading...",o?"loaded"===c.status&&c.payload.line_items.length>0&&r.a.createElement(_e,{line_items:c.payload.line_items,emptyCartAndCloseDrawer:function(e){window.confirm("Are you sure?")&&(ge(),a(!1))}}):r.a.createElement(Me,null))})),Je={a:"Artificial ingredients",c:"Low carb",d:"Dairy free",f:"Food Service items",g:"Gluten free",k:"Kosher",l:"Low sodium/no salt",m:"Non-GMO Project Verified",og:"Organic",r:"Refined sugar",v:"Vegan",w:"Wheat free",ft:"Fair Trade",n:"Natural",s:"Specialty Only",y:"Yeast free",1:"100% organic",2:"95%+ organic",3:"70%+ organic"};var Ue=Object(s.f)((function(e){var t=Object(n.createRef)(),a=pe(),c=Object(n.useState)(!1),o=Object(B.a)(c,2),l=o[0],i=o[1],s=r.a.useState(null),u=Object(B.a)(s,2),m=u[0],d=u[1],p={icon:function(){return r.a.createElement(P.a,{badgeContent:a,max:99,color:"primary"},r.a.createElement(J.a,null))},tooltip:"Cart",isFreeAction:!0,onClick:function(){return i(!l)}},f={icon:function(){return r.a.createElement(Y.a,null)},tooltip:"User",isFreeAction:!0,onClick:function(e){d(e.currentTarget)}},h=Object(n.useState)([f]),g=Object(B.a)(h,2),b=g[0],E=g[1];Object(n.useEffect)((function(){E(a?[p,f]:[f])}),[a]);var y=Object(n.useState)((function(){fetch("".concat(v,"/categories")).then((function(e){return e.json()})).then((function(e){return j(e)})).catch(console.warn)})),O=Object(B.a)(y,2),x=O[0],j=O[1],k=Object(n.useState)((function(){fetch("".concat(v,"/sub_categories")).then((function(e){return e.json()})).then((function(e){return w(e)})).catch(console.warn)})),S=Object(B.a)(k,2),C=S[0],w=S[1],N=e.match&&e.match.params&&e.match.params.cat&&[decodeURIComponent(e.match.params.cat)],I=e.match&&e.match.params&&e.match.params.subcat&&[decodeURIComponent(e.match.params.subcat)];return r.a.createElement(r.a.Fragment,null,r.a.createElement(A.a,{tableRef:t,columns:[{title:"category",field:"category",type:"string",lookup:x,filterPlaceholder:"filter",defaultFilter:N},{title:"sub category",field:"sub_category",type:"string",lookup:C,editComponent:function(e){return console.log("editComponent arg:",e),r.a.createElement(r.a.Fragment,null,"subcat")},filterPlaceholder:"filter",defaultFilter:I},{title:"description",field:"description",type:"string",filtering:!1,render:function(e){return e.name?"".concat(e.name," -- ").concat(e.description):e.description}},{title:"pk",field:"pk",type:"numeric",filtering:!1},{title:"size",field:"size",type:"string",filtering:!1},{title:"unit type",field:"unit_type",type:"string",lookup:{CS:"Case",EA:"Each"},filterPlaceholder:"filter"},{title:"price",field:"ws_price",type:"currency",filtering:!1},{title:"unit price",field:"u_price",type:"currency",filtering:!1,render:function(e){return e.ws_price!==e.u_price?"$".concat(e.u_price):""}},{title:"properties",field:"codes",type:"string",lookup:Je,filterPlaceholder:"filter",render:function(e){return e.codes.split(", ").map((function(e,t){return Je[e]?r.a.createElement(z.a,{label:Je[e],style:{margin:5},size:"small",key:"pprop".concat(t)}):""}))}},{title:void 0,field:void 0,type:"string",render:function(e){var t="add to shopping cart";return r.a.createElement(L.a,{"aria-label":t,title:t},r.a.createElement(W.a,{color:"secondary",onClick:function(){fe(e),i(!0)}},r.a.createElement(V.a,null)))}},{title:"upc",field:"upc_code",type:"string",hidden:!0},{title:"id",field:"id",type:"string",hidden:!0}],data:function(e){return new Promise((function(t,a){console.log("query:",e),fetch("".concat(v,"/products"),{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){console.log("result",e),t(e)})).catch((function(e){return console.warn("onoz, caught err:",e),t({data:[],page:0,totalCount:0})}))}))},title:r.a.createElement(M.a,{variant:"text",size:"large",onClick:function(){return e.history.push("/")}},r.a.createElement(H.a,{variant:"h6"},"MARSH COOP")),options:{headerStyle:{position:"sticky",top:0},filterCellStyle:{maxWidth:"132px"},maxBodyHeight:"calc(100vh - 133px)",pageSize:50,pageSizeOptions:[50,100,500],debounceInterval:750,filtering:!0,search:!0,emptyRowsWhenPaging:!1},actions:b}),r.a.createElement(Ge,{open:l,setOpen:i}),r.a.createElement(ne,{anchorEl:m,setAnchorEl:d}))})),Ve=a(406),$e=a(372),Ye=a(413),Ke=a(169),Ze=a.n(Ke),Qe=a(412),Xe=a(184),et=a(11),tt=Object(ye.a)((function(e){return Object(ve.a)({root:{flexGrow:1,boxShadow:"none"},toolbar:{backgroundColor:e.palette.background.default,color:e.palette.text.primary},menuButton:{marginLeft:e.spacing(2)},grow:{flexGrow:1},search:Object(Be.a)({position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object(et.c)(e.palette.common.white,.15),"&:hover":{backgroundColor:Object(et.c)(e.palette.common.white,.25)},marginLeft:0,width:"100%"},e.breakpoints.up("sm"),{marginLeft:e.spacing(1),width:"auto"}),searchIcon:{width:e.spacing(7),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},inputRoot:{color:"inherit"},inputInput:Object(Be.a)({padding:e.spacing(1,1,1,7),transition:e.transitions.create("width"),width:"100%"},e.breakpoints.up("sm"),{width:120,"&:focus":{width:200}})})}));var at=Object(s.f)((function(e){var t=tt(),a=pe(),c=e.showCart,o=Object(n.useState)(!1),l=Object(B.a)(o,2),i=l[0],s=l[1],u=Object(n.useState)(null),m=Object(B.a)(u,2),d=m[0],p=m[1];return r.a.createElement(Qe.a,{position:"static",className:t.root},r.a.createElement(Xe.a,{className:t.toolbar},r.a.createElement("div",null,r.a.createElement($e.a,{in:!0},r.a.createElement(M.a,{variant:"text",size:"large",onClick:function(){return e.history.push("/")}},r.a.createElement(H.a,{variant:"h6"},"MARSH COOP")))),e.children||r.a.createElement("div",{className:t.grow},"\xa0"),c&&a>0&&r.a.createElement(W.a,{edge:"end",className:t.menuButton,color:"inherit","aria-label":"show cart",onClick:function(){return s((function(e){return!e}))}},r.a.createElement(P.a,{badgeContent:a,max:99,color:"secondary"},r.a.createElement(J.a,null))),r.a.createElement(W.a,{edge:"end",className:t.menuButton,color:"inherit","aria-label":"user menu",onClick:function(e){p(e.currentTarget)}},r.a.createElement(Y.a,null))),r.a.createElement(ne,{anchorEl:d,setAnchorEl:p}),r.a.createElement(Ge,{open:i,setOpen:s}))})),nt=Object(ye.a)((function(e){return Object(ve.a)({gridRoot:{width:"100%",overflowX:"auto",minHeight:"calc(100vh - 64px)",padding:e.spacing(2),display:"flex"},crumbz:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",flexGrow:1},gridBtn:{width:"100%",height:"100%",background:e.palette.background.paper,"&:hover":{textDecoration:"underline",cursor:"pointer"}},catHover:{"&:hover":{textDecoration:"underline",cursor:"pointer"}},catBtn:{overflow:"hidden",overflowWrap:"break-word",hyphens:"auto"}})}));var rt=Object(s.f)((function(e){var t=nt(),a=Object(n.useState)([]),c=Object(B.a)(a,2),o=c[0],l=c[1],i=Object(n.useState)(""),s=Object(B.a)(i,2),u=s[0],m=s[1],d=Object(n.useState)([]),p=Object(B.a)(d,2),f=p[0],h=p[1];return Object(n.useEffect)((function(){fetch("".concat(v,"/categories")).then((function(e){return e.json()})).then((function(e){console.log("result",e),l(Object.keys(e))})).catch((function(e){console.warn("onoz, caught err:",e),l([])}))}),[l]),Object(n.useEffect)((function(){fetch("".concat(v,"/sub_categories"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({categories:[u]})}).then((function(e){return e.json()})).then((function(e){console.log("result",e),h(Object.keys(e).map((function(e){return{name:e,label:e.split(":").join(": ").split(",").join(", ").split("/").join(" / ").split("-").join(" - ")}})))})).catch((function(e){console.warn("onoz, caught err:",e),h([])}))}),[u,h]),r.a.createElement(r.a.Fragment,null,r.a.createElement(at,{showCart:!0},u&&r.a.createElement("div",{className:t.crumbz},r.a.createElement($e.a,{in:!0},r.a.createElement(Ze.a,{fontSize:"large"})),r.a.createElement($e.a,{in:!0,style:{transitionDelay:"50ms"}},r.a.createElement(M.a,{variant:"text",size:"large",onClick:function(){return m("")}},r.a.createElement(H.a,{variant:"h6",className:u&&t.catHover},"CATEGORIES"))),r.a.createElement($e.a,{in:!0,style:{transitionDelay:"100ms"}},r.a.createElement(Ze.a,{fontSize:"large"})),r.a.createElement($e.a,{in:!0,style:{transitionDelay:"150ms"}},r.a.createElement(H.a,{variant:"h6"},u.toUpperCase())))),r.a.createElement(Ve.a,{container:!0,spacing:4,justify:"center",className:t.gridRoot},o&&!u&&o.map((function(e,a){return r.a.createElement(Ye.a,{in:!0,style:{transitionDelay:"".concat(50*a,"ms")},key:"lb".concat(a)},r.a.createElement(Ve.a,{item:!0,xs:12,sm:4,md:3,lg:2},r.a.createElement(M.a,{className:t.gridBtn,variant:"outlined",size:"large",key:"lb".concat(a),onClick:function(){return m(e)}},r.a.createElement(H.a,{variant:"h5",className:t.catBtn},e))))})),o.length>0&&!u&&r.a.createElement(Ye.a,{in:!0,style:{transitionDelay:"".concat(50*o.length,"ms")}},r.a.createElement(Ve.a,{item:!0,xs:12,sm:4,md:3,lg:3},r.a.createElement(M.a,{className:t.gridBtn,variant:"outlined",size:"large",onClick:function(){return e.history.push("/products")}},r.a.createElement(H.a,{variant:"h5",className:t.catBtn},"See Everything")))),f&&u&&f.map((function(a,n){return r.a.createElement(Ye.a,{in:!0,style:{transitionDelay:"".concat(50*n,"ms")},key:"lb".concat(n)},r.a.createElement(Ve.a,{item:!0,xs:12,sm:4,md:3},r.a.createElement(M.a,{className:t.gridBtn,variant:"outlined",size:"large",key:"lb".concat(n),onClick:function(){return e.history.push("/products/".concat(encodeURIComponent(u),"/").concat(encodeURIComponent(a.name)))}},r.a.createElement(H.a,{variant:"h5",className:t.catBtn},a.label))))})),f.length>0&&u&&r.a.createElement(Ye.a,{in:!0,style:{transitionDelay:"".concat(50*f.length,"ms")}},r.a.createElement(Ve.a,{item:!0,xs:12,sm:4,md:3},r.a.createElement(M.a,{className:t.gridBtn,variant:"outlined",size:"large",onClick:function(){return e.history.push("/products/".concat(encodeURIComponent(u)))}},r.a.createElement(H.a,{variant:"h5",className:t.catBtn},"See Everything"))))))})),ct=a(422),ot=a(415),lt=a(419),it=a(128),st=a(418),ut=a(414),mt=a(370),dt=a(209),pt=a(161),ft=a(369),ht=a(373),gt=a(217),bt=Object(ye.a)((function(e){return{form:{width:"100%",marginTop:e.spacing(1),display:"flex",flexDirection:"column",justifyContent:"center","& .MuiFormHelperText-root":{color:e.palette.error.main,textAlign:"right"}},title:{display:"flex",justifyContent:"space-between",alignItems:"flex-end"},notice:{marginTop:e.spacing(4),marginBottom:e.spacing(1)},formControl:{margin:"".concat(e.spacing(2),"px 0"),"& legend":{fontSize:"1.25rem",marginTop:e.spacing(2),marginBottom:e.spacing(1)}},submit:{margin:e.spacing(3,0,2)}}}));var Et=Object(l.b)((function(e,t){return{userService:e.session.userService}}),(function(e,t){return{login:function(t,a){return e(T(t,a))}}}))(Object(s.f)((function(e){var t=e.userService,a=e.showTitle,c=e.onRegisterFn,o=e.history,l=bt(),i=Object(n.useState)(""),s=Object(B.a)(i,2),u=s[0],m=s[1];return Object(n.useEffect)((function(){t.user&&!t.isFetching&&t.user.role&&(console.log("we gotta user!",t.user),c?c():o.push("/"))}),[t,c,o]),r.a.createElement(ze.a,{maxWidth:"sm"},r.a.createElement("form",{onSubmit:function(t){t.preventDefault(),m("");var a=t.currentTarget,n=a.elements.namedItem("email"),r=a.elements.namedItem("password");n&&n.value.length>0&&r&&r.value.length>0&&e.login(n.value,r.value)},className:l.form},a&&r.a.createElement("div",{className:l.title},r.a.createElement(H.a,{variant:"h2",display:"block"},"Register")),r.a.createElement(we.a,{label:"email",name:"email",type:"text",helperText:"Required",autoFocus:!0,fullWidth:!0,required:!0}),r.a.createElement(we.a,{label:"name",name:"name",type:"text",helperText:"Required",fullWidth:!0,required:!0}),r.a.createElement(we.a,{label:"phone",name:"phone",type:"phone",helperText:"Required",fullWidth:!0,required:!0}),r.a.createElement(we.a,{label:"address",name:"address",type:"text",fullWidth:!0}),r.a.createElement("p",{className:l.notice},r.a.createElement("i",null,"By purchasing a share in the co-op, I understand that I am an equal owner in the enterprise and am eligible to vote on co-op matters and in board elections and to make proposals for the use of the kitchen and event space. I agree to pay for and pick up my groceries in a timely manner and to collaborate with others for the benefit of my co-members and the community at large. I understand that Member shares cost $100 and I can request a subsidy or contribute to subsidies for others.")),r.a.createElement(pt.a,{component:"fieldset",className:l.formControl},r.a.createElement(ft.a,{component:"legend"},"Purchase Share:"),r.a.createElement(ut.a,{"aria-label":"freq",name:"freq"},r.a.createElement(dt.a,{value:"whole",control:r.a.createElement(st.a,null),label:"I am purchasing a share for $100."}),r.a.createElement(dt.a,{value:"requestsubsidy",control:r.a.createElement(st.a,null),label:"I can pay some for my share and am requesting a subsidy."}),r.a.createElement(dt.a,{value:"requestsubsidy",control:r.a.createElement(st.a,null),label:"I can pay $100 and would like to pay an additional amount to subsidize others."})),r.a.createElement(mt.a,null,"Required")),r.a.createElement(pt.a,{component:"fieldset",className:l.formControl},r.a.createElement(ft.a,{component:"legend"},"I am interested in ordering groceries:"),r.a.createElement(ut.a,{"aria-label":"freq",name:"freq"},r.a.createElement(dt.a,{value:"1week",control:r.a.createElement(st.a,null),label:"Once a week"}),r.a.createElement(dt.a,{value:"2month",control:r.a.createElement(st.a,null),label:"Twice a month"}),r.a.createElement(dt.a,{value:"1month",control:r.a.createElement(st.a,null),label:"Once a month"})),r.a.createElement(mt.a,null,"Required")),r.a.createElement(pt.a,{component:"fieldset",className:l.formControl},r.a.createElement(ft.a,{component:"legend"},"Check your preference below:"),r.a.createElement(ut.a,{"aria-label":"freq",name:"freq"},r.a.createElement(dt.a,{value:"online",control:r.a.createElement(st.a,null),label:" I have Internet access and would like to order directly from the grocery catalog online."}),r.a.createElement(dt.a,{value:"inperson",control:r.a.createElement(st.a,null),label:"I would like to work with Co-op staff to develop my order in person."})),r.a.createElement(mt.a,null,"Required")),r.a.createElement(pt.a,{component:"fieldset",className:l.formControl},r.a.createElement(ft.a,{component:"legend"},"Check any that apply:"),r.a.createElement(ht.a,null,r.a.createElement(dt.a,{control:r.a.createElement(gt.a,{onChange:console.log,value:"worker-owner"}),label:"I may be interested in participating in the co-op as a worker-owner."}),r.a.createElement(dt.a,{control:r.a.createElement(gt.a,{onChange:console.log,value:"producer-owner"}),label:"I may be interested in participating in the co-op as a producer."}),r.a.createElement(dt.a,{control:r.a.createElement(gt.a,{onChange:console.log,value:"kitchenexp"}),label:"I have kitchen experience."}),r.a.createElement(dt.a,{control:r.a.createElement(gt.a,{onChange:console.log,value:"farminggardeningexp"}),label:"I have farming/gardening experience."}),r.a.createElement(dt.a,{control:r.a.createElement(gt.a,{onChange:console.log,value:"otherexp"}),label:"I have other relevant experience."}),r.a.createElement(we.a,{label:"explain",name:"otherexpexplain",type:"text",multiline:!0,rowsMax:"10",fullWidth:!0}))),r.a.createElement(pt.a,{component:"fieldset",className:l.formControl},r.a.createElement(ft.a,{component:"legend"},"MARSH Cooperative Bylaws and principles"),r.a.createElement(ht.a,null,r.a.createElement(dt.a,{control:r.a.createElement(gt.a,{onChange:console.log,value:"agree"}),label:"I understand that the MARSH Cooperative Bylaws and principles are available online or upon request and that these documents guide the co-op and its members."})),r.a.createElement(mt.a,null,"Required")),r.a.createElement("div",null,r.a.createElement(M.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",disabled:e.userService.isFetching,className:l.submit},"Register")),r.a.createElement(Pe.a,{color:"error.main"},e.userService.error&&r.a.createElement(r.a.Fragment,null,r.a.createElement(H.a,{variant:"overline",display:"block"},"onoz! an error!"),r.a.createElement(H.a,{variant:"body1",display:"block",gutterBottom:!0},e.userService.error.reason)),u&&r.a.createElement(r.a.Fragment,null,r.a.createElement(H.a,{variant:"overline",display:"block"},"onoz! an error!"),r.a.createElement(H.a,{variant:"body1",display:"block",gutterBottom:!0},u)))))})));a(358);function yt(){return r.a.createElement(ze.a,{fixed:!0},r.a.createElement(Pe.a,{pt:4,style:{textAlign:"center"}},"L O A D I N G . . ."))}var vt={name:{verticalAlign:"top",display:"none",margin:0,border:"none",fontSize:"16px",fontFamily:"Helvetica Neue",padding:"16px",color:"#373F4A",backgroundColor:"transparent",lineHeight:"1.15em"},leftCenter:{float:"left",textAlign:"center"},blockRight:{display:"block",float:"right"},center:{textAlign:"center"},error:{textAlign:"center",fontWeight:"bold",fontSize:"1.25rem",whiteSpace:"pre-wrap",color:"red"}};function Ot(e){var t=Object(n.useState)(""),a=Object(B.a)(t,2),c=a[0],o=a[1],l=Object(n.useState)(void 0),i=Object(B.a)(l,2),s=i[0],u=i[1],m=Object(n.useState)(!1),d=Object(B.a)(m,2),p=d[0],f=d[1],h=Object(n.useState)(!1),g=Object(B.a)(h,2),b=g[0],E=g[1],y=Object(n.useState)(!1),v=Object(B.a)(y,2),O=v[0],x=v[1],j=Object(n.useState)(""),k=Object(B.a)(j,2),w=k[0],N=k[1],I=Object(n.useState)(!0),F=Object(B.a)(I,2),T=F[0],R=F[1],q={applicationId:S,locationId:C,inputClass:"sq-input",autoBuild:!1,inputStyles:[{fontSize:"16px",fontFamily:"Helvetica Neue",padding:"16px",color:"#373F4A",backgroundColor:"transparent",lineHeight:"1.15em"}],applePay:{elementId:"sq-apple-pay"},masterpass:{elementId:"sq-masterpass"},googlePay:{elementId:"sq-google-pay"},cardNumber:{elementId:"sq-card-number",placeholder:"\u2022 \u2022 \u2022 \u2022  \u2022 \u2022 \u2022 \u2022  \u2022 \u2022 \u2022 \u2022  \u2022 \u2022 \u2022 \u2022"},cvv:{elementId:"sq-cvv",placeholder:"CVV"},expirationDate:{elementId:"sq-expiration-date",placeholder:"MM/YY"},postalCode:{elementId:"sq-postal-code",placeholder:"Zip"},callbacks:{methodsSupported:function(e){e.googlePay&&f(!0),e.applePay&&E(!0),e.masterpass&&x(!0)},createPaymentRequest:function(){return{requestShippingAddress:!1,requestBillingInfo:!0,currencyCode:"USD",countryCode:"US",total:{label:"MARSH COOP",amount:"100",pending:!1},lineItems:[{label:"Subtotal",amount:"100",pending:!1}]}},cardNonceResponseReceived:function(t,a,n){if(t)return console.log("Encountered errors:"),t.forEach((function(e){console.log("  "+e.message)})),void N("Encountered errors:\n".concat(t.map((function(e){return e.message})).join("\n")));console.log("cardNonceResponseReceived nonce:",a),u(a),e.handleNext()},unsupportedBrowserDetected:function(){},inputEventReceived:function(e){switch(e.eventType){case"focusClassAdded":case"focusClassRemoved":break;case"errorClassAdded":N("Please fix card information errors before continuing.");break;case"errorClassRemoved":N("");break;case"cardBrandChanged":"unknown"!==e.cardBrand?o(e.cardBrand):o("")}},paymentFormLoaded:function(){console.log("paymentFormLoaded!"),R(!1)}}},_=Object(n.useRef)(new e.paymentForm(q));return Object(n.useEffect)((function(){console.log("!!! SquarePaymentForm !!! fx, gonna paymentFormRef.current.build() !!!"),_.current.build()}),[]),r.a.createElement(r.a.Fragment,null,T&&r.a.createElement(yt,null),r.a.createElement("div",{style:{display:T?"hidden":"block"}},r.a.createElement("div",{className:"container"},r.a.createElement("div",{id:"form-container"},r.a.createElement("div",{id:"sq-walletbox"},r.a.createElement("button",{style:{display:b?"inherit":"none"},className:"button-google-pay",id:"sq-apple-pay"}),r.a.createElement("button",{style:{display:O?"block":"none"},className:"sq-apple-pay",id:"sq-masterpass"}),r.a.createElement("button",{style:{display:p?"inherit":"none"},className:"sq-masterpass",id:"sq-google-pay"}),r.a.createElement("div",{className:"sq-wallet-divider"},r.a.createElement("span",{className:"sq-wallet-divider__text"},"Or"))),r.a.createElement("div",{id:"sq-ccbox"},r.a.createElement("p",null,r.a.createElement("span",{style:vt.leftCenter},"Enter Card Info Below "),r.a.createElement("span",{style:vt.blockRight},c.toUpperCase())),r.a.createElement("div",{id:"cc-field-wrapper"},r.a.createElement("div",{id:"sq-card-number"}),r.a.createElement("input",{type:"hidden",id:"card-nonce",name:"nonce"}),r.a.createElement("div",{id:"sq-expiration-date"}),r.a.createElement("div",{id:"sq-cvv"})),r.a.createElement("input",{id:"name",style:vt.name,type:"text",placeholder:"Name"}),r.a.createElement("div",{id:"sq-postal-code"})),r.a.createElement(M.a,{variant:"contained",color:"primary",onClick:function(){console.log("requestCardNonce paymentFormRef:",_.current.requestCardNonce," props.paymentForm:",e.paymentForm.requestCardNonce),_.current.requestCardNonce&&_.current.requestCardNonce()},fullWidth:!0,disabled:void 0!==s},"Pay")),r.a.createElement("p",{style:vt.error,id:"error"},w))))}function xt(e){var t=Object(n.useState)(!1),a=Object(B.a)(t,2),c=a[0],o=a[1];return Object(n.useEffect)((function(){var e=document.createElement("script");e.src=k,e.type="text/javascript",e.async=!1,e.onload=function(){return o(!0)},document.getElementsByTagName("head")[0].appendChild(e)}),[]),c?r.a.createElement(Ot,{paymentForm:SqPaymentForm,handleNext:e.handleNext}):r.a.createElement(yt,null)}var jt=Object(ye.a)((function(e){return Object(ve.a)({opt:{display:"flex",flexDirection:"column",padding:"".concat(e.spacing(4),"px 0"),alignItems:"center"},optItem:Object(Be.a)({display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:e.spacing(2),maxWidth:"350px",width:"50%"},e.breakpoints.down("xs"),{width:"100%",maxWidth:"unset"})})}));function kt(e){var t=jt(),a=Object(n.useState)(),c=Object(B.a)(a,2),o=c[0],l=c[1],i=e.setCanGoToNextStep,s=e.handleNext,u=e.backDisabled,m=e.handleBack,d=e.nextDisabled,p=e.nextText,f=e.userService;Object(n.useEffect)((function(){f&&f.user&&f.user.id?s&&s():i(!1)}),[i,f,s]);var h=function(){i(!0),s()};return r.a.createElement(r.a.Fragment,null,r.a.createElement(it.a,null,o&&r.a.createElement(L.a,{"aria-label":"back",title:"back"},r.a.createElement(W.a,{onClick:function(){return l(void 0)}},r.a.createElement(Ae.a,null))),!o&&r.a.createElement("div",{className:t.opt},r.a.createElement("div",{className:t.optItem},r.a.createElement(H.a,{variant:"body1",gutterBottom:!0},"Already a member?"),r.a.createElement(M.a,{variant:"contained",color:"primary",onClick:function(){return l("login")}},"Sign In")),r.a.createElement("div",{className:t.optItem},r.a.createElement(H.a,{variant:"body1",gutterBottom:!0},"Want to become a member?"),r.a.createElement(M.a,{color:"secondary",onClick:function(){return l("register")}},"Register"))),"login"===o&&r.a.createElement(Le,{onLoginFn:h}),"register"===o&&r.a.createElement(Et,{onRegisterFn:h})),r.a.createElement(Ft,{backDisabled:u,handleBack:m,nextDisabled:d,handleNext:s,nextText:p}))}var St=Object(ye.a)((function(e){return Object(ve.a)({infoContainer:{padding:e.spacing(2),height:"100%",display:"flex",flexDirection:"column",alignItems:"center","& .MuiFormHelperText-root":{color:e.palette.error.main,textAlign:"right"}}})}));function Ct(e){var t=St(),a=me(),c=e.setCanGoToNextStep,o=e.backDisabled,l=e.handleBack,i=e.nextDisabled,s=e.nextText,u=e.setOrder,m=e.userService,d=Object(n.useState)(""),p=Object(B.a)(d,2),f=p[0],h=p[1],g=Object(n.useState)(""),b=Object(B.a)(g,2),E=b[0],O=b[1],x=Object(n.useState)(""),j=Object(B.a)(x,2),k=j[0],S=j[1],C=Object(n.useState)(""),w=Object(B.a)(C,2),N=w[0],I=w[1],F=Object(n.useState)(""),T=Object(B.a)(F,2),R=T[0],q=T[1];return Object(n.useEffect)((function(){console.log("ReviewCart fx userService:",m),m.user&&m.user.token&&fetch("".concat(v,"/member/me"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(m.user.token)}}).then((function(e){return e.json()})).then((function(e){console.log("/member/me response",e);var t=e.member;t&&(t.name&&S(t.name),t.phone&&O(t.phone),t.address&&I(t.address)),h(m.user&&m.user.email?m.user.email:""),u((function(e){return Object(y.a)({},e,{UserId:m.user&&m.user.id?m.user.id:void 0,MemberId:t&&t.id?t.id:void 0})}))})).catch((function(e){return console.warn("onoz /member/me caught err:",e)}))}),[u,m]),Object(n.useEffect)((function(){c&&c(!!(f&&E&&k))}),[c,f,E,k]),r.a.createElement(r.a.Fragment,null,r.a.createElement(it.a,{className:t.infoContainer},r.a.createElement(Ve.a,{container:!0,justify:"center",direction:"row",spacing:2},r.a.createElement(Ve.a,{item:!0,xs:12,sm:4},r.a.createElement(we.a,{label:"email",name:"email",type:"text",value:f,onChange:function(e){return h(e.target.value)},autoFocus:!0,fullWidth:!0,helperText:"Required",required:!0}),r.a.createElement(we.a,{label:"name",name:"name",type:"text",value:k,onChange:function(e){return S(e.target.value)},fullWidth:!0,helperText:"Required",required:!0}),r.a.createElement(we.a,{label:"phone",name:"phone",type:"phone",value:E,onChange:function(e){return O(e.target.value)},fullWidth:!0,helperText:"Required",required:!0}),r.a.createElement(we.a,{label:"address",name:"address",type:"text",value:N,onChange:function(e){return I(e.target.value)},fullWidth:!0}),r.a.createElement(we.a,{label:"notes",name:"notes",type:"text",value:R,onChange:function(e){return q(e.target.value)},multiline:!0,rowsMax:"10",fullWidth:!0})),r.a.createElement(Ve.a,{item:!0,xs:12,sm:8},"loaded"!==a.status&&"Loading...","loaded"===a.status&&a.payload.line_items.length>0&&r.a.createElement(_e,{line_items:a.payload.line_items,setOrder:u,checkout:!0})))),r.a.createElement(Ft,{backDisabled:o,handleBack:l,nextDisabled:i,handleNext:function(){var t="loaded"===a.status&&a.payload.line_items?a.payload.line_items:[];u((function(e){return Object(y.a)({},e,{email:f,phone:E,name:k,address:N,notes:R,item_count:t.length,OrderLineItems:[].concat(Object(Ee.a)(t),Object(Ee.a)(e.OrderLineItems.filter((function(e){return"product"!==e.kind}))))})})),fetch("".concat(v,"/store/validate_line_items"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(t){console.log("validate response:",t),t.error||e.handleNext()})).catch((function(e){return console.warn("o noz! validation caight error:",e)}))},nextText:s}))}var wt=Object(ye.a)((function(e){return Object(ve.a)({paymentContainer:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},error:{display:"flex",flexDirection:"column",textAlign:"right",padding:e.spacing(2)}})}));function Nt(e){var t=wt(),a=me(),c=e.setCanGoToNextStep,o=e.backDisabled,l=e.handleBack,i=e.nextDisabled,s=e.nextText,u=e.order,m=Object(n.useState)(""),d=Object(B.a)(m,2),p=d[0],f=d[1];function h(){console.log("on handleNext should submit order:",u),f(""),fetch("".concat(v,"/store/checkout"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)}).then((function(e){return e.json()})).then((function(t){t.error?(console.warn("/store/checkout ERROR response:",t),f(t.msg||"onoz! could not submit your order ;(")):(console.log("/store/checkout response ok:",t),ge(),e.handleNext())})).catch((function(e){console.warn("onoz! caught error /store/checkout err:",e),f("onoz! could not submit your order ;(")}))}return Object(n.useEffect)((function(){c(!1)}),[c]),r.a.createElement(r.a.Fragment,null,r.a.createElement(it.a,null,r.a.createElement(Ve.a,{container:!0,justify:"center",direction:"row"},r.a.createElement(Ve.a,{item:!0,xs:12,sm:6},"loaded"!==a.status&&"Loading...","loaded"===a.status&&a.payload.line_items.length>0&&r.a.createElement(_e,{line_items:a.payload.line_items,checkout:!0,summary:!0})),r.a.createElement(Ve.a,{item:!0,xs:12,sm:6},r.a.createElement("div",{className:t.paymentContainer},r.a.createElement(xt,{handleNext:h}))),p&&r.a.createElement(Ve.a,{item:!0,xs:12},r.a.createElement(Pe.a,{color:"error.main",className:t.error},r.a.createElement(H.a,{variant:"overline",display:"block"},"onoz! an error!"),r.a.createElement(H.a,{variant:"body1",display:"block",gutterBottom:!0},p))))),r.a.createElement(Ft,{backDisabled:o,handleBack:l,nextDisabled:i,handleNext:h,nextText:s}))}var It=Object(ye.a)((function(e){return Object(ve.a)({root:{display:"flex",justifyContent:"flex-end",marginTop:e.spacing(2)},button:{marginLeft:e.spacing(2)}})}));function Ft(e){var t=It(),a=e.backDisabled,n=e.handleBack,c=e.nextDisabled,o=e.handleNext,l=e.nextText;return r.a.createElement("div",{className:t.root},r.a.createElement(M.a,{disabled:a,onClick:n,className:t.button},"Back"),"Finish"!==l&&r.a.createElement(M.a,{disabled:c,variant:"contained",color:"primary",onClick:o,className:t.button},l))}var Tt=Object(ye.a)((function(e){return Object(ve.a)({root:{width:"100%",padding:e.spacing(2)},instructions:{marginTop:e.spacing(2),marginBottom:e.spacing(2)},stepBtnz:{display:"flex",justifyContent:"flex-end",marginTop:e.spacing(2)},finished:{minHeight:"300px",width:"100%",display:"flex",justifyContent:"center",alignItems:"center"}})}));var Rt=Object(l.b)((function(e){return{userService:e.session.userService}}))((function(e){var t=Tt(),a=e.userService,c=Object(n.useState)(0),o=Object(B.a)(c,2),l=o[0],i=o[1],s=Object(n.useState)(!1),u=Object(B.a)(s,2),m=u[0],d=u[1],p=Object(n.useState)(j),f=Object(B.a)(p,2),h=f[0],g=f[1],b=["Member Registration","Review Order","Payment"],E=function(){i((function(e){return e+1}))},y=function(){i((function(e){return e-1}))};return r.a.createElement(r.a.Fragment,null,r.a.createElement(at,{showCart:!1}),r.a.createElement("div",{className:t.root},r.a.createElement(ct.a,{activeStep:l},b.map((function(e,t){return r.a.createElement(ot.a,Object.assign({key:e},{}),r.a.createElement(lt.a,{},e))}))),r.a.createElement("div",null,l===b.length?r.a.createElement(it.a,{className:t.finished},r.a.createElement(H.a,{className:t.instructions},"THANK YOU!")):r.a.createElement("div",null,0===l&&r.a.createElement(kt,{handleNext:E,setCanGoToNextStep:d,backDisabled:!0,handleBack:y,nextDisabled:!m||0===l,nextText:l===b.length-1?"Finish":"Next",userService:a}),1===l&&r.a.createElement(Ct,{setCanGoToNextStep:d,backDisabled:!0,handleBack:y,nextDisabled:!m,handleNext:E,nextText:l===b.length-1?"Finish":"Next",setOrder:g,userService:a}),2===l&&r.a.createElement(Nt,{setCanGoToNextStep:d,backDisabled:!1,handleBack:y,nextDisabled:!m,handleNext:E,nextText:l===b.length-1?"Finish":"Next",order:h})))))}));var qt=Object(l.b)((function(e){return{userService:e.session.userService,preferencesService:e.preferences.preferencesService}}),(function(e){return{checkSession:function(){return e((function(e){return E.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){e(I(!0));var a=localStorage&&localStorage.getItem("token");if(!a)return e(I(!1)),e(w(F)),void t();fetch("".concat(v,"/check_session"),{headers:{Authorization:"Bearer ".concat(a)}}).then((function(e){return e.json()})).then((function(t){console.log("check_session",t),"ok"===t.msg&&t.user?e(w(Object(y.a)({},t.user,{token:a}))):e(w(F))})).catch((function(t){console.warn("check_session caught err:",t),e(w(F))})).finally((function(){e(I(!1)),t()}))})));case 1:case"end":return t.stop()}}))}))},getPreferences:function(){return e((function(e){return E.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,a){e(_(!0));var n=localStorage&&localStorage.getItem("preferences");e(q(n?JSON.parse(n):R)),e(_(!1)),t()})));case 1:case"end":return t.stop()}}))}))}}}))((function(e){var t=e.preferencesService,a=e.checkSession,c=e.getPreferences;Object(n.useEffect)((function(){c&&c()}),[c]),Object(n.useEffect)((function(){a&&a()}),[a]);var o=t&&t.preferences&&"true"===t.preferences.dark_mode?h:g;return r.a.createElement(m.a,{theme:o},r.a.createElement(u.a,null),r.a.createElement(i.a,null,r.a.createElement(s.c,null,r.a.createElement(s.a,{path:"/checkout",exact:!0,component:Rt}),r.a.createElement(s.a,{path:"/products",exact:!0,component:Ue}),r.a.createElement(s.a,{path:"/products/:cat/",exact:!0,component:Ue}),r.a.createElement(s.a,{path:"/products/:cat/:subcat",component:Ue}),r.a.createElement(s.a,{path:"/login",exact:!0},r.a.createElement(r.a.Fragment,null,r.a.createElement(at,null),r.a.createElement(Le,{showTitle:!0}))),r.a.createElement(s.a,{path:"/register",exact:!0},r.a.createElement(r.a.Fragment,null,r.a.createElement(at,null),r.a.createElement(Et,{showTitle:!0}))),r.a.createElement(s.a,{path:"/",component:rt}))))})),_t=a(32),Bt=a(237),Dt=Object(_t.c)({userService:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET":return Object(y.a)({},e,{user:t.user,error:void 0});case"SET_FETCHING":return Object(y.a)({},e,{isFetching:t.isFetching});case"SET_ERROR":return Object(y.a)({},e,{user:void 0,error:t.error})}return e}}),At=Object(_t.c)({preferencesService:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_PREFERENCES":return Object(y.a)({},e,{preferences:t.preferences,error:void 0});case"SET_FETCHING_PREFERENCES":return Object(y.a)({},e,{isFetching:t.isFetching});case"SET_ERROR_PREFERENCES":return Object(y.a)({},e,{preferences:void 0,error:t.error})}return e}}),zt=Object(_t.e)(Object(_t.c)({session:Dt,preferences:At}),Object(_t.a)(Bt.a));o.a.render(r.a.createElement(l.a,{store:zt},r.a.createElement(qt,null)),document.querySelector("#root"))}},[[258,1,2]]]);
//# sourceMappingURL=main.c73d5293.chunk.js.map