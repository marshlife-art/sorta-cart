{"version":3,"sources":["theme.tsx","constants.ts","redux/session/actions.ts","redux/preferences/actions.ts","redux/announcement/actions.ts","components/UserMenu.tsx","services/useCartService.ts","appDatabase.ts","components/CartTable.tsx","components/Login.tsx","components/UserLoginPrompt.tsx","components/CartDrawer.tsx","components/DataTable.tsx","components/NavBar.tsx","components/Landing.tsx","components/Loading.tsx","components/SquarePayment.tsx","components/PaymentDialog.tsx","components/OrderDetailPanel.tsx","components/MyOrders.tsx","components/Checkout.tsx","components/Register.tsx","components/ForgotPassword.tsx","components/ResetPassword.tsx","components/Order.tsx","components/renderers.tsx","components/Announcements.tsx","App.tsx","redux/session/reducers.ts","redux/preferences/reducers.ts","redux/announcement/reducers.ts","redux/index.ts","index.tsx"],"names":["darkTheme","createMuiTheme","palette","type","primary","main","secondary","error","red","A400","lightTheme","API_HOST","TAX_RATE","TAX_RATE_STRING","toFixed","BLANK_ORDER","id","status","payment_status","shipment_status","total","item_count","subtotal","name","email","phone","address","notes","createdAt","updatedAt","OrderLineItems","SQUARE_PAYMENT_JS","SQUARE_APP_ID","SQUARE_LOCATION_ID","set","user","setError","isFetching","NULL_USER","undefined","token","role","DEFAULT_PREFERENCES","last_seen_announcement","dark_mode","preferences","setPreferences","dispatch","a","async","Promise","resolve","rject","localStorage","setItem","JSON","stringify","openAnnouncement","open","closeAnnouncement","StyledMenu","withStyles","paper","border","props","Menu","elevation","getContentAnchorEl","anchorOrigin","vertical","horizontal","transformOrigin","StyledMenuItem","theme","root","MenuItem","connect","states","preferencesService","userService","session","logout","fetch","method","headers","credentials","catch","console","warn","finally","window","location","href","withRouter","anchorEl","setAnchorEl","history","useState","useDarkTheme","setUseDarkTheme","useEffect","handleClose","hasUser","isAdmin","keepMounted","Boolean","onClose","ListItemText","style","padding","borderBottom","onClick","assign","push","prev","display","justifyContent","alignItems","Switch","checked","value","inputProps","db","cart","version","stores","table","Dexie","useCartService","result","setResult","toArray","then","line_items","payload","e","on","changes","find","change","getCartItemCount","count","useCartItemCount","itemCount","setItemCount","subscriber","unsubscribe","addToCart","product","existingLi","li","data","unf","upc_code","quantity","parseFloat","price","updateLineItem","line_item","ws_price","selected_unit","description","trim","kind","vendor","add","addStoreCreditToCart","storeCredit","map","reduce","sum","i","adjustments","filter","length","amt","Math","abs","adjustment","removeItemFromCart","index","delete","emptyCart","clear","err","update","validateLineItems","removeInvalidLineItems","body","r","json","response","invalidLineItems","invalid","setDonationAmount","amount","donationItem","donation","useStyles","makeStyles","createStyles","maxWidth","spacing","borderCollapse","qtyinput","width","usdFormat","num","liTotal","u_price","liPkSize","pksize","pk","size","join","narrowWidth","useMediaQuery","classes","checkout","summary","setOrder","invoiceSubtotal","invoiceTaxes","invoiceTotal","order","removeLineItem","products","invalidProducts","Table","className","aria-label","TableHead","TableRow","TableCell","align","TableBody","idx","key","Tooltip","title","IconButton","event","fontSize","isNaN","parseInt","count_on_hand","no_backorder","Select","onChange","unit","handleUnitChange","target","margin","unit_type","TextField","InputLabelProps","shrink","fullWidth","handleQtyChange","min","step","colSpan","rowSpan","TableFooter","emptyCartAndCloseDrawer","Button","variant","color","closeDrawer","form","marginTop","flexDirection","submit","forgotpassword","ownProps","login","password","msg","reason","message","showTitle","onLoginFn","Container","onSubmit","preventDefault","currentTarget","emailEl","elements","namedItem","passwordEl","Typography","label","autoFocus","required","disabled","Box","gutterBottom","styles","height","breakpoints","down","optItem","marginBottom","spacer","lineHeight","doLogin","setDoLogin","setOpen","cartResult","Drawer","anchor","confirm","PROPERTY_MAP","c","d","f","g","k","l","m","og","v","w","ft","n","s","y","1","2","3","cartDrawerOpen","setCartDrawerOpen","React","userMenuAnchorEl","setUserMenuAnchorEl","cartAction","icon","Badge","badgeContent","max","tooltip","isFreeAction","userAction","resetAction","actions","setActions","setCategoryLookup","categoryLookup","setSubCategoryLookup","subCategoryLookup","match","params","cat","decodeURIComponent","catDefaultFilter","setCatDefaultFilter","subcat","subCatDefaultFilter","setSubCatDefaultFilter","onhand","onHandDefaultFilter","columns","field","lookup","filterPlaceholder","defaultFilter","filterCellStyle","paddingTop","render","row","filtering","CS","EA","codes","split","code","Chip","hidden","query","reject","categories","filters","column","terms","t","subCatz","setSelectedCatsFromQuery","page","totalCount","options","headerStyle","position","top","maxBodyHeight","pageSize","pageSizeOptions","debounceInterval","search","emptyRowsWhenPaging","flexGrow","boxShadow","toolbar","backgroundColor","background","default","text","menuButton","marginLeft","grow","borderRadius","shape","fade","common","white","up","searchIcon","pointerEvents","inputRoot","inputInput","transition","transitions","create","showCart","AppBar","Toolbar","Fade","in","onBrandBtnClick","children","edge","gridRoot","overflowX","minHeight","flexFill","crumbz","gridBtn","textDecoration","cursor","catHover","catBtn","overflow","overflowWrap","hyphens","setCategories","selectedCat","setSelectedCat","subCategories","setSubCategories","catz","Object","keys","tcat","tsubcat","transitionDelay","toUpperCase","Grid","container","justify","Zoom","item","xs","sm","md","lg","subCat","encodeURIComponent","Loading","fixed","pt","textAlign","verticalAlign","fontFamily","leftCenter","float","blockRight","center","fontWeight","whiteSpace","SquarePaymentForm","cardBrand","setCardBrand","googlePay","setGooglePay","applePay","setApplePay","masterpass","setMasterpass","loading","setLoading","config","applicationId","locationId","inputClass","autoBuild","inputStyles","elementId","cardNumber","placeholder","cvv","expirationDate","postalCode","callbacks","methodsSupported","methods","createPaymentRequest","requestShippingAddress","requestBillingInfo","currencyCode","countryCode","pending","lineItems","cardNonceResponseReceived","errors","nonce","cardData","forEach","handleNext","unsupportedBrowserDetected","inputEventReceived","inputEvent","eventType","paymentFormLoaded","paymentFormRef","useRef","paymentForm","current","build","requestCardNonce","SquarePayment","jsloaded","setJsloaded","sqPaymentScript","document","createElement","src","onload","getElementsByTagName","appendChild","SqPaymentForm","DialogTitle","closeButton","right","grey","other","disableTypography","DialogContent","MuiDialogContent","PaymentDialog","complete","setComplete","setRefetchOrders","floor","startIcon","Dialog","aria-labelledby","dividers","marginRight","borderLeft","divider","gridHeading","gridItem","paddingBottom","paddingLeft","paddingRight","lastUpdated","OrderDetailPanel","payments","paymentsTotal","acc","credits","creditsTotal","balance","component","scope","direction","Date","toLocaleString","fetchStoreCredit","setStoreCredit","store_credit","myorders","setMyOrders","refetchOrders","storeCreditAction","orders","formatDistance","now","addSuffix","detailPanel","onRowClick","rowData","togglePanel","registrationStyles","opt","Registration","setOpt","setCanGoToNextStep","backDisabled","handleBack","nextDisabled","nextText","Paper","StepButtons","reviewStyles","infoContainer","donateBoxFlex","twoPickups","ReviewCart","setEmail","setPhone","setName","setAddress","setNotes","applyStoreCreditDisabled","setApplyStoreCreditDisabled","member","prevOrder","UserId","MemberId","helperText","multiline","rowsMax","InputProps","startAdornment","InputAdornment","cartItems","paymentStyles","paymentContainer","freeOrPayButtonz","freeOrPayButton","Payment","canPayLater","setCanPayLater","isFree","setIsFree","path","oli","every","stepButtonsStyles","button","checkoutStyles","instructions","stepBtnz","finished","activeStep","setActiveStep","canGoToNextStep","steps","prevActiveStep","Stepper","Step","StepLabel","Link","notice","formControl","slider","natValid","continueWrapper","register","purchaseshare","setPurchaseshare","understandBylaws","setUnderstandBylaws","registrationFee","setRegistrationFee","subsityAmount","setSubsityAmount","otherexpexplain","setOtherexpexplain","userData","setUserData","setMember","memberData","setMemberData","valid","setValid","validEmail","setValidEmail","valuetext","handleUserDataChange","persist","handleMemberChange","onBlur","FormControl","FormLabel","RadioGroup","FormControlLabel","control","Radio","Slider","getAriaValueText","_","Array","isArray","marks","valueLabelDisplay","FormHelperText","FormGroup","Checkbox","workerOwner","producer","kitchenExperience","farmingGardeningExperience","otherexpExplain","fees_paid","ForgotPassword","success","setSuccess","requestForgotPassword","onKeyPress","resetPassword","regKey","URLSearchParams","useLocation","get","passwordConfirmEl","orderId","OrderId","listItem","header","MarkdownHeading","level","MarkdownListItem","renderers","heading","paragraph","link","tableHead","tableBody","tableRow","tableCell","ADialogTitle","Announcements","useSelector","state","announcement","announcementService","useDispatch","setAnnouncement","descriptionElementRef","descriptionElement","focus","slug","content","scroll","aria-describedby","plugins","gfm","checkSession","getPreferences","getItem","parse","ThemeProvider","CssBaseline","exact","Checkout","DataTable","Order","Landing","combineReducers","action","createStore","applyMiddleware","thunk","ReactDOM","store","querySelector"],"mappings":"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","file":"static/js/main.b5c77cf4.chunk.js","sourcesContent":["import red from '@material-ui/core/colors/red'\nimport { createMuiTheme } from '@material-ui/core/styles'\n\nconst darkTheme = createMuiTheme({\n  palette: {\n    type: 'dark',\n    primary: {\n      main: '#556cd6'\n    },\n    secondary: {\n      main: '#FF4081'\n    },\n    error: {\n      main: red.A400\n    }\n  }\n})\n\nconst lightTheme = createMuiTheme({\n  palette: {\n    type: 'light',\n    primary: {\n      main: '#556cd6'\n    },\n    secondary: {\n      main: '#FF4081'\n    },\n    error: {\n      main: red.A400\n    }\n  }\n})\nexport { darkTheme, lightTheme }\n","import { Order } from './types/Order'\n\nexport const API_HOST: string =\n  process.env.NODE_ENV === 'production'\n    ? 'https://api.marshcoop.org'\n    : 'https://api.marsh.dev'\n\nexport const TAX_RATE = 0.06391\nexport const TAX_RATE_STRING = `${(TAX_RATE * 100).toFixed(3)}%`\n\nexport const BLANK_ORDER: Order = {\n  id: 'new',\n  status: 'new',\n  payment_status: 'balance_due',\n  shipment_status: 'backorder',\n  total: 0.0,\n  item_count: 0,\n  subtotal: 0,\n  name: '',\n  email: '',\n  phone: '',\n  address: '',\n  notes: '',\n  createdAt: '',\n  updatedAt: '',\n  OrderLineItems: []\n}\n\nexport const SQUARE_PAYMENT_JS =\n  process.env.NODE_ENV === 'production'\n    ? 'https://js.squareup.com/v2/paymentform'\n    : 'https://js.squareupsandbox.com/v2/paymentform'\nexport const SQUARE_APP_ID: string =\n  process.env.NODE_ENV === 'production'\n    ? 'sq0idp-TfU74GGFyRSTe7XZYsZp-g'\n    : 'sandbox-sq0idb-JHHiCIhNvJdJH4pJxLaDzA'\nexport const SQUARE_LOCATION_ID: string =\n  process.env.NODE_ENV === 'production' ? 'FY8AAVD6K7T7A' : 'D2MV0BZC6EV9Y'\n","import { ThunkAction, ThunkDispatch } from 'redux-thunk'\nimport { AnyAction } from 'redux'\n\nimport { User, LoginError } from '../../types/User'\nimport { API_HOST } from '../../constants'\nimport { Member } from '../../types/Member'\n\nexport interface SetAction {\n  type: 'SET'\n  user: User\n}\nexport interface SetFetcing {\n  type: 'SET_FETCHING'\n  isFetching: boolean\n}\nexport interface SetError {\n  type: 'SET_ERROR'\n  error: LoginError\n}\n\nexport type Action = SetAction | SetFetcing | SetError\n\nexport const set = (user: User): SetAction => {\n  return { type: 'SET', user }\n}\nexport const setError = (error: LoginError): SetError => {\n  return { type: 'SET_ERROR', error }\n}\nexport const isFetching = (isFetching: boolean): SetFetcing => {\n  return { type: 'SET_FETCHING', isFetching }\n}\n\nconst NULL_USER: User = {\n  id: undefined,\n  email: undefined,\n  token: undefined,\n  role: undefined\n}\n\nexport const checkSession = (): ThunkAction<\n  Promise<void>,\n  {},\n  {},\n  AnyAction\n> => {\n  return async (dispatch: ThunkDispatch<{}, {}, AnyAction>): Promise<void> => {\n    return new Promise<void>((resolve) => {\n      dispatch(isFetching(true))\n\n      fetch(`${API_HOST}/check_session`, {\n        credentials: 'include'\n      })\n        .then((response) => response.json())\n        .then((response) => {\n          if (response.msg === 'ok' && response.user) {\n            dispatch(set({ ...response.user }))\n          } else {\n            dispatch(set(NULL_USER))\n          }\n        })\n        .catch((err) => {\n          console.warn('check_session caught err:', err)\n          // hmm, maybe the API is just down? ...is it really necessary to NULL the user?\n          dispatch(set(NULL_USER))\n        })\n        .finally(() => {\n          dispatch(isFetching(false))\n          resolve()\n        })\n    })\n  }\n}\n\nexport const register = (\n  user: Partial<User>,\n  member: Partial<Member>,\n  nonce: string\n): ThunkAction<Promise<void>, {}, {}, AnyAction> => {\n  return async (dispatch: ThunkDispatch<{}, {}, AnyAction>): Promise<void> => {\n    return new Promise<void>((resolve) => {\n      dispatch(isFetching(true))\n\n      fetch(`${API_HOST}/register`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          user,\n          member,\n          nonce\n        })\n      })\n        .then((response) => response.json())\n        .then((response) => {\n          if (response.msg === 'ok' && response.user) {\n            dispatch(set(response.user))\n          } else {\n            dispatch(setError({ error: 'error', reason: response.message }))\n          }\n        })\n        .catch((e) => {\n          console.warn('register error:', e)\n          dispatch(\n            setError({\n              error: 'error',\n              reason: 'unable to register right now :('\n            })\n          )\n        })\n        .finally(() => {\n          dispatch(isFetching(false))\n          resolve()\n        })\n    })\n  }\n}\n\nexport const login = (\n  email: string,\n  password: string\n): ThunkAction<Promise<void>, {}, {}, AnyAction> => {\n  return async (dispatch: ThunkDispatch<{}, {}, AnyAction>): Promise<void> => {\n    return new Promise<void>((resolve) => {\n      dispatch(isFetching(true))\n\n      fetch(`${API_HOST}/login`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        credentials: 'include',\n        body: JSON.stringify({ email, password })\n      })\n        .then((response) => response.json())\n        .then((response) => {\n          if (response.msg === 'ok' && response.user) {\n            dispatch(set(response.user))\n          } else {\n            dispatch(setError({ error: 'error', reason: response.message }))\n          }\n        })\n        .catch((e) => {\n          console.warn('login error:', e)\n          dispatch(\n            setError({ error: 'error', reason: 'unable to login right now :(' })\n          )\n        })\n        .finally(() => {\n          dispatch(isFetching(false))\n          resolve()\n        })\n    })\n  }\n}\n\nexport const logout = (): ThunkAction<Promise<void>, {}, {}, AnyAction> => {\n  return async (dispatch: ThunkDispatch<{}, {}, AnyAction>): Promise<void> => {\n    return new Promise<void>((resolve) => {\n      dispatch(isFetching(true))\n\n      fetch(`${API_HOST}/logout`, {\n        method: 'DELETE',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        credentials: 'include'\n      })\n        .catch(console.warn)\n        .finally(() => {\n          dispatch(set(NULL_USER))\n          dispatch(isFetching(false))\n          resolve()\n          window.location.href = '/'\n        })\n    })\n  }\n}\n\nexport const resetPassword = (\n  regKey: string,\n  password: string\n): ThunkAction<Promise<void>, {}, {}, AnyAction> => {\n  return async (dispatch: ThunkDispatch<{}, {}, AnyAction>): Promise<void> => {\n    return new Promise<void>((resolve) => {\n      dispatch(isFetching(true))\n\n      fetch(`${API_HOST}/resetpassword`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({ regKey, password })\n      })\n        .then((response) => response.json())\n        .then((response) => {\n          if (response.msg === 'ok' && response.user) {\n            dispatch(set(response.user))\n          } else {\n            dispatch(setError({ error: 'error', reason: response.message }))\n          }\n        })\n        .catch((e) => {\n          console.warn('reset password error:', e)\n          dispatch(\n            setError({\n              error: 'error',\n              reason: 'unable to reset password right now :('\n            })\n          )\n        })\n        .finally(() => {\n          dispatch(isFetching(false))\n          resolve()\n        })\n    })\n  }\n}\n","import { ThunkAction, ThunkDispatch } from 'redux-thunk'\nimport { AnyAction } from 'redux'\n\nimport { Preferences, PreferencesError } from '../../types/Preferences'\n\nconst DEFAULT_PREFERENCES: Preferences = {\n  last_seen_announcement: '-1',\n  dark_mode: 'false'\n}\n\nexport interface SetAction {\n  type: 'SET_PREFERENCES'\n  preferences: Preferences\n}\nexport interface SetFetcing {\n  type: 'SET_FETCHING_PREFERENCES'\n  isFetching: boolean\n}\nexport interface SetError {\n  type: 'SET_ERROR_PREFERENCES'\n  error: PreferencesError\n}\n\nexport type Action = SetAction | SetFetcing | SetError\n\nexport const set = (preferences: Preferences): SetAction => {\n  return { type: 'SET_PREFERENCES', preferences }\n}\nexport const setError = (error: PreferencesError): SetError => {\n  return { type: 'SET_ERROR_PREFERENCES', error }\n}\nexport const isFetching = (isFetching: boolean): SetFetcing => {\n  return { type: 'SET_FETCHING_PREFERENCES', isFetching }\n}\n\nexport const getPreferences = (): ThunkAction<\n  Promise<void>,\n  {},\n  {},\n  AnyAction\n> => {\n  return async (dispatch: ThunkDispatch<{}, {}, AnyAction>): Promise<void> => {\n    return new Promise<void>((resolve, rject) => {\n      dispatch(isFetching(true))\n\n      const preferences = localStorage && localStorage.getItem('preferences')\n      if (!preferences) {\n        dispatch(set(DEFAULT_PREFERENCES))\n      } else {\n        dispatch(set(JSON.parse(preferences)))\n      }\n      dispatch(isFetching(false))\n      resolve()\n    })\n  }\n}\n\nexport const setPreferences = (\n  preferences: Preferences\n): ThunkAction<Promise<void>, {}, {}, AnyAction> => {\n  return async (dispatch: ThunkDispatch<{}, {}, AnyAction>): Promise<void> => {\n    return new Promise<void>((resolve, rject) => {\n      dispatch(isFetching(true))\n\n      if (!preferences) {\n        dispatch(set(DEFAULT_PREFERENCES))\n      } else {\n        localStorage &&\n          localStorage.setItem('preferences', JSON.stringify(preferences))\n        dispatch(set(preferences))\n      }\n      dispatch(isFetching(false))\n      resolve()\n    })\n  }\n}\n","export interface OpenAction {\n  type: 'OPEN'\n  open: boolean\n}\nexport interface CloseAction {\n  type: 'CLOSE'\n  open: boolean\n}\n\nexport type Action = OpenAction | CloseAction\n\nexport const openAnnouncement = (): OpenAction => {\n  return { type: 'OPEN', open: true }\n}\n\nexport const closeAnnouncement = (): CloseAction => {\n  return { type: 'CLOSE', open: false }\n}\n","import React, { useState, useEffect } from 'react'\nimport { withRouter, RouteComponentProps } from 'react-router-dom'\nimport { connect } from 'react-redux'\nimport { ThunkDispatch } from 'redux-thunk'\nimport { withStyles } from '@material-ui/core/styles'\nimport Menu, { MenuProps } from '@material-ui/core/Menu'\nimport MenuItem from '@material-ui/core/MenuItem'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport Switch from '@material-ui/core/Switch'\nimport AnnouncementIcon from '@material-ui/icons/Notifications'\n\nimport { RootState } from '../redux'\nimport { PreferencesServiceProps } from '../redux/preferences/reducers'\nimport { setPreferences } from '../redux/preferences/actions'\nimport { Preferences } from '../types/Preferences'\nimport { logout } from '../redux/session/actions'\nimport { UserServiceProps } from '../redux/session/reducers'\nimport { openAnnouncement } from '../redux/announcement/actions'\n\ninterface DispatchProps {\n  setPreferences: (preferences: Preferences) => void\n  logout: () => void\n  openAnnouncement: () => void\n}\n\nconst StyledMenu = withStyles({\n  paper: {\n    border: '1px solid #d3d4d5'\n  }\n})((props: MenuProps) => (\n  <Menu\n    elevation={0}\n    getContentAnchorEl={null}\n    anchorOrigin={{\n      vertical: 'bottom',\n      horizontal: 'center'\n    }}\n    transformOrigin={{\n      vertical: 'top',\n      horizontal: 'center'\n    }}\n    {...props}\n  />\n))\n\nconst StyledMenuItem = withStyles((theme) => ({\n  root: {\n    // '&:focus': {\n    //   backgroundColor: theme.palette.primary.main,\n    //   '& .MuiListItemIcon-root, & .MuiListItemText-primary': {\n    //     color: theme.palette.common.white\n    //   }\n    // }\n  }\n}))(MenuItem)\n\ninterface UserMenuProps {\n  anchorEl: HTMLElement | null\n  setAnchorEl: React.Dispatch<React.SetStateAction<HTMLElement | null>>\n}\ntype Props = PreferencesServiceProps &\n  DispatchProps &\n  RouteComponentProps &\n  UserMenuProps &\n  UserServiceProps\n\nfunction UserMenu(props: Props) {\n  // const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null)\n  const {\n    anchorEl,\n    setAnchorEl,\n    preferencesService,\n    setPreferences,\n    userService,\n    logout,\n    openAnnouncement,\n    history\n  } = props\n\n  const [useDarkTheme, setUseDarkTheme] = useState<null | boolean>(null)\n\n  useEffect(() => {\n    if (!preferencesService.isFetching && preferencesService.preferences) {\n      if (useDarkTheme === null) {\n        setUseDarkTheme(\n          preferencesService.preferences.dark_mode === 'true' ? true : false\n        )\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [preferencesService])\n\n  useEffect(() => {\n    if (\n      preferencesService &&\n      preferencesService.preferences &&\n      useDarkTheme !== null &&\n      (preferencesService.preferences.dark_mode === 'true' ? true : false) !==\n        useDarkTheme\n    ) {\n      setPreferences({\n        ...preferencesService.preferences,\n        dark_mode: useDarkTheme ? 'true' : 'false'\n      })\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [useDarkTheme])\n\n  const handleClose = () => {\n    setAnchorEl(null)\n  }\n\n  const hasUser = !!(userService && userService.user && userService.user.id)\n  const isAdmin = !!(\n    userService &&\n    userService.user &&\n    userService.user.role === 'admin'\n  )\n  return (\n    <>\n      <StyledMenu\n        id=\"user-menu\"\n        anchorEl={anchorEl}\n        keepMounted\n        open={Boolean(anchorEl)}\n        onClose={handleClose}\n      >\n        {hasUser && (\n          <ListItemText\n            primary={userService.user && userService.user.email}\n            secondary={userService.user && userService.user.role}\n            style={{ padding: '0 16px 6px', borderBottom: 'thin solid #f60' }}\n          />\n        )}\n        {isAdmin && (\n          <StyledMenuItem\n            onClick={() => {\n              handleClose()\n              window.location.assign('https://admin.marshcoop.org/')\n            }}\n          >\n            <ListItemText primary=\"ADMIN\" />\n          </StyledMenuItem>\n        )}\n\n        {hasUser && (\n          <StyledMenuItem\n            onClick={() => {\n              history.push('/orders')\n              handleClose()\n            }}\n          >\n            <ListItemText primary=\"My Orders\" />\n          </StyledMenuItem>\n        )}\n\n        {hasUser && (\n          <StyledMenuItem\n            onClick={() => {\n              logout()\n              handleClose()\n            }}\n          >\n            <ListItemText primary=\"Log out\" />\n          </StyledMenuItem>\n        )}\n\n        {!hasUser && (\n          <StyledMenuItem\n            onClick={() => {\n              history.push('/login')\n              handleClose()\n            }}\n          >\n            <ListItemText primary=\"Sign in\" />\n          </StyledMenuItem>\n        )}\n\n        {!hasUser && (\n          <StyledMenuItem\n            onClick={() => {\n              history.push('/register')\n              handleClose()\n            }}\n          >\n            <ListItemText primary=\"Join the Co-op\" />\n          </StyledMenuItem>\n        )}\n\n        <StyledMenuItem onClick={() => setUseDarkTheme((prev) => !prev)}>\n          <ListItemText>\n            <div\n              style={{\n                display: 'flex',\n                justifyContent: 'space-between',\n                alignItems: 'center'\n              }}\n            >\n              <span>Dark Theme</span>\n              <Switch\n                checked={\n                  useDarkTheme === null || useDarkTheme === undefined\n                    ? false\n                    : useDarkTheme\n                }\n                value=\"useDarkTheme\"\n                inputProps={{ 'aria-label': 'secondary checkbox' }}\n              />\n            </div>\n          </ListItemText>\n        </StyledMenuItem>\n\n        <StyledMenuItem\n          onClick={() => {\n            openAnnouncement()\n            handleClose()\n          }}\n        >\n          <ListItemText>\n            <div\n              style={{\n                display: 'flex',\n                justifyContent: 'space-between',\n                alignItems: 'center'\n              }}\n            >\n              <span>Show Announcements</span>\n              <AnnouncementIcon />\n            </div>\n          </ListItemText>\n        </StyledMenuItem>\n\n        <StyledMenuItem\n          onClick={() => {\n            handleClose()\n            window.location.href = 'https://marshlife-art.org'\n          }}\n        >\n          <ListItemText primary=\"marshlife-art.org\" />\n        </StyledMenuItem>\n      </StyledMenu>\n    </>\n  )\n}\n\nconst mapStateToProps = (\n  states: RootState\n): PreferencesServiceProps & UserServiceProps => {\n  return {\n    preferencesService: states.preferences.preferencesService,\n    userService: states.session.userService\n  }\n}\n\nconst mapDispatchToProps = (\n  dispatch: ThunkDispatch<{}, {}, any>\n): DispatchProps => {\n  return {\n    setPreferences: (preferences: Preferences) =>\n      dispatch(setPreferences(preferences)),\n    logout: () => dispatch(logout()),\n    openAnnouncement: () => dispatch(openAnnouncement())\n  }\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(withRouter(UserMenu))\n","import { useEffect, useState } from 'react'\n\nimport { AppDatabase } from '../appDatabase'\nimport { Service } from '../types/Service'\nimport { Cart } from '../types/Cart'\nimport { Product } from '../types/Product'\nimport { OrderLineItem } from '../types/Order'\nimport { IDatabaseChange } from 'dexie-observable/api'\nimport { API_HOST } from '../constants'\n\nconst db = new AppDatabase()\n\nconst useCartService = () => {\n  const [result, setResult] = useState<Service<Cart>>({\n    status: 'loading'\n  })\n  useEffect(() => {\n    db.cart\n      .toArray()\n      .then((line_items) =>\n        setResult({ status: 'loaded', payload: { line_items: line_items } })\n      )\n      .catch((e) => {\n        // console.warn('[useCartService] caught error:', e)\n        setResult({ status: 'error', error: e })\n      })\n\n    db.on('changes', (changes) => {\n      changes.find((change) => change.table === 'cart') &&\n        db.cart\n          .toArray()\n          .then((line_items) => {\n            // console.log('[useCartService] db changes!! ')\n            setResult({ status: 'loaded', payload: { line_items: line_items } })\n          })\n          .catch((e) => {\n            // console.warn('[useCartService] caught error:', e)\n            setResult({ status: 'error', error: e })\n          })\n    })\n  }, [])\n\n  return result\n}\n\nconst getCartItemCount = () => {\n  return db.cart.count().catch((e) => {\n    console.warn('[useCartItemCount] caught error:', e)\n    return 0\n  })\n}\n\nconst useCartItemCount = () => {\n  const [itemCount, setItemCount] = useState(0)\n\n  const subscriber = (changes: IDatabaseChange[]) => {\n    changes.find((change) => change.table === 'cart') &&\n      getCartItemCount().then((count) => setItemCount(count))\n  }\n\n  useEffect(() => {\n    getCartItemCount().then((count) => setItemCount(count))\n\n    db.on('changes', subscriber)\n\n    return () => db.on('changes').unsubscribe(subscriber)\n  }, [])\n\n  return itemCount\n}\n\nconst addToCart = async (product: Product) => {\n  \n  const line_items = await db.cart.toArray()\n\n  const existingLi = line_items.find( li => li.data?.product?.unf === product.unf && li.data?.product?.upc_code === product.upc_code)\n  \n  if(existingLi){\n    // console.log('item already exists in cart! update qty:')\n    existingLi.quantity += 1\n    existingLi.total = +(existingLi.quantity * parseFloat(`${existingLi.price}`)).toFixed(2)\n    updateLineItem(existingLi)\n  }else{\n    let line_item: OrderLineItem = {\n      quantity: 1,\n      total: +product.ws_price,\n      selected_unit: 'CS',\n      price: +product.ws_price,\n      description: `${product.name} ${product.description}`.trim(),\n      kind: 'product',\n      vendor: product.vendor,\n      data: { product }\n    }\n  \n    db.cart\n      .add(line_item)\n      .catch((error) => console.warn('[addToCart] caught error:', error))\n  }\n  \n}\n\nconst addStoreCreditToCart = async (storeCredit: number) => {\n  // console.log('[useCartService] addStoreCreditToCart storeCredit:', storeCredit)\n\n  const line_items = await db.cart.toArray()\n  const subtotal = line_items\n    .map(({ total }) => total)\n    .reduce((sum, i) => sum + i, 0)\n\n  if (subtotal <= 0) {\n    // console.log('subtotal is 0 or less, not going to addStoreCreditToCart')\n    return\n  }\n\n  const adjustments = line_items.filter((li) => li.kind === 'adjustment')\n  if (adjustments && adjustments.length) {\n    // console.log(\n    //   'cart already has adjustment, not going to addStoreCreditToCart',\n    //   adjustments\n    // )\n    return\n  }\n  // const subtotal =\n  //   order && order.subtotal ? order.subtotal : Math.abs(storeCredit)\n  const amt = Math.abs(storeCredit) >= subtotal ? -subtotal : storeCredit\n  // console.log('line_items:', line_items, ' subtotal:', subtotal, ' amt:', amt)\n\n  const adjustment: OrderLineItem = {\n    description: 'STORE CREDIT',\n    quantity: 1,\n    price: amt,\n    total: amt,\n    kind: 'adjustment'\n  }\n\n  db.cart\n    .add(adjustment)\n    .catch((error) =>\n      console.warn('[addStoreCreditToCart] caught error:', error)\n    )\n}\n\nconst removeItemFromCart = (index: number) => {\n  db.cart\n    .delete(index)\n    .catch((error) => console.warn('[removeItemFromCart] caught error:', error))\n}\n\nconst emptyCart = () => {\n  db.cart.clear().catch(function (err) {\n    console.warn('[emptyCart] caught error:', err)\n  })\n}\n\nconst updateLineItem = (line_item: OrderLineItem) => {\n  line_item &&\n    line_item.id &&\n    db.cart\n      .update(line_item.id, line_item)\n      .catch((error) => console.warn('[updateLineItem] caught error:', error))\n}\n\nconst validateLineItems = async (props: {removeInvalidLineItems: boolean}) => {\n\n  const {removeInvalidLineItems} = props\n  const line_items = await db.cart.toArray()\n\n  line_items.length && fetch(`${API_HOST}/store/validate_line_items`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    credentials: 'include',\n    body: JSON.stringify(line_items)\n  })\n    .then((r) => r.json())\n    .then((response) => {\n      // console.log('[cartService] validateLineItems response:', response)\n      if (response.invalidLineItems && response.invalidLineItems.length) {\n        for (const li of response.invalidLineItems) {\n          // console.log('gonna updateLineItem li:', li)\n          if(removeInvalidLineItems && li.id && li.invalid){\n            // console.log('gonna removeInvalidLineItems', li)\n            removeItemFromCart(li.id)\n            continue\n          }\n          updateLineItem(li)\n        }\n      }\n    })\n    .catch((err) => console.warn('o noz! validation caight error:', err))\n}\n\nconst setDonationAmount = async (amount: number) => {\n\n  const line_items = await db.cart.toArray()\n  const donationItem = line_items.find((li) => li.description === 'DONATION')\n\n  if(donationItem && donationItem.id){\n    if(amount <= 0){\n      removeItemFromCart(donationItem.id)\n    }\n    donationItem.price = +amount.toFixed(2)\n    donationItem.total = +amount.toFixed(2)\n    updateLineItem(donationItem)\n\n  }else{\n    const donation: OrderLineItem = {\n      description: 'DONATION',\n      quantity: 1,\n      price: amount,\n      total: amount,\n      kind: 'adjustment'\n    }\n    db.cart\n      .add(donation)\n      .catch((error) =>\n        console.warn('[addStoreCreditToCart] caught error:', error)\n      )\n  }\n  \n}\n\nexport {\n  useCartService,\n  useCartItemCount,\n  addToCart,\n  removeItemFromCart,\n  emptyCart,\n  updateLineItem,\n  addStoreCreditToCart,\n  validateLineItems,\n  setDonationAmount\n}\n","import Dexie from 'dexie'\nimport 'dexie-observable'\n\nimport { OrderLineItem } from './types/Order'\n\nexport class AppDatabase extends Dexie {\n  cart: Dexie.Table<OrderLineItem, number>\n\n  constructor() {\n    super('SortaCartDatabase')\n    this.version(1).stores({\n      cart: '++id'\n    })\n    this.cart = this.table('cart')\n  }\n}\n","import React, { useEffect } from 'react'\nimport { withRouter, RouteComponentProps } from 'react-router-dom'\nimport useMediaQuery from '@material-ui/core/useMediaQuery'\nimport { createStyles, Theme, makeStyles } from '@material-ui/core/styles'\nimport Table from '@material-ui/core/Table'\nimport TableBody from '@material-ui/core/TableBody'\nimport TableCell from '@material-ui/core/TableCell'\nimport TableHead from '@material-ui/core/TableHead'\nimport TableRow from '@material-ui/core/TableRow'\nimport TableFooter from '@material-ui/core/TableFooter'\nimport Tooltip from '@material-ui/core/Tooltip'\nimport Button from '@material-ui/core/Button'\nimport TextField from '@material-ui/core/TextField'\nimport Select from '@material-ui/core/Select'\nimport MenuItem from '@material-ui/core/MenuItem'\nimport IconButton from '@material-ui/core/IconButton'\nimport ClearIcon from '@material-ui/icons/Clear'\n\nimport { updateLineItem, removeItemFromCart } from '../services/useCartService'\nimport { Order, OrderLineItem } from '../types/Order'\nimport { TAX_RATE, TAX_RATE_STRING } from '../constants'\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      maxWidth: '95vw',\n      padding: theme.spacing(1),\n      borderCollapse: 'separate',\n      '& td': {\n        border: 'none'\n      }\n    },\n    qtyinput: {\n      width: '50px'\n    }\n  })\n)\n\nfunction usdFormat(num?: number | string) {\n  if (num === undefined) {\n    return '$0.00'\n  } else if (typeof num === 'string') {\n    return `$${parseFloat(num).toFixed(2)}`\n  } else {\n    return `$${num.toFixed(2)}`\n  }\n}\n\nfunction subtotal(items: OrderLineItem[]) {\n  return items\n    .map(({ total }) => total)\n    .reduce((sum, i) => sum + parseFloat(`${i}`), 0)\n}\n\nfunction liTotal(line_item: OrderLineItem): number {\n  const product = line_item.data && line_item.data.product\n  if (product) {\n    return line_item.selected_unit === 'EA' && product.u_price\n      ? line_item.quantity * parseFloat(product.u_price)\n      : line_item.quantity * parseFloat(product.ws_price)\n  } else {\n    return line_item.quantity * (line_item.price || 0)\n  }\n}\n\nfunction liPkSize(line_item: OrderLineItem): string {\n  const product = line_item.data && line_item.data.product\n  if (product) {\n    const pksize = []\n    product.pk && product.pk !== 1 && pksize.push(product.pk)\n    product.size && pksize.push(product.size)\n    return pksize.join(' / ')\n  } else {\n    return ''\n  }\n}\n\ninterface CartTableProps {\n  line_items: OrderLineItem[]\n  emptyCartAndCloseDrawer?: (\n    event: React.MouseEvent<HTMLButtonElement, MouseEvent>\n  ) => void\n  closeDrawer?: () => void\n  setOrder?: React.Dispatch<React.SetStateAction<Order>>\n  checkout?: boolean\n  summary?: boolean\n}\n\nfunction CartTable(props: CartTableProps & RouteComponentProps) {\n  const narrowWidth = useMediaQuery('(max-width:600px)')\n  const classes = useStyles()\n\n  const { checkout, summary, setOrder } = props\n  const invoiceSubtotal = subtotal(props.line_items)\n  const invoiceTaxes = TAX_RATE * invoiceSubtotal\n  const invoiceTotal = invoiceTaxes + invoiceSubtotal\n\n  useEffect(() => {\n    if (setOrder) {\n      setOrder((order) => {\n        const newOrder = {\n          ...order,\n          subtotal: +invoiceSubtotal.toFixed(2),\n          total: +invoiceTotal.toFixed(2),\n          item_count: order.OrderLineItems.filter((li) => li.kind === 'product')\n            .length,\n          OrderLineItems: [\n            ...order.OrderLineItems.filter((li) => li.kind !== 'tax'),\n            {\n              kind: 'tax',\n              description: TAX_RATE_STRING,\n              quantity: 1,\n              total: +invoiceTaxes.toFixed(2)\n            }\n          ]\n        }\n        return newOrder\n      })\n    }\n  }, [setOrder, invoiceSubtotal, invoiceTaxes, invoiceTotal])\n\n  const handleUnitChange = (line_item: OrderLineItem, unit: string) => {\n    line_item.selected_unit = unit\n    line_item.total = liTotal(line_item)\n    updateLineItem(line_item)\n  }\n\n  const handleQtyChange = (line_item: OrderLineItem, quantity: number) => {\n    line_item.quantity = quantity > 0 ? quantity : 1\n    line_item.total = liTotal(line_item)\n    updateLineItem(line_item)\n  }\n\n  const removeLineItem = (id?: number) => {\n    id && removeItemFromCart(id)\n  }\n\n  const products = props.line_items.filter(\n    (li) => li.kind === 'product' && !li.invalid\n  )\n  const invalidProducts = props.line_items.filter(\n    (li) => li.kind === 'product' && li.invalid\n  )\n  const adjustments = props.line_items.filter((li) => li.kind === 'adjustment')\n\n  return (\n    <Table className={classes.root} aria-label=\"cart\">\n      <TableHead>\n        <TableRow>\n          <TableCell align=\"center\"></TableCell>\n          <TableCell>Description</TableCell>\n          <TableCell align=\"right\">Price</TableCell>\n          <TableCell align=\"center\">Unit</TableCell>\n          <TableCell align=\"right\">Qty.</TableCell>\n          <TableCell align=\"right\">Total</TableCell>\n        </TableRow>\n      </TableHead>\n      <TableBody>\n        {products.map((line_item, idx) => (\n          <TableRow key={`li${idx}`}>\n            <TableCell align=\"center\">\n              {!summary && (\n                <Tooltip\n                  aria-label=\"remove line item\"\n                  title={`REMOVE ${line_item.description}`}\n                >\n                  <IconButton\n                    aria-label=\"delete\"\n                    size=\"small\"\n                    onClick={(event: any) => removeLineItem(line_item.id)}\n                  >\n                    <ClearIcon fontSize=\"inherit\" />\n                  </IconButton>\n                </Tooltip>\n              )}\n            </TableCell>\n            <TableCell>\n              {line_item.description}\n\n              {!isNaN(\n                parseInt(`${line_item?.data?.product?.count_on_hand}`)\n              ) && (\n                <>\n                  <br />\n                  <i>\n                    {line_item?.data?.product?.no_backorder && 'ONLY '}\n                    {line_item?.data?.product?.count_on_hand} ON HAND\n                    {line_item?.data?.product?.no_backorder && ' LEFT'}\n                  </i>\n                </>\n              )}\n            </TableCell>\n            <TableCell align=\"right\">\n              <div>{usdFormat(line_item.price)}</div>\n              <div>{liPkSize(line_item)}</div>\n            </TableCell>\n            <TableCell align=\"center\">\n              {!summary ? (\n                line_item.data &&\n                line_item.data.product &&\n                line_item.data.product.u_price &&\n                line_item.data.product.u_price !==\n                  line_item.data.product.ws_price ? (\n                  <Select\n                    value={line_item.selected_unit}\n                    onChange={(event: any) =>\n                      handleUnitChange(line_item, event.target.value)\n                    }\n                    margin=\"dense\"\n                  >\n                    <MenuItem value=\"CS\">Case</MenuItem>\n                    <MenuItem value=\"EA\">Each</MenuItem>\n                  </Select>\n                ) : line_item.data &&\n                  line_item.data.product &&\n                  line_item.data.product.unit_type === 'CS' ? (\n                  'Case'\n                ) : (\n                  'Each'\n                )\n              ) : (\n                line_item.selected_unit\n              )}\n            </TableCell>\n            <TableCell align=\"right\">\n              {!summary ? (\n                <TextField\n                  className={classes.qtyinput}\n                  type=\"number\"\n                  InputLabelProps={{\n                    shrink: true\n                  }}\n                  margin=\"dense\"\n                  fullWidth\n                  value={line_item.quantity}\n                  onChange={(event: any) =>\n                    handleQtyChange(line_item, parseInt(event.target.value))\n                  }\n                  inputProps={{\n                    min: '1',\n                    step: '1'\n                  }}\n                />\n              ) : (\n                line_item.quantity\n              )}\n            </TableCell>\n            <TableCell align=\"right\">{usdFormat(line_item.total)}</TableCell>\n          </TableRow>\n        ))}\n\n        {invalidProducts && invalidProducts.length > 0 && (\n          <TableRow>\n            <TableCell colSpan={5}>Out Of Stock</TableCell>\n          </TableRow>\n        )}\n        {invalidProducts.map((line_item, idx) => (\n          <TableRow key={`invalidProduct${idx}`}>\n            <TableCell align=\"center\">\n              {!summary && (\n                <Tooltip\n                  aria-label=\"remove line item\"\n                  title={`REMOVE ${line_item.description}`}\n                >\n                  <IconButton\n                    aria-label=\"delete\"\n                    size=\"small\"\n                    onClick={(event: any) => removeLineItem(line_item.id)}\n                  >\n                    <ClearIcon fontSize=\"inherit\" />\n                  </IconButton>\n                </Tooltip>\n              )}\n            </TableCell>\n            <TableCell>{line_item.description}</TableCell>\n\n            <TableCell align=\"right\">\n              <div>{usdFormat(line_item.price)}</div>\n              <div>{liPkSize(line_item)}</div>\n            </TableCell>\n\n            <TableCell align=\"center\">{line_item.selected_unit}</TableCell>\n            <TableCell align=\"right\">{line_item.quantity}</TableCell>\n            <TableCell align=\"right\">{usdFormat(line_item.total)}</TableCell>\n          </TableRow>\n        ))}\n\n        {adjustments && adjustments.length > 0 && (\n          <TableRow>\n            <TableCell colSpan={5}>Adjustments</TableCell>\n          </TableRow>\n        )}\n\n        {adjustments.map((line_item, idx) => (\n          <TableRow key={`li${idx}`}>\n            <TableCell align=\"center\">\n              {!summary && (\n                <Tooltip aria-label=\"remove line item\" title=\"REMOVE LINE ITEM\">\n                  <IconButton\n                    aria-label=\"delete\"\n                    size=\"small\"\n                    onClick={(event: any) => removeLineItem(line_item.id)}\n                  >\n                    <ClearIcon fontSize=\"inherit\" />\n                  </IconButton>\n                </Tooltip>\n              )}\n            </TableCell>\n            <TableCell>{line_item.description}</TableCell>\n            <TableCell align=\"right\">\n              <div>{usdFormat(line_item.price)}</div>\n              <div>{liPkSize(line_item)}</div>\n            </TableCell>\n            <TableCell align=\"center\"></TableCell>\n            <TableCell align=\"right\">{line_item.quantity}</TableCell>\n            <TableCell align=\"right\">{usdFormat(line_item.total)}</TableCell>\n          </TableRow>\n        ))}\n\n        <TableRow>\n          <TableCell rowSpan={3} colSpan={3} />\n          <TableCell>Subtotal</TableCell>\n          <TableCell align=\"right\">\n            {props.line_items && props.line_items.length}\n          </TableCell>\n          <TableCell align=\"right\">{usdFormat(invoiceSubtotal)}</TableCell>\n        </TableRow>\n        <TableRow>\n          <TableCell>Tax</TableCell>\n          <TableCell align=\"right\">{TAX_RATE_STRING}</TableCell>\n          <TableCell align=\"right\">{usdFormat(invoiceTaxes)}</TableCell>\n        </TableRow>\n        <TableRow>\n          <TableCell>Total</TableCell>\n          <TableCell align=\"right\" colSpan={2}>\n            <b>{usdFormat(invoiceTotal)}</b>\n          </TableCell>\n        </TableRow>\n      </TableBody>\n      {!summary && !checkout && (\n        <TableFooter>\n          <TableRow>\n            <TableCell colSpan={3} align=\"left\">\n              {props.emptyCartAndCloseDrawer && (\n                <Button\n                  variant=\"contained\"\n                  color=\"secondary\"\n                  onClick={props.emptyCartAndCloseDrawer}\n                >\n                  Empty Cart\n                </Button>\n              )}\n            </TableCell>\n            <TableCell colSpan={3} align=\"right\">\n              <Button\n                variant=\"contained\"\n                color=\"primary\"\n                onClick={() => props.history.push('/checkout')}\n              >\n                Checkout\n              </Button>\n            </TableCell>\n          </TableRow>\n          {narrowWidth && (\n            <TableRow>\n              <TableCell colSpan={6} align=\"center\">\n                <Button\n                  variant=\"contained\"\n                  onClick={() => props.closeDrawer && props.closeDrawer()}\n                >\n                  Continue Shopping\n                </Button>\n              </TableCell>\n            </TableRow>\n          )}\n        </TableFooter>\n      )}\n    </Table>\n  )\n}\n\nexport default withRouter(CartTable)\n","import React, { useEffect, useState } from 'react'\nimport { connect } from 'react-redux'\nimport { ThunkDispatch } from 'redux-thunk'\nimport { withRouter, RouteComponentProps } from 'react-router-dom'\nimport { Container, Button, TextField } from '@material-ui/core'\nimport Box from '@material-ui/core/Box'\nimport Typography from '@material-ui/core/Typography'\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport { RootState } from '../redux'\nimport { login } from '../redux/session/actions'\nimport { UserServiceProps } from '../redux/session/reducers'\n\ninterface OwnProps {\n  onLoginFn?: () => void\n  showTitle?: boolean\n}\n\ninterface DispatchProps {\n  login: (email: string, password: string) => void\n}\n\ntype Props = UserServiceProps & OwnProps & DispatchProps & RouteComponentProps\n\nconst useStyles = makeStyles((theme) => ({\n  form: {\n    width: '100%',\n    // minHeight: '100vh',\n    marginTop: theme.spacing(1),\n    display: 'flex',\n    flexDirection: 'column',\n    justifyContent: 'center'\n  },\n  title: {\n    display: 'flex',\n    justifyContent: 'space-between',\n    alignItems: 'flex-end'\n  },\n  submit: {\n    margin: theme.spacing(3, 0, 2)\n  },\n  forgotpassword: {\n    marginTop: theme.spacing(3)\n  }\n}))\n\nfunction Login(props: Props) {\n  const doLogin = (event: React.FormEvent) => {\n    event.preventDefault()\n    setError('')\n    const target = event.currentTarget as HTMLFormElement\n    const emailEl = target.elements.namedItem('email') as HTMLInputElement\n    const passwordEl = target.elements.namedItem('password') as HTMLInputElement\n\n    if (\n      emailEl &&\n      emailEl.value.length > 0 &&\n      passwordEl &&\n      passwordEl.value.length > 0\n    ) {\n      props.login(emailEl.value, passwordEl.value)\n    }\n  }\n\n  const { userService, showTitle, onLoginFn, history } = props\n  const classes = useStyles()\n  const [error, setError] = useState('')\n\n  // when userService changes, figure out if the page should redirect if a user is already logged in.\n  useEffect(() => {\n    if (userService.user && !userService.isFetching && userService.user.role) {\n      onLoginFn ? onLoginFn() : history.push('/')\n    }\n    // else if (userService.user && !userService.isFetching) {\n    //   setError('o noz! error! ...hmm??')\n    // }\n  }, [userService, onLoginFn, history])\n\n  return (\n    <Container maxWidth=\"sm\">\n      <form onSubmit={doLogin} className={classes.form}>\n        {showTitle && (\n          <div className={classes.title}>\n            <Typography variant=\"h2\" display=\"block\">\n              Sign In\n            </Typography>\n          </div>\n        )}\n        <TextField\n          label=\"email\"\n          name=\"email\"\n          type=\"text\"\n          autoFocus\n          fullWidth\n          required\n        />\n        <TextField\n          label=\"password\"\n          name=\"password\"\n          type=\"password\"\n          fullWidth\n          required\n        />\n\n        <div>\n          <Button\n            type=\"submit\"\n            fullWidth\n            variant=\"contained\"\n            color=\"primary\"\n            disabled={props.userService.isFetching}\n            className={classes.submit}\n          >\n            Login\n          </Button>\n        </div>\n\n        <Box color=\"error.main\">\n          {props.userService.error && (\n            <>\n              <Typography variant=\"overline\" display=\"block\">\n                onoz! an error!\n              </Typography>\n              <Typography variant=\"body1\" display=\"block\" gutterBottom>\n                {props.userService.error.reason}\n              </Typography>\n            </>\n          )}\n          {error && (\n            <>\n              <Typography variant=\"overline\" display=\"block\">\n                onoz! an error!\n              </Typography>\n              <Typography variant=\"body1\" display=\"block\" gutterBottom>\n                {error}\n              </Typography>\n            </>\n          )}\n        </Box>\n\n        <Box className={classes.forgotpassword}>\n          <Button\n            fullWidth\n            // variant=\"contained\"\n            // color=\"primary\"\n            onClick={() => props.history.push('/forgotpassword')}\n          >\n            <i>Forgot Password?</i>\n          </Button>\n        </Box>\n      </form>\n    </Container>\n  )\n}\n\nconst mapStateToProps = (\n  states: RootState,\n  ownProps: OwnProps\n): UserServiceProps => {\n  return {\n    userService: states.session.userService\n  }\n}\n\nconst mapDispatchToProps = (\n  dispatch: ThunkDispatch<{}, {}, any>,\n  ownProps: OwnProps\n): DispatchProps => {\n  return {\n    login: (email, password) => dispatch(login(email, password))\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(withRouter(Login))\n","import React, { useState } from 'react'\nimport { RouteComponentProps, withRouter } from 'react-router-dom'\nimport {\n  makeStyles,\n  Theme,\n  createStyles,\n  Typography,\n  Button,\n  IconButton,\n  Tooltip\n} from '@material-ui/core'\nimport BackIcon from '@material-ui/icons/ArrowBack'\n\nimport Login from './Login'\n\nconst styles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      display: 'flex',\n      flexDirection: 'column',\n      padding: theme.spacing(2),\n      alignItems: 'center',\n      justifyContent: 'center',\n      height: '100%',\n      width: '350px',\n      [theme.breakpoints.down('xs')]: {\n        width: '100%',\n        padding: theme.spacing(1)\n      }\n    },\n    optItem: {\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center',\n      marginBottom: theme.spacing(2),\n      width: '100%'\n    },\n    spacer: {\n      height: '50px',\n      lineHeight: '50px',\n      width: '100%'\n    }\n  })\n)\n\nfunction UserLoginPrompt(props: RouteComponentProps) {\n  const classes = styles()\n  const [doLogin, setDoLogin] = useState(false)\n\n  return (\n    <div className={classes.root}>\n      {doLogin && (\n        <Tooltip aria-label=\"back\" title=\"back\">\n          <IconButton onClick={() => setDoLogin(false)}>\n            <BackIcon />\n          </IconButton>\n        </Tooltip>\n      )}\n      {!doLogin && (\n        <>\n          <div className={classes.optItem}>\n            <Typography variant=\"body1\">Already a member?</Typography>\n          </div>\n          <div className={classes.optItem}>\n            <Button\n              variant=\"contained\"\n              color=\"primary\"\n              onClick={() => setDoLogin(true)}\n            >\n              Sign In\n            </Button>\n          </div>\n          <div className={classes.spacer}>&nbsp;</div>\n          <div className={classes.optItem}>\n            <Typography variant=\"body1\">Want to become a member?</Typography>\n          </div>\n          <div className={classes.optItem}>\n            <Button\n              color=\"secondary\"\n              onClick={() => props.history.push('/register')}\n            >\n              Join the Co-op\n            </Button>\n          </div>\n          {/* <div className={classes.optItem}>\n              <Typography variant=\"body1\" gutterBottom>\n                ...or continue as a\n              </Typography>\n              <Button onClick={() => onCanContinue()}>Guest</Button>\n            </div> */}\n        </>\n      )}\n\n      {doLogin && <Login />}\n    </div>\n  )\n}\n\nexport default withRouter(UserLoginPrompt)\n","import React, { useEffect } from 'react'\nimport { connect } from 'react-redux'\nimport Drawer from '@material-ui/core/Drawer'\nimport { RootState } from '../redux'\nimport { UserServiceProps } from '../redux/session/reducers'\nimport {\n  useCartService,\n  emptyCart,\n  validateLineItems\n} from '../services/useCartService'\nimport CartTable from './CartTable'\nimport UserLoginPrompt from './UserLoginPrompt'\n\ninterface CartDrawerProps {\n  open: boolean\n  setOpen: React.Dispatch<React.SetStateAction<boolean>>\n}\n\nfunction CartDrawer(props: CartDrawerProps & UserServiceProps) {\n  const { open, setOpen, userService } = props\n  const cartResult = useCartService()\n\n  useEffect(() => {\n    open && validateLineItems({ removeInvalidLineItems: false })\n  }, [open])\n\n  // cartResult effect or onMount?\n  const emptyCartAndCloseDrawer = (\n    event: React.MouseEvent<HTMLButtonElement, MouseEvent>\n  ) => {\n    if (window.confirm('Are you sure?')) {\n      emptyCart()\n      setOpen(false)\n    }\n  }\n\n  const hasUser = !!(userService && userService.user && userService.user.id)\n\n  return (\n    <Drawer anchor=\"right\" open={open} onClose={() => setOpen(!open)}>\n      {cartResult.status !== 'loaded' && 'Loading...'}\n      {hasUser ? (\n        cartResult.status === 'loaded' &&\n        cartResult.payload.line_items.length > 0 && (\n          <CartTable\n            line_items={cartResult.payload.line_items}\n            emptyCartAndCloseDrawer={emptyCartAndCloseDrawer}\n            closeDrawer={() => setOpen(false)}\n          />\n        )\n      ) : (\n        <UserLoginPrompt />\n      )}\n    </Drawer>\n  )\n}\n\nconst mapStateToProps = (states: RootState): UserServiceProps => {\n  return {\n    userService: states.session.userService\n  }\n}\nexport default connect(mapStateToProps, {})(CartDrawer)\n","import React, { useState, useEffect } from 'react'\nimport { withRouter, RouteComponentProps } from 'react-router-dom'\nimport useMediaQuery from '@material-ui/core/useMediaQuery'\nimport MaterialTable, { Action, Query } from 'material-table'\nimport Chip from '@material-ui/core/Chip'\nimport Badge from '@material-ui/core/Badge'\nimport IconButton from '@material-ui/core/IconButton'\nimport Tooltip from '@material-ui/core/Tooltip'\nimport Typography from '@material-ui/core/Typography'\nimport Button from '@material-ui/core/Button'\nimport ShoppingCartIcon from '@material-ui/icons/ShoppingCart'\nimport AddShoppingCartIcon from '@material-ui/icons/AddShoppingCart'\nimport RemoveShoppingCartIcon from '@material-ui/icons/RemoveShoppingCart'\nimport TagFacesIcon from '@material-ui/icons/TagFaces'\nimport DeleteSweepIcon from '@material-ui/icons/DeleteSweep'\nimport BackIcon from '@material-ui/icons/ArrowBack'\n\nimport UserMenu from './UserMenu'\nimport CartDrawer from './CartDrawer'\nimport { useCartItemCount, addToCart } from '../services/useCartService'\nimport { API_HOST } from '../constants'\n\nconst PROPERTY_MAP: { [index: string]: string } = {\n  a: 'Artificial ingredients',\n  c: 'Low carb',\n  d: 'Dairy free',\n  f: 'Food Service items',\n  g: 'Gluten free',\n  k: 'Kosher',\n  l: 'Low sodium/no salt',\n  m: 'Non-GMO Project Verified',\n  og: 'Organic',\n  r: 'Refined sugar',\n  v: 'Vegan',\n  w: 'Wheat free',\n  ft: 'Fair Trade',\n  n: 'Natural',\n  s: 'Specialty Only',\n  y: 'Yeast free',\n  1: '100% organic',\n  2: '95%+ organic',\n  3: '70%+ organic'\n}\n\nfunction renderCodes(codes: string) {\n  return codes\n    .split(', ')\n    .map((code, idx) =>\n      PROPERTY_MAP[code] ? (\n        <Chip\n          label={PROPERTY_MAP[code]}\n          style={{ margin: 5 }}\n          size=\"small\"\n          key={`pprop${idx}`}\n        />\n      ) : (\n        ''\n      )\n    )\n}\n\nfunction DataTable(\n  props: RouteComponentProps<{ cat?: string; subcat?: string; onhand?: string }>\n) {\n  const narrowWidth = useMediaQuery('(max-width:600px)')\n  const itemCount = useCartItemCount()\n\n  const [cartDrawerOpen, setCartDrawerOpen] = useState(false)\n  const [\n    userMenuAnchorEl,\n    setUserMenuAnchorEl\n  ] = React.useState<null | HTMLElement>(null)\n\n  const handleUserMenuClick = (event: React.MouseEvent<HTMLElement>) => {\n    setUserMenuAnchorEl(event.currentTarget)\n  }\n\n  const cartAction = {\n    icon: () => (\n      <Badge badgeContent={itemCount} max={99} color=\"primary\">\n        <ShoppingCartIcon />\n      </Badge>\n    ),\n    tooltip: 'Cart',\n    isFreeAction: true,\n    onClick: () => setCartDrawerOpen(!cartDrawerOpen)\n  }\n\n  const userAction = {\n    icon: () => <TagFacesIcon />,\n    tooltip: 'User',\n    isFreeAction: true,\n    onClick: handleUserMenuClick\n  }\n\n  const resetAction = {\n    icon: () => <DeleteSweepIcon />,\n    tooltip: 'Reset Filters',\n    isFreeAction: true,\n    onClick: () => {\n      window.location.href = '/products'\n    }\n  }\n\n  const [actions, setActions] = useState<Action<any>[]>([userAction])\n\n  useEffect(() => {\n    if (itemCount) {\n      setActions([resetAction, cartAction, userAction])\n    } else {\n      setActions([resetAction, userAction])\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [itemCount, cartDrawerOpen]) // note: adding 'cartAction' and 'userAction' to dep array is not pleasant :/\n\n  const [categoryLookup, setCategoryLookup] = useState<object>(() => {\n    fetch(`${API_HOST}/categories`)\n      .then((response) => response.json())\n      .then((result) => setCategoryLookup(result))\n      .catch(console.warn)\n  })\n\n  const [subCategoryLookup, setSubCategoryLookup] = useState<object>(() => {\n    fetch(`${API_HOST}/sub_categories`)\n      .then((response) => response.json())\n      .then((result) => setSubCategoryLookup(result))\n      .catch(console.warn)\n  })\n\n  const [catDefaultFilter, setCatDefaultFilter] = useState<\n    '' | string[] | undefined\n  >(\n    () =>\n      props.match &&\n      props.match.params &&\n      props.match.params.cat && [decodeURIComponent(props.match.params.cat)]\n  )\n  const [subCatDefaultFilter, setSubCatDefaultFilter] = useState<\n    '' | string[] | undefined\n  >(\n    () =>\n      props.match &&\n      props.match.params &&\n      props.match.params.subcat && [\n        decodeURIComponent(props.match.params.subcat)\n      ]\n  )\n\n  const [onHandDefaultFilter] = useState<string | undefined>(() =>\n    !!(\n      props.match &&\n      props.match.params &&\n      props.match.params.onhand &&\n      decodeURIComponent(props.match.params.onhand)\n    )\n      ? 'checked'\n      : undefined\n  )\n\n  function setSelectedCatsFromQuery(query: Query<any>) {\n    try {\n      const categories = query.filters\n        .filter((f) => f.column.field === 'category')\n        .reduce(\n          (terms: string[], t: { value: string[] }) => [...terms, ...t.value],\n          []\n        )\n      const subCatz = query.filters\n        .filter((f) => f.column.field === 'sub_category')\n        .reduce(\n          (terms: string[], t: { value: string[] }) => [...terms, ...t.value],\n          []\n        )\n      if (categories.length === 0) {\n        return\n      }\n\n      fetch(`${API_HOST}/sub_categories`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({ categories })\n      })\n        .then((response) => response.json())\n        .then((result) => {\n          setCatDefaultFilter(categories)\n          setSubCategoryLookup(result)\n          setSubCatDefaultFilter(subCatz)\n        })\n        .catch((err) => {\n          console.warn('onoz, caught err:', err)\n          // setSubCategories([])\n        })\n    } catch (e) {\n      console.warn('onoz caught err:', e)\n    }\n  }\n\n  return (\n    <>\n      <MaterialTable\n        columns={[\n          {\n            title: 'category',\n            field: 'category',\n            type: 'string',\n            lookup: categoryLookup,\n            filterPlaceholder: 'filter',\n            defaultFilter: catDefaultFilter\n          },\n          {\n            title: 'sub category',\n            field: 'sub_category',\n            type: 'string',\n            lookup: subCategoryLookup,\n            filterPlaceholder: 'filter',\n            defaultFilter: subCatDefaultFilter\n          },\n          {\n            title: 'description',\n            field: 'description',\n            type: 'string',\n            filterPlaceholder: 'filter',\n            filterCellStyle: {\n              paddingTop: '32px'\n            },\n            render: (row) => {\n              if (row.name) {\n                return `${row.name} -- ${row.description}`\n              } else {\n                return row.description\n              }\n            }\n          },\n          {\n            title: 'pk',\n            field: 'pk',\n            type: 'numeric',\n            filtering: false\n          },\n          { title: 'size', field: 'size', type: 'string', filtering: false },\n          {\n            title: 'unit type',\n            field: 'unit_type',\n            type: 'string',\n            lookup: { CS: 'Case', EA: 'Each' },\n            filterPlaceholder: 'filter'\n          },\n          {\n            title: 'price',\n            field: 'ws_price',\n            type: 'currency',\n            filtering: false\n          },\n          {\n            title: 'unit price',\n            field: 'u_price',\n            type: 'currency',\n            filtering: false,\n            render: (row) =>\n              row.ws_price !== row.u_price ? `$${row.u_price}` : ''\n          },\n          {\n            title: 'properties',\n            field: 'codes',\n            type: 'string',\n            lookup: PROPERTY_MAP,\n            filterPlaceholder: 'filter',\n            render: (row) => renderCodes(row.codes)\n          },\n          {\n            title: 'on hand',\n            field: 'count_on_hand',\n            type: 'boolean',\n            filterCellStyle: {\n              paddingTop: '32px'\n            },\n            // tableData: { checked: true },\n            // lookup: { true: 'TRUE', false: 'FALSE' },\n            defaultFilter: onHandDefaultFilter,\n            render: (row) => row.count_on_hand\n          },\n          {\n            title: undefined,\n            field: undefined,\n            type: 'string',\n            render: (row) => {\n              const inCart = true\n              const label = inCart\n                ? 'add to shopping cart'\n                : 'remove from shopping cart'\n              return (\n                <Tooltip aria-label={label} title={label}>\n                  <IconButton\n                    color=\"secondary\"\n                    onClick={() => {\n                      addToCart(row)\n                      setCartDrawerOpen(true)\n                    }}\n                  >\n                    {inCart ? (\n                      <AddShoppingCartIcon />\n                    ) : (\n                      <RemoveShoppingCartIcon />\n                    )}\n                  </IconButton>\n                </Tooltip>\n              )\n            }\n          },\n          { title: 'upc', field: 'upc_code', type: 'string', hidden: true },\n          // { title: 'unf', field: 'unf', type: 'string' },\n          { title: 'id', field: 'id', type: 'string', hidden: true }\n        ]}\n        data={(query) =>\n          new Promise((resolve, reject) => {\n            setSelectedCatsFromQuery(query)\n            fetch(`${API_HOST}/products`, {\n              method: 'post',\n              headers: {\n                'Content-Type': 'application/json'\n              },\n              body: JSON.stringify(query)\n            })\n              .then((response) => response.json())\n              .then((result) => {\n                resolve(result)\n              })\n              .catch((err) => {\n                console.warn('onoz, caught err:', err)\n                return resolve({ data: [], page: 0, totalCount: 0 })\n              })\n          })\n        }\n        title={\n          <Button\n            variant=\"text\"\n            size=\"large\"\n            onClick={() => props.history.push('/')}\n          >\n            {narrowWidth ? (\n              <BackIcon />\n            ) : (\n              <Typography variant=\"h6\">MARSH COOP</Typography>\n            )}\n          </Button>\n        }\n        options={{\n          headerStyle: { position: 'sticky', top: 0 },\n          filterCellStyle: { maxWidth: '132px' },\n          maxBodyHeight: 'calc(100vh - 133px)',\n          pageSize: 50,\n          pageSizeOptions: [50, 100, 500],\n          debounceInterval: 750,\n          filtering: true,\n          search: true,\n          emptyRowsWhenPaging: false\n        }}\n        actions={actions}\n      />\n      <CartDrawer open={cartDrawerOpen} setOpen={setCartDrawerOpen} />\n      <UserMenu anchorEl={userMenuAnchorEl} setAnchorEl={setUserMenuAnchorEl} />\n    </>\n  )\n}\n\nexport default withRouter(DataTable)\n","import React, { useState } from 'react'\nimport { withRouter, RouteComponentProps } from 'react-router-dom'\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport IconButton from '@material-ui/core/IconButton'\nimport Typography from '@material-ui/core/Typography'\nimport Button from '@material-ui/core/Button'\nimport Fade from '@material-ui/core/Fade'\nimport Badge from '@material-ui/core/Badge'\nimport { createStyles, fade, Theme, makeStyles } from '@material-ui/core/styles'\nimport TagFacesIcon from '@material-ui/icons/TagFaces'\n// import SearchIcon from '@material-ui/icons/Search'\nimport ShoppingCartIcon from '@material-ui/icons/ShoppingCart'\n\nimport UserMenu from './UserMenu'\nimport { useCartItemCount } from '../services/useCartService'\nimport CartDrawer from './CartDrawer'\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      flexGrow: 1,\n      boxShadow: 'none'\n    },\n    toolbar: {\n      backgroundColor: theme.palette.background.default,\n      color: theme.palette.text.primary\n    },\n    menuButton: {\n      marginLeft: theme.spacing(2)\n    },\n    grow: {\n      flexGrow: 1\n      // display: 'none',\n      // [theme.breakpoints.up('sm')]: {\n      //   display: 'block'\n      // }\n    },\n    search: {\n      position: 'relative',\n      borderRadius: theme.shape.borderRadius,\n      backgroundColor: fade(theme.palette.common.white, 0.15),\n      '&:hover': {\n        backgroundColor: fade(theme.palette.common.white, 0.25)\n      },\n      marginLeft: 0,\n      width: '100%',\n      [theme.breakpoints.up('sm')]: {\n        marginLeft: theme.spacing(1),\n        width: 'auto'\n      }\n    },\n    searchIcon: {\n      width: theme.spacing(7),\n      height: '100%',\n      position: 'absolute',\n      pointerEvents: 'none',\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center'\n    },\n    inputRoot: {\n      color: 'inherit'\n    },\n    inputInput: {\n      padding: theme.spacing(1, 1, 1, 7),\n      transition: theme.transitions.create('width'),\n      width: '100%',\n      [theme.breakpoints.up('sm')]: {\n        width: 120,\n        '&:focus': {\n          width: 200\n        }\n      }\n    }\n  })\n)\n\ninterface NavBarProps {\n  showCart?: boolean\n  onBrandBtnClick?: () => void\n  children?: React.ReactNode\n}\n\nfunction NavBar(props: NavBarProps & RouteComponentProps) {\n  const classes = useStyles()\n  const itemCount = useCartItemCount()\n\n  const { showCart } = props\n  const [cartDrawerOpen, setCartDrawerOpen] = useState(false)\n  const [userMenuAnchorEl, setUserMenuAnchorEl] = useState<null | HTMLElement>(\n    null\n  )\n\n  const handleUserMenuClick = (event: React.MouseEvent<HTMLElement>) => {\n    setUserMenuAnchorEl(event.currentTarget)\n  }\n\n  return (\n    <AppBar position=\"static\" className={classes.root}>\n      <Toolbar className={classes.toolbar}>\n        <div>\n          <Fade in>\n            <Button\n              variant=\"text\"\n              size=\"large\"\n              onClick={() => {\n                props.history.push('/')\n                props.onBrandBtnClick && props.onBrandBtnClick()\n              }}\n            >\n              <Typography variant=\"h6\">MARSH COOP</Typography>\n            </Button>\n          </Fade>\n        </div>\n\n        {props.children || <div className={classes.grow}>&nbsp;</div>}\n\n        {/* <div className={classes.search}>\n          <div className={classes.searchIcon}>\n            <SearchIcon />\n          </div>\n          <InputBase\n            placeholder=\"Search…\"\n            classes={{\n              root: classes.inputRoot,\n              input: classes.inputInput\n            }}\n            inputProps={{ 'aria-label': 'search' }}\n          />\n        </div> */}\n\n        {showCart && itemCount > 0 && (\n          <IconButton\n            edge=\"end\"\n            className={classes.menuButton}\n            color=\"inherit\"\n            aria-label=\"show cart\"\n            onClick={() => setCartDrawerOpen((prev) => !prev)}\n          >\n            <Badge badgeContent={itemCount} max={99} color=\"secondary\">\n              <ShoppingCartIcon />\n            </Badge>\n          </IconButton>\n        )}\n\n        <IconButton\n          edge=\"end\"\n          className={classes.menuButton}\n          color=\"inherit\"\n          aria-label=\"user menu\"\n          onClick={handleUserMenuClick}\n        >\n          <TagFacesIcon />\n        </IconButton>\n      </Toolbar>\n      <UserMenu anchorEl={userMenuAnchorEl} setAnchorEl={setUserMenuAnchorEl} />\n      <CartDrawer open={cartDrawerOpen} setOpen={setCartDrawerOpen} />\n    </AppBar>\n  )\n}\n\nexport default withRouter(NavBar)\n","import React, { useState, useEffect } from 'react'\nimport { withRouter, RouteComponentProps } from 'react-router-dom'\n// import Paper from '@material-ui/core/Paper'\nimport Typography from '@material-ui/core/Typography'\nimport Button from '@material-ui/core/Button'\nimport Grid from '@material-ui/core/Grid'\nimport Fade from '@material-ui/core/Fade'\nimport Zoom from '@material-ui/core/Zoom'\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight'\nimport { createStyles, Theme, makeStyles } from '@material-ui/core/styles'\n\nimport NavBar from './NavBar'\nimport { API_HOST } from '../constants'\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    gridRoot: {\n      width: '100%',\n      overflowX: 'auto',\n      minHeight: 'calc(100vh - 64px)',\n      padding: theme.spacing(2),\n      display: 'flex',\n      marginTop: 0\n    },\n    flexFill: {\n      flexGrow: 1\n    },\n    crumbz: {\n      display: 'flex',\n      flexDirection: 'row',\n      justifyContent: 'flex-start',\n      alignItems: 'center',\n      flexGrow: 1,\n      [theme.breakpoints.down('sm')]: {\n        display: 'none'\n      }\n    },\n    gridBtn: {\n      width: '100%',\n      height: '100%',\n      background: theme.palette.background.paper,\n      '&:hover': {\n        textDecoration: 'underline',\n        cursor: 'pointer'\n      }\n    },\n    catHover: {\n      '&:hover': {\n        textDecoration: 'underline',\n        cursor: 'pointer'\n      }\n    },\n    catBtn: {\n      overflow: 'hidden',\n      overflowWrap: 'break-word',\n      hyphens: 'auto'\n    }\n  })\n)\n\nfunction Landing(props: RouteComponentProps) {\n  const classes = useStyles()\n\n  const [categories, setCategories] = useState<string[]>([])\n  const [selectedCat, setSelectedCat] = useState('')\n  const [subCategories, setSubCategories] = useState<\n    { name: string; label: string }[]\n  >([])\n\n  useEffect(() => {\n    fetch(`${API_HOST}/categories`)\n      .then((response) => response.json())\n      .then((result) => {\n        const catz = Object.keys(result).filter((cat) => {\n          const tcat = cat.trim()\n          return !!tcat && tcat !== 'null'\n        })\n        setCategories(catz)\n      })\n      .catch((err) => {\n        console.warn('onoz, caught err:', err)\n        setCategories([])\n      })\n  }, [setCategories])\n\n  useEffect(() => {\n    fetch(`${API_HOST}/sub_categories`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({ categories: [selectedCat] })\n    })\n      .then((response) => response.json())\n      .then((result) => {\n        setSubCategories(\n          Object.keys(result)\n            .filter((subcat) => {\n              const tsubcat = subcat.trim()\n              return !!tsubcat && tsubcat !== 'null'\n            })\n            .map((name) => ({\n              name,\n              label: name\n                .split(':')\n                .join(': ')\n                .split(',')\n                .join(', ')\n                .split('/')\n                .join(' / ')\n                .split('-')\n                .join(' - ')\n            }))\n        )\n      })\n      .catch((err) => {\n        console.warn('onoz, caught err:', err)\n        setSubCategories([])\n      })\n  }, [selectedCat])\n\n  return (\n    <>\n      <NavBar onBrandBtnClick={() => setSelectedCat('')} showCart>\n        <div className={classes.flexFill}></div>\n        {selectedCat && (\n          <div className={classes.crumbz}>\n            <Fade in>\n              <ChevronRightIcon fontSize=\"large\" />\n            </Fade>\n            <Fade in style={{ transitionDelay: '50ms' }}>\n              <Button\n                variant=\"text\"\n                size=\"large\"\n                onClick={() => setSelectedCat('')}\n              >\n                <Typography\n                  variant=\"h6\"\n                  className={selectedCat && classes.catHover}\n                >\n                  CATEGORIES\n                </Typography>\n              </Button>\n            </Fade>\n\n            <Fade in style={{ transitionDelay: '100ms' }}>\n              <ChevronRightIcon fontSize=\"large\" />\n            </Fade>\n            <Fade in style={{ transitionDelay: '150ms' }}>\n              <Typography variant=\"h6\">{selectedCat.toUpperCase()}</Typography>\n            </Fade>\n          </div>\n        )}\n      </NavBar>\n      {/* <Paper className={classes.root}> */}\n      <Grid container spacing={4} justify=\"center\" className={classes.gridRoot}>\n        {categories &&\n          !selectedCat &&\n          categories.map((i, idx) => (\n            <Zoom\n              in\n              style={{ transitionDelay: `${idx * 50}ms` }}\n              key={`lb${idx}`}\n            >\n              <Grid item xs={12} sm={4} md={3} lg={2}>\n                <Button\n                  className={classes.gridBtn}\n                  variant=\"outlined\"\n                  size=\"large\"\n                  key={`lb${idx}`}\n                  onClick={() => setSelectedCat(i)}\n                >\n                  <Typography variant=\"h5\" className={classes.catBtn}>\n                    {i}\n                  </Typography>\n                </Button>\n              </Grid>\n            </Zoom>\n          ))}\n\n        {categories.length > 0 && !selectedCat && (\n          <>\n            <Zoom\n              in\n              style={{\n                transitionDelay: `${categories.length * 50}ms`\n              }}\n            >\n              <Grid item xs={12} sm={4} md={3} lg={3}>\n                <Button\n                  className={classes.gridBtn}\n                  variant=\"outlined\"\n                  size=\"large\"\n                  onClick={() => props.history.push('/products/onhand/marsh')}\n                >\n                  <Typography variant=\"h5\" className={classes.catBtn}>\n                    MARSH ON HAND\n                  </Typography>\n                </Button>\n              </Grid>\n            </Zoom>\n\n            <Zoom\n              in\n              style={{\n                transitionDelay: `${categories.length * 50}ms`\n              }}\n            >\n              <Grid item xs={12} sm={4} md={3} lg={3}>\n                <Button\n                  className={classes.gridBtn}\n                  variant=\"outlined\"\n                  size=\"large\"\n                  onClick={() => props.history.push('/products')}\n                >\n                  <Typography variant=\"h5\" className={classes.catBtn}>\n                    See Everything\n                  </Typography>\n                </Button>\n              </Grid>\n            </Zoom>\n          </>\n        )}\n\n        {subCategories &&\n          selectedCat &&\n          subCategories.map((subCat, idx) => (\n            <Zoom\n              in\n              style={{ transitionDelay: `${idx * 50}ms` }}\n              key={`lb${idx}`}\n            >\n              <Grid item xs={12} sm={4} md={3}>\n                <Button\n                  className={classes.gridBtn}\n                  variant=\"outlined\"\n                  size=\"large\"\n                  key={`lb${idx}`}\n                  onClick={() =>\n                    props.history.push(\n                      `/products/${encodeURIComponent(\n                        selectedCat\n                      )}/${encodeURIComponent(subCat.name)}`\n                    )\n                  }\n                >\n                  <Typography variant=\"h5\" className={classes.catBtn}>\n                    {subCat.label}\n                  </Typography>\n                </Button>\n              </Grid>\n            </Zoom>\n          ))}\n\n        {subCategories.length > 0 && selectedCat && (\n          <Zoom\n            in\n            style={{\n              transitionDelay: `${subCategories.length * 50}ms`\n            }}\n          >\n            <Grid item xs={12} sm={4} md={3}>\n              <Button\n                className={classes.gridBtn}\n                variant=\"outlined\"\n                size=\"large\"\n                onClick={() =>\n                  props.history.push(\n                    `/products/${encodeURIComponent(selectedCat)}`\n                  )\n                }\n              >\n                <Typography variant=\"h5\" className={classes.catBtn}>\n                  See Everything\n                </Typography>\n              </Button>\n            </Grid>\n          </Zoom>\n        )}\n      </Grid>\n      {/* </Paper> */}\n    </>\n  )\n}\n\nexport default withRouter(Landing)\n","import React from 'react'\nimport { Container } from '@material-ui/core'\nimport Box from '@material-ui/core/Box'\n\nexport default function Loading() {\n  return (\n    <Container fixed>\n      <Box pt={4} style={{ textAlign: 'center' }}>\n        L O A D I N G . . .\n      </Box>\n    </Container>\n  )\n}\n","import React, { useState, useEffect, useRef } from 'react'\nimport Button from '@material-ui/core/Button'\n\nimport '../sq-payment-form.css'\nimport {\n  SQUARE_APP_ID,\n  SQUARE_LOCATION_ID,\n  SQUARE_PAYMENT_JS\n} from '../constants'\nimport Loading from './Loading'\n\ndeclare const SqPaymentForm: any\n\nconst styles: { [key: string]: React.CSSProperties } = {\n  name: {\n    verticalAlign: 'top',\n    display: 'none',\n    margin: 0,\n    border: 'none',\n    fontSize: '16px',\n    fontFamily: 'Helvetica Neue',\n    padding: '16px',\n    color: '#373F4A',\n    backgroundColor: 'transparent',\n    lineHeight: '1.15em'\n  },\n  leftCenter: {\n    float: 'left',\n    textAlign: 'center'\n  },\n  blockRight: {\n    display: 'block',\n    float: 'right'\n  },\n  center: {\n    textAlign: 'center'\n  },\n  error: {\n    textAlign: 'center',\n    fontWeight: 'bold',\n    fontSize: '1.25rem',\n    whiteSpace: 'pre-wrap',\n    color: 'red'\n  }\n}\n\ninterface SquarePaymentFormProps {\n  paymentForm: any\n  handleNext: (nonce: string) => void\n  amount: number\n  loading: boolean\n}\nfunction SquarePaymentForm(props: SquarePaymentFormProps) {\n  const [cardBrand, setCardBrand] = useState('')\n  const [googlePay, setGooglePay] = useState(false)\n  const [applePay, setApplePay] = useState(false)\n  const [masterpass, setMasterpass] = useState(false)\n  const [error, setError] = useState('')\n  const [loading, setLoading] = useState(true)\n  const config = {\n    applicationId: SQUARE_APP_ID,\n    locationId: SQUARE_LOCATION_ID,\n    inputClass: 'sq-input',\n    autoBuild: false,\n    inputStyles: [\n      {\n        fontSize: '16px',\n        fontFamily: 'Helvetica Neue',\n        padding: '16px',\n        color: '#373F4A',\n        backgroundColor: 'transparent',\n        lineHeight: '1.15em'\n      }\n    ],\n    applePay: {\n      elementId: 'sq-apple-pay'\n    },\n    masterpass: {\n      elementId: 'sq-masterpass'\n    },\n    googlePay: {\n      elementId: 'sq-google-pay'\n    },\n    cardNumber: {\n      elementId: 'sq-card-number',\n      placeholder: '• • • •  • • • •  • • • •  • • • •'\n    },\n    cvv: {\n      elementId: 'sq-cvv',\n      placeholder: 'CVV'\n    },\n    expirationDate: {\n      elementId: 'sq-expiration-date',\n      placeholder: 'MM/YY'\n    },\n    postalCode: {\n      elementId: 'sq-postal-code',\n      placeholder: 'Zip'\n    },\n    callbacks: {\n      methodsSupported: (methods: any) => {\n        if (methods.googlePay) {\n          setGooglePay(true)\n        }\n        if (methods.applePay) {\n          setApplePay(true)\n        }\n        if (methods.masterpass) {\n          setMasterpass(true)\n        }\n        return\n      },\n      createPaymentRequest: () => {\n        return {\n          requestShippingAddress: false,\n          requestBillingInfo: true,\n          currencyCode: 'USD',\n          countryCode: 'US',\n          total: {\n            label: 'MARSH COOP',\n            amount: props.amount,\n            pending: false\n          },\n          lineItems: [\n            {\n              label: 'Subtotal',\n              amount: props.amount,\n              pending: false\n            }\n          ]\n        }\n      },\n      cardNonceResponseReceived: (errors: any, nonce: any, cardData: any) => {\n        if (errors) {\n          // Log errors from nonce generation to the Javascript console\n          console.warn('Encountered errors:')\n          errors.forEach(function (error: any) {\n            console.warn('  ' + error.message)\n          })\n          setError(\n            `Encountered errors:\\n${errors\n              .map((e: any) => e.message)\n              .join('\\n')}`\n          )\n          return\n        }\n        // console.log('cardNonceResponseReceived nonce:', nonce)\n        props.handleNext(nonce)\n      },\n      unsupportedBrowserDetected: () => {},\n      inputEventReceived: (inputEvent: any) => {\n        switch (inputEvent.eventType) {\n          case 'focusClassAdded':\n            break\n          case 'focusClassRemoved':\n            break\n          case 'errorClassAdded':\n            setError('Please fix card information errors before continuing.')\n            break\n          case 'errorClassRemoved':\n            setError('')\n            break\n          case 'cardBrandChanged':\n            if (inputEvent.cardBrand !== 'unknown') {\n              setCardBrand(inputEvent.cardBrand)\n            } else {\n              setCardBrand('')\n            }\n            break\n          case 'postalCodeChanged':\n            break\n          default:\n            break\n        }\n      },\n      paymentFormLoaded: function () {\n        // console.log('paymentFormLoaded!')\n        setLoading(false)\n        // document.getElementById('name').style.display = \"inline-flex\";\n      }\n    }\n  }\n\n  const paymentFormRef = useRef(new props.paymentForm(config))\n\n  function requestCardNonce() {\n    // console.log(\n    //   'requestCardNonce paymentFormRef:',\n    //   paymentFormRef.current.requestCardNonce,\n    //   ' props.paymentForm:',\n    //   props.paymentForm.requestCardNonce\n    // )\n    paymentFormRef.current.requestCardNonce &&\n      paymentFormRef.current.requestCardNonce()\n    // props.paymentForm.requestCardNonce()\n  }\n\n  useEffect(() => {\n    // console.log(\n    //   '!!! SquarePaymentForm !!! fx, gonna paymentFormRef.current.build() !!!'\n    // )\n    paymentFormRef.current.build()\n    // paymentFormRef && paymentFormRef.current && paymentFormRef.current.build()\n  }, [])\n\n  return (\n    <>\n      {loading && <Loading />}\n      <div style={{ display: loading ? 'hidden' : 'block', margin: '1em' }}>\n        <div className=\"container\">\n          <div id=\"form-container\">\n            <div id=\"sq-walletbox\">\n              <button\n                style={{ display: applePay ? 'inherit' : 'none' }}\n                className=\"button-apple-pay\"\n                id=\"sq-apple-pay\"\n              ></button>\n              <button\n                style={{ display: masterpass ? 'block' : 'none' }}\n                className=\"button-masterpass\"\n                id=\"sq-masterpass\"\n              ></button>\n              <button\n                style={{ display: googlePay ? 'inherit' : 'none' }}\n                className=\"button-google-pay\"\n                id=\"sq-google-pay\"\n              ></button>\n\n              <div className=\"sq-wallet-divider\">\n                <span className=\"sq-wallet-divider__text\">Or</span>\n              </div>\n            </div>\n\n            <div id=\"sq-ccbox\">\n              <p>\n                <span style={styles.leftCenter}>Enter Card Info Below </span>\n                <span style={styles.blockRight}>{cardBrand.toUpperCase()}</span>\n              </p>\n              <div id=\"cc-field-wrapper\">\n                <div id=\"sq-card-number\"></div>\n                <input type=\"hidden\" id=\"card-nonce\" name=\"nonce\" />\n                <div id=\"sq-expiration-date\"></div>\n                <div id=\"sq-cvv\"></div>\n              </div>\n              <input\n                id=\"name\"\n                style={styles.name}\n                type=\"text\"\n                placeholder=\"Name\"\n              />\n              <div id=\"sq-postal-code\"></div>\n            </div>\n\n            <Button\n              variant=\"contained\"\n              color=\"primary\"\n              onClick={requestCardNonce}\n              fullWidth\n              disabled={props.loading}\n            >\n              Pay ${(props.amount / 100).toFixed(2)}\n            </Button>\n          </div>\n          <p style={styles.error} id=\"error\">\n            {error}\n          </p>\n        </div>\n      </div>\n    </>\n  )\n}\n\ninterface SquarePaymentProps {\n  handleNext: (nonce: string) => void\n  amount: number\n  loading: boolean\n}\n\nexport default function SquarePayment(props: SquarePaymentProps) {\n  const [jsloaded, setJsloaded] = useState(false)\n\n  useEffect(() => {\n    let sqPaymentScript = document.createElement('script')\n    sqPaymentScript.src = SQUARE_PAYMENT_JS\n    sqPaymentScript.type = 'text/javascript'\n    sqPaymentScript.async = false\n    sqPaymentScript.onload = () => setJsloaded(true)\n    document.getElementsByTagName('head')[0].appendChild(sqPaymentScript)\n  }, [])\n\n  return jsloaded ? (\n    <SquarePaymentForm\n      paymentForm={SqPaymentForm}\n      handleNext={props.handleNext}\n      amount={props.amount || 0}\n      loading={props.loading}\n    />\n  ) : (\n    <Loading />\n  )\n}\n","import React from 'react'\nimport {\n  createStyles,\n  Theme,\n  withStyles,\n  WithStyles,\n  makeStyles\n} from '@material-ui/core/styles'\nimport Button from '@material-ui/core/Button'\nimport Dialog from '@material-ui/core/Dialog'\nimport MuiDialogTitle from '@material-ui/core/DialogTitle'\nimport MuiDialogContent from '@material-ui/core/DialogContent'\nimport IconButton from '@material-ui/core/IconButton'\nimport CloseIcon from '@material-ui/icons/Close'\nimport PaymentIcon from '@material-ui/icons/AttachMoney'\nimport Typography from '@material-ui/core/Typography'\nimport Box from '@material-ui/core/Box'\n\nimport { Order } from '../types/Order'\nimport { API_HOST } from '../constants'\nimport SquarePayment from './SquarePayment'\nimport Loading from './Loading'\n\nconst styles = (theme: Theme) =>\n  createStyles({\n    root: {\n      margin: 0,\n      padding: theme.spacing(2)\n    },\n    closeButton: {\n      position: 'absolute',\n      right: theme.spacing(1),\n      top: theme.spacing(1),\n      color: theme.palette.grey[500]\n    }\n  })\n\ninterface DialogTitleProps extends WithStyles<typeof styles> {\n  id: string\n  children: React.ReactNode\n  onClose: () => void\n}\n\nconst DialogTitle = withStyles(styles)((props: DialogTitleProps) => {\n  const { children, classes, onClose, ...other } = props\n  return (\n    <MuiDialogTitle disableTypography className={classes.root} {...other}>\n      <Typography variant=\"h6\">{children}</Typography>\n      {onClose ? (\n        <IconButton\n          aria-label=\"close\"\n          className={classes.closeButton}\n          onClick={onClose}\n        >\n          <CloseIcon />\n        </IconButton>\n      ) : null}\n    </MuiDialogTitle>\n  )\n})\n\nconst DialogContent = withStyles((theme: Theme) => ({\n  root: {\n    padding: theme.spacing(2)\n  }\n}))(MuiDialogContent)\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    error: {\n      display: 'flex',\n      flexDirection: 'column',\n      textAlign: 'right',\n      padding: theme.spacing(2)\n    }\n  })\n)\n\ninterface PaymentDialogProps {\n  amount: number\n  description: string\n  order: Order\n  setRefetchOrders: React.Dispatch<React.SetStateAction<number>>\n}\n\nfunction PaymentDialog(props: PaymentDialogProps) {\n  const classes = useStyles()\n  const [open, setOpen] = React.useState(false)\n  const [loading, setLoading] = React.useState(false)\n  const [complete, setComplete] = React.useState(false)\n  const [error, setError] = React.useState('')\n  const { order, description, setRefetchOrders } = props\n  const amount = Math.floor(props.amount * 100)\n\n  const handleClickOpen = () => {\n    setOpen(true)\n  }\n  const handleClose = () => {\n    setOpen(false)\n  }\n\n  function handleNext(nonce: string) {\n    setLoading(true)\n    setError('')\n    fetch(`${API_HOST}/store/payment`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      credentials: 'include',\n      body: JSON.stringify({ order, amount, description, nonce })\n    })\n      .then((r) => r.json())\n      .then((response) => {\n        if (response.error) {\n          console.warn('/store/payment ERROR response:', response)\n          setError(response.msg || 'onoz! could not submit your payment ;(')\n        } else {\n          setComplete(true)\n          setRefetchOrders((prev) => prev + 1)\n          handleClose()\n        }\n      })\n      .catch((err) => {\n        console.warn('onoz! caught error /store/checkout err:', err)\n        setError('onoz! could not submit your order ;(')\n        setComplete(false)\n      })\n      .finally(() => setLoading(false))\n  }\n\n  return (\n    <div>\n      <Button\n        variant=\"outlined\"\n        color=\"primary\"\n        startIcon={<PaymentIcon />}\n        onClick={handleClickOpen}\n      >\n        Make Payment\n      </Button>\n\n      <Dialog\n        onClose={handleClose}\n        aria-labelledby=\"customized-dialog-title\"\n        open={open}\n      >\n        <DialogTitle id=\"customized-dialog-title\" onClose={handleClose}>\n          Payment for Order {description}\n        </DialogTitle>\n        <DialogContent dividers>\n          {loading && <Loading />}\n          {!loading && !complete && !error && (\n            <SquarePayment\n              handleNext={handleNext}\n              amount={amount}\n              loading={loading}\n            />\n          )}\n          {error && (\n            <Box color=\"error.main\" className={classes.error}>\n              <Typography variant=\"overline\" display=\"block\">\n                onoz! an error!\n              </Typography>\n              <Typography variant=\"body1\" display=\"block\" gutterBottom>\n                {error}\n              </Typography>\n            </Box>\n          )}\n        </DialogContent>\n      </Dialog>\n    </div>\n  )\n}\n\nexport default PaymentDialog\n","import React from 'react'\nimport { makeStyles, createStyles, Theme } from '@material-ui/core/styles'\nimport Grid from '@material-ui/core/Grid'\nimport Typography from '@material-ui/core/Typography'\nimport Table from '@material-ui/core/Table'\nimport TableBody from '@material-ui/core/TableBody'\nimport TableCell from '@material-ui/core/TableCell'\nimport TableHead from '@material-ui/core/TableHead'\nimport TableRow from '@material-ui/core/TableRow'\n\nimport { Order } from '../types/Order'\nimport PaymentDialog from './PaymentDialog'\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      marginRight: theme.spacing(2),\n      borderLeft: `${theme.spacing(6)}px solid ${theme.palette.divider}`\n    },\n    gridHeading: {\n      color: theme.palette.text.secondary\n    },\n    gridItem: {\n      paddingBottom: theme.spacing(2),\n      paddingLeft: theme.spacing(2),\n      paddingRight: theme.spacing(2),\n      textAlign: 'center'\n    },\n    lastUpdated: {\n      marginLeft: theme.spacing(2)\n    }\n  })\n)\n\nexport default function OrderDetailPanel(props: {\n  order: Order\n  setRefetchOrders: React.Dispatch<React.SetStateAction<number>>\n}) {\n  const classes = useStyles()\n  const order = props.order\n  const line_items = props.order.OrderLineItems || []\n  const adjustments = line_items.filter(\n    (li) =>\n      li.kind !== 'product' && li.kind !== 'payment' && li.kind !== 'credit'\n  )\n  const payments = line_items.filter((li) => li.kind === 'payment')\n  const paymentsTotal = payments.reduce(\n    (acc, v) => acc + parseFloat(`${v.total}`),\n    0\n  )\n  const credits = line_items.filter((li) => li.kind === 'credit')\n  const creditsTotal = credits.reduce(\n    (acc, v) => acc + parseFloat(`${v.total}`),\n    0\n  )\n  const balance =\n    parseFloat(`${order.total}`) +\n    parseFloat(`${creditsTotal}`) +\n    parseFloat(`${paymentsTotal}`)\n\n  return (\n    <div className={classes.root}>\n      <Table aria-label=\"order details table\" size=\"small\">\n        <TableHead>\n          <TableRow>\n            <TableCell component=\"th\">\n              Line Items ({order.item_count})\n            </TableCell>\n            <TableCell component=\"th\" align=\"right\">\n              price\n            </TableCell>\n            <TableCell component=\"th\" align=\"right\">\n              unit\n            </TableCell>\n            <TableCell component=\"th\" align=\"right\">\n              qty\n            </TableCell>\n            <TableCell component=\"th\" align=\"right\">\n              total\n            </TableCell>\n          </TableRow>\n        </TableHead>\n        <TableBody>\n          {line_items.map(\n            (li, idx) =>\n              li.kind === 'product' && (\n                <TableRow key={`orderli${idx}`}>\n                  <TableCell component=\"td\" scope=\"row\">\n                    {li.vendor && `[${li.vendor}] `}\n                    {li.description}\n                    {li.data && li.data.product\n                      ? ` ${li.data.product.unf}`\n                      : ''}\n                  </TableCell>\n                  <TableCell align=\"right\">{li.price}</TableCell>\n                  <TableCell align=\"right\">{li.selected_unit}</TableCell>\n                  <TableCell align=\"right\">{li.quantity}</TableCell>\n                  <TableCell align=\"right\">{li.total}</TableCell>\n                </TableRow>\n              )\n          )}\n\n          <TableRow>\n            <TableCell component=\"td\" scope=\"row\" colSpan={3} />\n            <TableCell component=\"td\" scope=\"row\" align=\"right\">\n              <b>Sub Total</b>\n            </TableCell>\n            <TableCell component=\"td\" scope=\"row\" align=\"right\">\n              {order.subtotal}\n            </TableCell>\n          </TableRow>\n\n          {adjustments.length > 0 && (\n            <TableRow>\n              <TableCell component=\"td\" scope=\"row\">\n                <b>Adjustments</b>\n              </TableCell>\n            </TableRow>\n          )}\n          {adjustments.map((li, idx) => (\n            <TableRow key={`orderli${idx}`}>\n              <TableCell component=\"td\" scope=\"row\" colSpan={3}>\n                {`(${li.kind}) `} {li.description}\n              </TableCell>\n              <TableCell align=\"right\">{li.quantity}</TableCell>\n              <TableCell align=\"right\">{li.total}</TableCell>\n            </TableRow>\n          ))}\n\n          <TableRow>\n            <TableCell component=\"td\" scope=\"row\" colSpan={3} />\n            <TableCell component=\"td\" scope=\"row\" align=\"right\">\n              <b>Order Total</b>\n            </TableCell>\n            <TableCell component=\"td\" scope=\"row\" align=\"right\">\n              {order.total}\n            </TableCell>\n          </TableRow>\n\n          {payments.length > 0 && (\n            <TableRow>\n              <TableCell component=\"td\" scope=\"row\">\n                <b>Payments</b>\n              </TableCell>\n            </TableRow>\n          )}\n          {payments.map((li, idx) => (\n            <TableRow key={`orderli${idx}`}>\n              <TableCell component=\"td\" scope=\"row\" colSpan={3}>\n                {li.description}\n              </TableCell>\n              <TableCell align=\"right\">{li.quantity}</TableCell>\n              <TableCell align=\"right\">{li.total}</TableCell>\n            </TableRow>\n          ))}\n\n          {credits.length > 0 && (\n            <TableRow>\n              <TableCell component=\"td\" scope=\"row\">\n                <b>Credits</b>\n              </TableCell>\n            </TableRow>\n          )}\n          {credits.map((li, idx) => (\n            <TableRow key={`orderli${idx}`}>\n              <TableCell component=\"td\" scope=\"row\" colSpan={3}>\n                {li.description}\n              </TableCell>\n              <TableCell align=\"right\">{li.quantity}</TableCell>\n              <TableCell align=\"right\">{li.total}</TableCell>\n            </TableRow>\n          ))}\n\n          {balance > 0 && (\n            <>\n              <TableRow>\n                <TableCell component=\"td\" scope=\"row\" colSpan={3} />\n                <TableCell component=\"td\" scope=\"row\" align=\"right\">\n                  <b>Balance Due</b>\n                </TableCell>\n                <TableCell component=\"td\" scope=\"row\" align=\"right\">\n                  {balance.toFixed(2)}\n                </TableCell>\n              </TableRow>\n              <TableRow>\n                <TableCell colSpan={5} align=\"right\">\n                  <PaymentDialog\n                    amount={balance}\n                    description={`#${order.id}`}\n                    order={order}\n                    setRefetchOrders={props.setRefetchOrders}\n                  />\n                </TableCell>\n              </TableRow>\n            </>\n          )}\n\n          {balance < 0 && (\n            <TableRow>\n              <TableCell component=\"td\" scope=\"row\" colSpan={3} />\n              <TableCell component=\"td\" scope=\"row\" align=\"right\">\n                <b>Credit Owed</b>\n              </TableCell>\n              <TableCell component=\"td\" scope=\"row\" align=\"right\">\n                {Math.abs(balance).toFixed(2)}\n              </TableCell>\n            </TableRow>\n          )}\n        </TableBody>\n      </Table>\n\n      <Grid container direction=\"row\" justify=\"center\" alignItems=\"flex-start\">\n        <Grid item xs={6}>\n          <div className={classes.gridItem}>\n            <Typography\n              variant=\"overline\"\n              display=\"block\"\n              className={classes.gridHeading}\n              gutterBottom\n            >\n              Info\n            </Typography>\n            <Typography variant=\"body1\">\n              {order.name} {order.email}\n              <br />\n              {order.phone}\n              <br />\n              {order.address} <br />\n            </Typography>\n          </div>\n        </Grid>\n        <Grid item xs={6}>\n          <div className={classes.gridItem}>\n            <Typography\n              variant=\"overline\"\n              display=\"block\"\n              className={classes.gridHeading}\n              gutterBottom\n            >\n              notes\n            </Typography>\n            <Typography variant=\"body2\">{order.notes}</Typography>\n          </div>\n        </Grid>\n      </Grid>\n\n      <div className={classes.lastUpdated}>\n        <i>Created: </i> {new Date(order.createdAt).toLocaleString()}\n        {order.createdAt !== order.updatedAt && (\n          <>\n            <i>, Last updated:</i> {new Date(order.updatedAt).toLocaleString()}\n          </>\n        )}\n      </div>\n    </div>\n  )\n}\n","import React, { useState, useEffect } from 'react'\nimport { withRouter, RouteComponentProps } from 'react-router-dom'\nimport { connect } from 'react-redux'\nimport { makeStyles } from '@material-ui/core/styles'\nimport MaterialTable from 'material-table'\nimport { formatDistance } from 'date-fns'\n\nimport { API_HOST } from '../constants'\nimport { RootState } from '../redux'\nimport { UserServiceProps } from '../redux/session/reducers'\nimport { Order } from '../types/Order'\nimport OrderDetailPanel from './OrderDetailPanel'\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    margin: `0 ${theme.spacing(2)}px`\n  },\n  storeCredit: {\n    display: 'flex',\n    flexDirection: 'column',\n    color: theme.palette.text.primary\n  }\n}))\n\nexport async function fetchStoreCredit(\n  setStoreCredit: React.Dispatch<React.SetStateAction<number>>\n) {\n  const store_credit = await fetch(`${API_HOST}/store_credit`, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    credentials: 'include'\n  })\n    .then((response: any) => response.json())\n    .then((response) =>\n      response && response.store_credit ? response.store_credit : 0\n    )\n    .catch((err: any) => 0)\n\n  setStoreCredit(store_credit)\n}\n\nfunction MyOrders(props: UserServiceProps & RouteComponentProps) {\n  const { userService } = props\n  const classes = useStyles()\n  const [myorders, setMyOrders] = useState<Order[]>([])\n  const [storeCredit, setStoreCredit] = useState(0)\n  const [refetchOrders, setRefetchOrders] = useState(0)\n\n  const storeCreditAction = {\n    icon: () =>\n      storeCredit !== 0 ? (\n        <div className={classes.storeCredit}>\n          <div style={{ fontSize: '0.8em' }}>{`$${Math.abs(storeCredit).toFixed(\n            2\n          )}`}</div>\n          <div style={{ fontSize: '0.6em' }}>store credit</div>\n        </div>\n      ) : (\n        <></>\n      ),\n    isFreeAction: true,\n    onClick: () => {},\n    disabled: true\n  }\n\n  useEffect(() => {\n    userService.user &&\n      fetch(`${API_HOST}/myorders`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        credentials: 'include'\n      })\n        .then((r) => r.json())\n        .then((response) => {\n          setMyOrders(response.orders || [])\n        })\n        .catch((err) => console.warn('onoz /member/me caught err:', err))\n    userService.user && fetchStoreCredit(setStoreCredit)\n  }, [userService, refetchOrders])\n\n  return (\n    <div className={`${classes.root} MyOrders`}>\n      <MaterialTable\n        columns={[\n          {\n            title: 'Created',\n            field: 'createdAt',\n            type: 'date',\n            render: (row) =>\n              row.createdAt &&\n              formatDistance(new Date(row.createdAt), Date.now(), {\n                addSuffix: true\n              })\n          },\n          {\n            title: 'Status',\n            field: 'status',\n            type: 'string'\n          },\n          {\n            title: 'Payment Status',\n            field: 'payment_status',\n            type: 'string'\n          },\n          {\n            title: 'Shipment Status',\n            field: 'shipment_status',\n            type: 'string'\n          },\n          { title: 'Item Count', field: 'item_count', type: 'numeric' },\n          {\n            title: 'Total',\n            field: 'total',\n            type: 'currency'\n          },\n          { title: 'id', field: 'id', type: 'string', hidden: true }\n        ]}\n        data={myorders}\n        title=\"My Orders\"\n        actions={[storeCreditAction]}\n        detailPanel={(order) => (\n          <OrderDetailPanel order={order} setRefetchOrders={setRefetchOrders} />\n        )}\n        onRowClick={(event, rowData, togglePanel) =>\n          togglePanel && togglePanel()\n        }\n        options={{\n          headerStyle: { position: 'sticky', top: 0 },\n          filterCellStyle: { maxWidth: '132px' },\n          maxBodyHeight: 'calc(100vh - 133px)',\n          pageSize: 50,\n          pageSizeOptions: [50, 100, 500],\n          debounceInterval: 750,\n          emptyRowsWhenPaging: false,\n          search: false\n        }}\n      />\n    </div>\n  )\n}\n\nconst mapStateToProps = (states: RootState): UserServiceProps => {\n  return {\n    userService: states.session.userService\n  }\n}\n\nexport default connect(mapStateToProps)(withRouter(MyOrders))\n","import React, { useState, useEffect } from 'react'\nimport { connect } from 'react-redux'\nimport { withRouter, RouteComponentProps } from 'react-router-dom'\nimport { makeStyles, Theme, createStyles } from '@material-ui/core/styles'\nimport Stepper from '@material-ui/core/Stepper'\nimport Step from '@material-ui/core/Step'\nimport StepLabel from '@material-ui/core/StepLabel'\nimport Button from '@material-ui/core/Button'\nimport Tooltip from '@material-ui/core/Tooltip'\nimport IconButton from '@material-ui/core/IconButton'\nimport Typography from '@material-ui/core/Typography'\nimport Grid from '@material-ui/core/Grid'\nimport Paper from '@material-ui/core/Paper'\nimport TextField from '@material-ui/core/TextField'\nimport InputAdornment from '@material-ui/core/InputAdornment'\nimport Box from '@material-ui/core/Box'\nimport BackIcon from '@material-ui/icons/ArrowBack'\nimport Link from '@material-ui/core/Link'\n\nimport NavBar from './NavBar'\nimport {\n  useCartService,\n  emptyCart,\n  addStoreCreditToCart,\n  validateLineItems,\n  setDonationAmount\n} from '../services/useCartService'\nimport CartTable from './CartTable'\nimport Login from './Login'\nimport { Order, OrderLineItem } from '../types/Order'\nimport { BLANK_ORDER, API_HOST } from '../constants'\nimport { UserService, UserServiceProps } from '../redux/session/reducers'\nimport { RootState } from '../redux'\nimport SquarePayment from './SquarePayment'\nimport { fetchStoreCredit } from './MyOrders'\n\nconst registrationStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    opt: {\n      display: 'flex',\n      flexDirection: 'column',\n      padding: `${theme.spacing(4)}px 0`,\n      alignItems: 'center'\n    },\n    optItem: {\n      display: 'flex',\n      justifyContent: 'space-between',\n      alignItems: 'center',\n      marginBottom: theme.spacing(2),\n      maxWidth: '350px',\n      width: '50%',\n      [theme.breakpoints.down('xs')]: {\n        width: '100%',\n        maxWidth: 'unset'\n      }\n    }\n  })\n)\n\nfunction Registration(\n  props: {\n    handleNext: () => void\n    history: any\n    setCanGoToNextStep: React.Dispatch<React.SetStateAction<boolean>>\n  } & StepButtonsProps &\n    UserServiceProps\n) {\n  const classes = registrationStyles()\n  const [opt, setOpt] = useState<'login' | 'register' | 'guest' | undefined>()\n\n  const {\n    setCanGoToNextStep,\n    handleNext,\n    backDisabled,\n    handleBack,\n    nextDisabled,\n    nextText,\n    userService\n  } = props\n\n  useEffect(() => {\n    if (userService && userService.user && userService.user.id) {\n      handleNext && handleNext()\n    } else {\n      setCanGoToNextStep(false)\n    }\n  }, [setCanGoToNextStep, userService, handleNext])\n\n  const onCanContinue = () => {\n    setCanGoToNextStep(true)\n    handleNext()\n  }\n\n  return (\n    <>\n      <Paper>\n        {opt && (\n          <Tooltip aria-label=\"back\" title=\"back\">\n            <IconButton onClick={() => setOpt(undefined)}>\n              <BackIcon />\n            </IconButton>\n          </Tooltip>\n        )}\n        {!opt && (\n          <div className={classes.opt}>\n            <div className={classes.optItem}>\n              <Typography variant=\"body1\" gutterBottom>\n                Already a member?\n              </Typography>\n              <Button\n                variant=\"contained\"\n                color=\"primary\"\n                onClick={() => setOpt('login')}\n              >\n                Sign In\n              </Button>\n            </div>\n            <div className={classes.optItem}>\n              <Typography variant=\"body1\" gutterBottom>\n                Want to become a member?\n              </Typography>\n              <Button\n                color=\"secondary\"\n                onClick={() => props.history.push('/register')}\n              >\n                Join the Co-op\n              </Button>\n            </div>\n            {/* <div className={classes.optItem}>\n              <Typography variant=\"body1\" gutterBottom>\n                ...or continue as a\n              </Typography>\n              <Button onClick={() => onCanContinue()}>Guest</Button>\n            </div> */}\n          </div>\n        )}\n\n        {opt === 'login' && <Login onLoginFn={onCanContinue} />}\n      </Paper>\n      <StepButtons\n        {...{ backDisabled, handleBack, nextDisabled, handleNext, nextText }}\n      />\n    </>\n  )\n}\n\nconst reviewStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    infoContainer: {\n      padding: theme.spacing(2),\n      height: '100%',\n      display: 'flex',\n      flexDirection: 'column',\n      alignItems: 'center',\n      '& .MuiFormHelperText-root': {\n        color: theme.palette.error.main,\n        textAlign: 'right'\n      }\n    },\n    donateBoxFlex: {\n      marginTop: theme.spacing(4),\n      display: 'flex',\n      justifyContent: 'space-between'\n    },\n    twoPickups: {\n      marginTop: theme.spacing(4)\n    },\n    storeCredit: {\n      marginTop: theme.spacing(4)\n    }\n  })\n)\n\ninterface ReviewCartProps {\n  setCanGoToNextStep: React.Dispatch<React.SetStateAction<boolean>>\n  setOrder: React.Dispatch<React.SetStateAction<Order>>\n}\n\nfunction ReviewCart(\n  props: ReviewCartProps & StepButtonsProps & UserServiceProps\n) {\n  const classes = reviewStyles()\n  const cartResult = useCartService()\n  const {\n    setCanGoToNextStep,\n    backDisabled,\n    handleBack,\n    nextDisabled,\n    nextText,\n    setOrder,\n    userService\n  } = props\n\n  const [email, setEmail] = useState('')\n  const [phone, setPhone] = useState('')\n  const [name, setName] = useState('')\n  const [address, setAddress] = useState('')\n  const [notes, setNotes] = useState('')\n  const [storeCredit, setStoreCredit] = useState(0)\n  const [applyStoreCreditDisabled, setApplyStoreCreditDisabled] = useState(\n    false\n  )\n\n  useEffect(() => {\n    if (\n      cartResult.status === 'loaded' &&\n      cartResult.payload.line_items.length\n    ) {\n      const adjustments = cartResult.payload.line_items.filter(\n        (li) => li.kind === 'adjustment'\n      )\n      if (adjustments && adjustments.length) {\n        setApplyStoreCreditDisabled(true)\n      } else {\n        setApplyStoreCreditDisabled(false)\n      }\n\n      // validateCart and drop invalid items\n      validateLineItems({ removeInvalidLineItems: true })\n\n      // #TODO: check order for both ON HAND and backorder products\n    }\n  }, [cartResult])\n\n  useEffect(() => {\n    userService.user &&\n      fetch(`${API_HOST}/member/me`, {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        credentials: 'include'\n      })\n        .then((r) => r.json())\n        .then((response) => {\n          const member = response.member\n          if (member) {\n            member.name && setName(member.name)\n            member.phone && setPhone(member.phone)\n            member.address && setAddress(member.address)\n          }\n          setEmail(\n            userService.user && userService.user.email\n              ? userService.user.email\n              : ''\n          )\n          setOrder((prevOrder) => ({\n            ...prevOrder,\n            UserId:\n              userService.user && userService.user.id\n                ? userService.user.id\n                : undefined,\n            MemberId: member && member.id ? member.id : undefined\n          }))\n        })\n        .catch((err) => console.warn('onoz /member/me caught err:', err))\n    userService.user && fetchStoreCredit(setStoreCredit)\n  }, [setOrder, userService])\n\n  useEffect(() => {\n    setCanGoToNextStep && setCanGoToNextStep(!!(email && phone && name))\n  }, [setCanGoToNextStep, email, phone, name])\n\n  function handleNext() {\n    const cartItems =\n      cartResult.status === 'loaded' && cartResult.payload.line_items\n        ? (cartResult.payload.line_items as OrderLineItem[])\n        : ([] as OrderLineItem[])\n\n    setOrder((order) => ({\n      ...order,\n      email,\n      phone,\n      name,\n      address,\n      notes,\n      item_count: cartItems.length,\n      OrderLineItems: [\n        ...cartItems,\n        ...order.OrderLineItems.filter((li) => li.kind !== 'product')\n      ]\n    }))\n\n    props.handleNext()\n  }\n\n  function applyStoreCredit() {\n    !applyStoreCreditDisabled && addStoreCreditToCart(storeCredit)\n    setApplyStoreCreditDisabled(true)\n  }\n\n  return (\n    <>\n      <Paper className={classes.infoContainer}>\n        <Grid container justify=\"center\" direction=\"row\" spacing={2}>\n          <Grid item xs={12} md={4}>\n            <TextField\n              label=\"email\"\n              name=\"email\"\n              type=\"text\"\n              value={email}\n              onChange={(event: any) => setEmail(event.target.value)}\n              autoFocus\n              fullWidth\n              helperText=\"Required\"\n              required\n            />\n            <TextField\n              label=\"name\"\n              name=\"name\"\n              type=\"text\"\n              value={name}\n              onChange={(event: any) => setName(event.target.value)}\n              fullWidth\n              helperText=\"Required\"\n              required\n            />\n            <TextField\n              label=\"phone\"\n              name=\"phone\"\n              type=\"phone\"\n              value={phone}\n              onChange={(event: any) => setPhone(event.target.value)}\n              fullWidth\n              helperText=\"Required\"\n              required\n            />\n            <TextField\n              label=\"address\"\n              name=\"address\"\n              type=\"text\"\n              value={address}\n              onChange={(event: any) => setAddress(event.target.value)}\n              fullWidth\n            />\n            <TextField\n              label=\"notes\"\n              name=\"notes\"\n              type=\"text\"\n              value={notes}\n              onChange={(event: any) => setNotes(event.target.value)}\n              multiline\n              rowsMax=\"10\"\n              fullWidth\n            />\n\n            <Box className={classes.donateBoxFlex}>\n              <Typography variant=\"overline\">\n                MAKE A DONATION -- Help purchase GROCERY BUNDLES for others\n              </Typography>\n              <TextField\n                label=\"any amount\"\n                name=\"donation\"\n                type=\"number\"\n                // value={donationAmount}\n                onChange={(event: any) =>\n                  setDonationAmount(\n                    isNaN(parseFloat(event.target.value))\n                      ? 0\n                      : +parseFloat(event.target.value).toFixed(2)\n                  )\n                }\n                inputProps={{\n                  min: 0\n                }}\n                InputProps={{\n                  startAdornment: (\n                    <InputAdornment position=\"start\">$</InputAdornment>\n                  )\n                }}\n                size=\"small\"\n              />\n            </Box>\n\n            {storeCredit !== 0 && (\n              <Box className={classes.storeCredit}>\n                <Typography variant=\"overline\" display=\"block\">\n                  You have ${Math.abs(storeCredit).toFixed(2)} in store credit\n                </Typography>\n                <Button\n                  disabled={applyStoreCreditDisabled}\n                  onClick={applyStoreCredit}\n                  variant=\"contained\"\n                  color=\"secondary\"\n                >\n                  {applyStoreCreditDisabled\n                    ? 'Store credit applied'\n                    : 'Apply store credit to this order'}\n                </Button>\n              </Box>\n            )}\n          </Grid>\n          <Grid item xs={12} md={8}>\n            {cartResult.status !== 'loaded' && 'Loading...'}\n            {cartResult.status === 'loaded' &&\n              cartResult.payload.line_items.length > 0 && (\n                <CartTable\n                  line_items={cartResult.payload.line_items}\n                  setOrder={setOrder}\n                  checkout\n                />\n              )}\n          </Grid>\n        </Grid>\n      </Paper>\n      <StepButtons\n        {...{ backDisabled, handleBack, nextDisabled, handleNext, nextText }}\n      />\n    </>\n  )\n}\n\nconst paymentStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    paymentContainer: {\n      height: '100%',\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center'\n    },\n    freeOrPayButtonz: {\n      display: 'flex',\n      flexDirection: 'column',\n      justifyContent: 'space-between',\n      alignItems: 'center'\n    },\n    freeOrPayButton: {\n      margin: theme.spacing(2),\n      marginTop: theme.spacing(4)\n    },\n    error: {\n      display: 'flex',\n      flexDirection: 'column',\n      textAlign: 'right',\n      padding: theme.spacing(2)\n    }\n  })\n)\n\nfunction Payment(\n  props: {\n    setCanGoToNextStep: React.Dispatch<React.SetStateAction<boolean>>\n    order: Order\n    userService: UserService\n  } & StepButtonsProps\n) {\n  const classes = paymentStyles()\n  const cartResult = useCartService()\n  const {\n    setCanGoToNextStep,\n    backDisabled,\n    handleBack,\n    nextDisabled,\n    nextText,\n    order\n  } = props\n\n  const [error, setError] = useState('')\n  const [loading, setLoading] = useState(false)\n  const [canPayLater, setCanPayLater] = useState(false)\n  const [isFree, setIsFree] = useState(false)\n\n  useEffect(() => {\n    // if the total of the order is zero, skip CC payment.\n    setIsFree(parseInt(`${order.total}`) === 0)\n  }, [order.total])\n\n  useEffect(() => {\n    if (!order || !order.OrderLineItems) {\n      return\n    }\n    // if all products in cart are on_hand then user can skip CC payment.\n    setCanPayLater(\n      order.OrderLineItems.filter((oli) => oli?.kind === 'product').every(\n        (oli) => oli?.selected_unit === 'EA'\n      ) &&\n        order.OrderLineItems.filter((oli) => oli?.kind === 'product').every(\n          (oli) =>\n            oli?.data?.product?.count_on_hand &&\n            oli?.data?.product?.count_on_hand >= oli?.quantity\n        )\n    )\n  }, [order])\n\n  useEffect(() => {\n    setCanGoToNextStep(false)\n  }, [setCanGoToNextStep])\n\n  function handleNext(nonce: string) {\n    setError('')\n    setLoading(true)\n\n    const path =\n      isFree || canPayLater ? '/store/freecheckout' : '/store/checkout'\n    const body = isFree || canPayLater ? { order } : { order, nonce }\n\n    fetch(`${API_HOST}${path}`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      credentials: 'include',\n      body: JSON.stringify(body)\n    })\n      .then((r) => r.json())\n      .then((response) => {\n        if (response.error) {\n          console.warn('/store/checkout ERROR response:', response)\n          setError(response.msg || 'onoz! could not submit your order ;(')\n        } else {\n          emptyCart()\n          props.handleNext()\n        }\n      })\n      .catch((err) => {\n        console.warn('onoz! caught error /store/checkout err:', err)\n        setError('onoz! could not submit your order ;(')\n      })\n      .finally(() => setLoading(false))\n  }\n\n  return (\n    <>\n      <Paper>\n        <Grid container justify=\"center\" direction=\"row\">\n          <Grid item xs={12} md={6}>\n            {cartResult.status !== 'loaded' && 'Loading...'}\n            {cartResult.status === 'loaded' &&\n              cartResult.payload.line_items.length > 0 && (\n                <CartTable\n                  line_items={cartResult.payload.line_items}\n                  checkout\n                  summary\n                />\n              )}\n          </Grid>\n          <Grid item xs={12} md={6}>\n            <div className={classes.paymentContainer}>\n              {isFree || canPayLater ? (\n                isFree ? (\n                  <>\n                    <Button\n                      variant=\"contained\"\n                      color=\"primary\"\n                      size=\"large\"\n                      onClick={() => handleNext('')}\n                      disabled={!order || order.OrderLineItems.length === 0}\n                    >\n                      Complete Order\n                    </Button>\n                  </>\n                ) : (\n                  <div className={classes.freeOrPayButtonz}>\n                    <Typography variant=\"body1\" display=\"block\" gutterBottom>\n                      Pay now or at pick-up\n                    </Typography>\n                    <div>\n                      <Button\n                        variant=\"contained\"\n                        color=\"primary\"\n                        size=\"large\"\n                        onClick={() => setCanPayLater(false)}\n                        disabled={!order || order.OrderLineItems.length === 0}\n                        className={classes.freeOrPayButton}\n                      >\n                        Make a Payment\n                      </Button>\n                    </div>\n                    <div>\n                      <Button\n                        variant=\"contained\"\n                        color=\"primary\"\n                        size=\"large\"\n                        onClick={() => handleNext('')}\n                        disabled={!order || order.OrderLineItems.length === 0}\n                        className={classes.freeOrPayButton}\n                      >\n                        Complete Order and Pay Later\n                      </Button>\n                    </div>\n                  </div>\n                )\n              ) : (\n                <SquarePayment\n                  handleNext={handleNext}\n                  loading={loading}\n                  amount={order.total * 100}\n                />\n              )}\n            </div>\n          </Grid>\n          {error && (\n            <Grid item xs={12}>\n              <Box color=\"error.main\" className={classes.error}>\n                <Typography variant=\"overline\" display=\"block\">\n                  onoz! an error!\n                </Typography>\n                <Typography variant=\"body1\" display=\"block\" gutterBottom>\n                  {error}\n                </Typography>\n              </Box>\n            </Grid>\n          )}\n        </Grid>\n      </Paper>\n      <StepButtons\n        {...{ backDisabled, handleBack, nextDisabled, nextText }}\n        handleNext={props.handleNext}\n      />\n    </>\n  )\n}\n\nconst stepButtonsStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      display: 'flex',\n      justifyContent: 'flex-end',\n      marginTop: theme.spacing(2)\n    },\n    button: {\n      marginLeft: theme.spacing(2)\n    }\n  })\n)\n\ninterface StepButtonsProps {\n  backDisabled: boolean\n  handleBack: () => void\n  nextDisabled: boolean\n  handleNext: () => void\n  nextText: string\n}\n\nfunction StepButtons(props: StepButtonsProps) {\n  const classes = stepButtonsStyles()\n\n  const { backDisabled, handleBack, nextDisabled, handleNext, nextText } = props\n  return (\n    <div className={classes.root}>\n      <Button\n        disabled={backDisabled}\n        onClick={handleBack}\n        className={classes.button}\n      >\n        Back\n      </Button>\n\n      {nextText !== 'Finish' && (\n        <Button\n          disabled={nextDisabled}\n          variant=\"contained\"\n          color=\"primary\"\n          onClick={handleNext}\n          className={classes.button}\n        >\n          {nextText}\n        </Button>\n      )}\n    </div>\n  )\n}\n\nconst checkoutStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      width: '100%',\n      padding: theme.spacing(2)\n    },\n    instructions: {\n      marginTop: theme.spacing(2),\n      marginBottom: theme.spacing(2)\n    },\n    stepBtnz: {\n      display: 'flex',\n      justifyContent: 'flex-end',\n      marginTop: theme.spacing(2)\n    },\n    finished: {\n      minHeight: '300px',\n      width: '100%',\n      display: 'flex',\n      flexDirection: 'column',\n      justifyContent: 'center',\n      alignItems: 'center'\n    }\n  })\n)\n\nfunction getSteps() {\n  return ['Member Registration', 'Review Order', 'Payment']\n}\n\nfunction Checkout(props: UserServiceProps & RouteComponentProps) {\n  const classes = checkoutStyles()\n  const { userService, history } = props\n\n  const [activeStep, setActiveStep] = useState(0)\n  const [canGoToNextStep, setCanGoToNextStep] = useState(false)\n  const [order, setOrder] = useState<Order>(BLANK_ORDER)\n\n  const steps = getSteps()\n\n  const handleNext = () => {\n    setActiveStep((prevActiveStep) => prevActiveStep + 1)\n  }\n\n  const handleBack = () => {\n    setActiveStep((prevActiveStep) => prevActiveStep - 1)\n  }\n\n  return (\n    <>\n      <NavBar showCart={false} />\n      <div className={classes.root}>\n        <Stepper activeStep={activeStep}>\n          {steps.map((label, index) => {\n            const stepProps: { completed?: boolean } = {}\n            const labelProps: { optional?: React.ReactNode } = {}\n            return (\n              <Step key={label} {...stepProps}>\n                <StepLabel {...labelProps}>{label}</StepLabel>\n              </Step>\n            )\n          })}\n        </Stepper>\n        <div>\n          {activeStep === steps.length ? (\n            <Paper className={classes.finished}>\n              <Typography className={classes.instructions} display=\"block\">\n                THANK YOU!\n              </Typography>\n              <Typography className={classes.instructions} display=\"block\">\n                A receipt has been emailed to you.\n              </Typography>\n              <Typography className={classes.instructions} display=\"block\">\n                See the{' '}\n                <Link\n                  color=\"secondary\"\n                  href=\"https://marshlife-art.org/marsh-food-cooperative-schedule/\"\n                >\n                  MARSH Food Cooperative Ordering and Pick-up Schedule\n                </Link>{' '}\n                for more information.\n              </Typography>\n            </Paper>\n          ) : (\n            <div>\n              {activeStep === 0 && (\n                <Registration\n                  handleNext={handleNext}\n                  setCanGoToNextStep={setCanGoToNextStep}\n                  backDisabled={true}\n                  handleBack={handleBack}\n                  nextDisabled={!canGoToNextStep || activeStep === 0}\n                  nextText={activeStep === steps.length - 1 ? 'Finish' : 'Next'}\n                  userService={userService}\n                  history={history}\n                />\n              )}\n              {activeStep === 1 && (\n                <ReviewCart\n                  setCanGoToNextStep={setCanGoToNextStep}\n                  backDisabled={true}\n                  handleBack={handleBack}\n                  nextDisabled={!canGoToNextStep}\n                  handleNext={handleNext}\n                  nextText={activeStep === steps.length - 1 ? 'Finish' : 'Next'}\n                  setOrder={setOrder}\n                  userService={userService}\n                />\n              )}\n              {activeStep === 2 && (\n                <Payment\n                  setCanGoToNextStep={setCanGoToNextStep}\n                  backDisabled={false}\n                  handleBack={handleBack}\n                  nextDisabled={!canGoToNextStep}\n                  handleNext={handleNext}\n                  nextText={activeStep === steps.length - 1 ? 'Finish' : 'Next'}\n                  order={order}\n                  userService={userService}\n                />\n              )}\n            </div>\n          )}\n        </div>\n      </div>\n    </>\n  )\n}\n\nconst mapStateToProps = (states: RootState): UserServiceProps => {\n  return {\n    userService: states.session.userService\n  }\n}\n\nexport default connect(mapStateToProps)(withRouter(Checkout))\n","import React, { useEffect, useState } from 'react'\nimport { connect } from 'react-redux'\nimport { ThunkDispatch } from 'redux-thunk'\nimport { withRouter, RouteComponentProps } from 'react-router-dom'\nimport Container from '@material-ui/core/Container'\nimport Box from '@material-ui/core/Box'\nimport Typography from '@material-ui/core/Typography'\nimport Radio from '@material-ui/core/Radio'\nimport RadioGroup from '@material-ui/core/RadioGroup'\nimport FormHelperText from '@material-ui/core/FormHelperText'\nimport FormControlLabel from '@material-ui/core/FormControlLabel'\nimport FormControl from '@material-ui/core/FormControl'\nimport FormLabel from '@material-ui/core/FormLabel'\nimport FormGroup from '@material-ui/core/FormGroup'\nimport Checkbox from '@material-ui/core/Checkbox'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport SquarePayment from './SquarePayment'\nimport { Slider } from '@material-ui/core'\nimport { Member } from '../types/Member'\nimport { User } from '../types/User'\nimport { RootState } from '../redux'\nimport { UserServiceProps } from '../redux/session/reducers'\nimport { register } from '../redux/session/actions'\nimport { API_HOST } from '../constants'\n\nconst useStyles = makeStyles((theme) => ({\n  form: {\n    width: '100%',\n    // minHeight: '100vh',\n    marginTop: theme.spacing(1),\n    display: 'flex',\n    flexDirection: 'column',\n    justifyContent: 'center',\n    '& .MuiFormHelperText-root': {\n      color: theme.palette.error.main,\n      textAlign: 'right'\n    }\n  },\n  title: {\n    display: 'flex',\n    justifyContent: 'space-between',\n    alignItems: 'flex-end',\n    marginBottom: theme.spacing(2)\n  },\n  notice: {\n    marginTop: theme.spacing(4),\n    marginBottom: theme.spacing(1)\n  },\n  formControl: {\n    margin: `${theme.spacing(2)}px 0`,\n    '& legend': {\n      fontSize: '1.25rem',\n      marginTop: theme.spacing(2),\n      marginBottom: theme.spacing(1)\n    }\n  },\n  slider: {\n    margin: theme.spacing(4),\n    marginRight: '50px',\n    maxWidth: '83vw'\n  },\n  submit: {\n    margin: theme.spacing(3, 0, 2)\n  },\n  paymentContainer: {\n    height: '100%',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginBottom: '33vh'\n  },\n  natValid: {\n    marginTop: theme.spacing(5)\n  },\n  continueWrapper: {\n    marginTop: theme.spacing(4),\n    textAlign: 'center'\n  }\n}))\n\ninterface OwnProps {}\n\ninterface DispatchProps {\n  register: (\n    user: Partial<User>,\n    member: Partial<Member>,\n    nonce: string\n  ) => void\n}\n\ntype Props = RouteComponentProps & UserServiceProps & DispatchProps\n\nfunction Register(props: Props) {\n  const { history, userService } = props\n  const classes = useStyles()\n  // const [error, setError] = useState('')\n  const [purchaseshare, setPurchaseshare] = useState('')\n  const [understandBylaws, setUnderstandBylaws] = useState(false)\n  const [registrationFee, setRegistrationFee] = useState(100)\n  const [subsityAmount, setSubsityAmount] = useState(99)\n  const [otherexpexplain, setOtherexpexplain] = useState(false)\n  const [userData, setUserData] = useState<Partial<User>>({})\n  const [member, setMember] = useState<Partial<Member>>({})\n  const [memberData, setMemberData] = useState<object>({})\n\n  const [valid, setValid] = useState(false)\n  const [validEmail, setValidEmail] = useState<boolean | undefined>(undefined)\n  const [complete, setComplete] = useState(false)\n\n  const doRegister = (nonce: string) => {\n    // console.log(\n    //   'doRegister understandBylaws:',\n    //   understandBylaws,\n    //   ' userData:',\n    //   userData,\n    //   ' menber:',\n    //   member,\n    //   ' memberData:',\n    //   memberData,\n    //   ' nonce:',\n    //   nonce\n    // )\n\n    props.register(\n      userData,\n      { ...member, data: memberData, fees_paid: registrationFee },\n      nonce\n    )\n  }\n\n  useEffect(() => {\n    if (userService.user && !userService.isFetching && userService.user.role) {\n      // console.log('we gotta user!', userService.user)\n      setComplete(true)\n    } else {\n      setComplete(false)\n    }\n  }, [userService])\n\n  const handlePurchaseShareChange = (\n    event: React.ChangeEvent<HTMLInputElement>,\n    value: string\n  ) => {\n    // console.log('handlePurchaseShareChange value:', value)\n    setRegistrationFee(100)\n    setSubsityAmount(99)\n    setPurchaseshare(value)\n  }\n\n  function valuetext(value: number) {\n    return `$${value.toFixed(2)}`\n  }\n\n  function handleUserDataChange(event: React.ChangeEvent<HTMLInputElement>) {\n    event.persist()\n    event &&\n      event.target &&\n      setUserData((data) => ({\n        ...data,\n        [event.target.name]: event.target.value\n      }))\n  }\n\n  function handleMemberChange(event: React.ChangeEvent<HTMLInputElement>) {\n    event.persist()\n    event &&\n      event.target &&\n      setMember((member) => ({\n        ...member,\n        [event.target.name]: event.target.value\n      }))\n  }\n\n  function checkValidEmail(event: any) {\n    // console.log('checkValidEmail!! userData.email:', userData.email)\n    if (userData.email && userData.email.length) {\n      // console.log('checkValidEmail checking email..')\n      fetch(`${API_HOST}/register/check`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          email: userData.email\n        })\n      })\n        .then((r) => r.json())\n        .then((response) => {\n          // console.log('/register/check response:', response)\n          setValidEmail(!!response && response.valid)\n        })\n        .catch((err) => console.warn('onoz! register/check err:', err))\n    } else {\n      setValidEmail(undefined)\n    }\n  }\n\n  useEffect(() => {\n    setValid(\n      !!(\n        purchaseshare &&\n        understandBylaws &&\n        userData.email &&\n        userData.password &&\n        member.name &&\n        member.phone\n      )\n    )\n  }, [purchaseshare, understandBylaws, userData, member])\n\n  return (\n    <Container maxWidth=\"sm\">\n      {!complete ? (\n        <form className={classes.form}>\n          <div className={classes.title}>\n            <Typography variant=\"h2\" display=\"block\">\n              Join the Co-op\n            </Typography>\n          </div>\n          <TextField\n            label=\"email\"\n            name=\"email\"\n            type=\"text\"\n            helperText={\n              validEmail === false ? 'that email is already taken!' : 'Required'\n            }\n            onChange={handleUserDataChange}\n            onBlur={checkValidEmail}\n            fullWidth\n            required\n            autoFocus\n          />\n          <TextField\n            label=\"password\"\n            name=\"password\"\n            type=\"password\"\n            helperText=\"Required\"\n            onChange={handleUserDataChange}\n            fullWidth\n            required\n          />\n          <TextField\n            label=\"name\"\n            name=\"name\"\n            type=\"text\"\n            helperText=\"Required\"\n            onChange={handleMemberChange}\n            fullWidth\n            required\n          />\n          <TextField\n            label=\"phone\"\n            name=\"phone\"\n            type=\"phone\"\n            helperText=\"Required\"\n            onChange={handleMemberChange}\n            fullWidth\n            required\n          />\n          <TextField\n            label=\"address\"\n            name=\"address\"\n            type=\"text\"\n            onChange={handleMemberChange}\n            fullWidth\n          />\n\n          <p className={classes.notice}>\n            <i>\n              By purchasing a share in the co-op, I understand that I am an\n              equal owner in the enterprise and am eligible to vote on co-op\n              matters and in board elections and to make proposals for the use\n              of the kitchen and event space. I agree to pay for and pick up my\n              groceries in a timely manner and to collaborate with others for\n              the benefit of my co-members and the community at large. I\n              understand that Member shares cost $100 and I can request a\n              subsidy or contribute to subsidies for others.\n            </i>\n          </p>\n\n          <FormControl component=\"fieldset\" className={classes.formControl}>\n            <FormLabel component=\"legend\">Purchase Share:</FormLabel>\n            <RadioGroup\n              aria-label=\"purchaseshare\"\n              name=\"purchaseshare\"\n              // value={value}\n              onChange={handlePurchaseShareChange}\n            >\n              <FormControlLabel\n                value=\"oneshare\"\n                control={<Radio />}\n                label=\"I am purchasing a share for $100.\"\n              />\n              <FormControlLabel\n                value=\"requestsubsidy\"\n                control={<Radio />}\n                label=\"I can pay some for my share and am requesting a subsidy.\"\n              />\n              {purchaseshare === 'requestsubsidy' && (\n                <Slider\n                  className={classes.slider}\n                  getAriaValueText={valuetext}\n                  value={subsityAmount}\n                  onChange={(_, amt: number | number[]) => {\n                    setSubsityAmount(Array.isArray(amt) ? amt[0] : amt)\n                    setRegistrationFee(Array.isArray(amt) ? amt[0] : amt)\n                  }}\n                  step={1}\n                  min={25}\n                  max={99}\n                  marks={[\n                    {\n                      value: 25,\n                      label: '$25'\n                    },\n                    {\n                      value: 99,\n                      label: '$99'\n                    }\n                  ]}\n                  valueLabelDisplay=\"on\"\n                />\n              )}\n              <FormControlLabel\n                value=\"payadditional\"\n                control={<Radio />}\n                label=\"I can pay $100 and would like to pay an additional amount to\n              subsidize others.\"\n              />\n              {purchaseshare === 'payadditional' && (\n                <Slider\n                  className={classes.slider}\n                  getAriaValueText={valuetext}\n                  value={registrationFee}\n                  onChange={(_, amt: number | number[]) =>\n                    setRegistrationFee(Array.isArray(amt) ? amt[0] : amt)\n                  }\n                  step={1}\n                  min={101}\n                  max={1000}\n                  marks={[\n                    {\n                      value: 150,\n                      label: '$150'\n                    },\n                    {\n                      value: 250,\n                      label: '$250'\n                    },\n                    {\n                      value: 350,\n                      label: '$350'\n                    },\n                    {\n                      value: 500,\n                      label: '$500'\n                    }\n                  ]}\n                  valueLabelDisplay=\"on\"\n                />\n              )}\n            </RadioGroup>\n            <FormHelperText>Required</FormHelperText>\n          </FormControl>\n\n          <FormControl component=\"fieldset\" className={classes.formControl}>\n            <FormLabel component=\"legend\">Check any that apply:</FormLabel>\n            <FormGroup>\n              <FormControlLabel\n                control={\n                  <Checkbox\n                    onChange={(\n                      event: React.ChangeEvent<HTMLInputElement>,\n                      checked: boolean\n                    ) => {\n                      setMemberData((data) => ({\n                        ...data,\n                        workerOwner: checked\n                      }))\n                    }}\n                    value=\"worker-owner\"\n                  />\n                }\n                label=\"I may be interested in participating in the co-op as a worker-owner.\"\n              />\n              <FormControlLabel\n                control={\n                  <Checkbox\n                    onChange={(\n                      event: React.ChangeEvent<HTMLInputElement>,\n                      checked: boolean\n                    ) => {\n                      setMemberData((data) => ({ ...data, producer: checked }))\n                    }}\n                    value=\"producer-owner\"\n                  />\n                }\n                label=\"I may be interested in participating in the co-op as a producer.\"\n              />\n              <FormControlLabel\n                control={\n                  <Checkbox\n                    onChange={(\n                      event: React.ChangeEvent<HTMLInputElement>,\n                      checked: boolean\n                    ) => {\n                      setMemberData((data) => ({\n                        ...data,\n                        kitchenExperience: checked\n                      }))\n                    }}\n                    value=\"kitchenexp\"\n                  />\n                }\n                label=\"I have kitchen experience.\"\n              />\n              <FormControlLabel\n                control={\n                  <Checkbox\n                    onChange={(\n                      event: React.ChangeEvent<HTMLInputElement>,\n                      checked: boolean\n                    ) => {\n                      setMemberData((data) => ({\n                        ...data,\n                        farmingGardeningExperience: checked\n                      }))\n                    }}\n                    value=\"farminggardeningexp\"\n                  />\n                }\n                label=\"I have farming/gardening experience.\"\n              />\n              <FormControlLabel\n                control={\n                  <Checkbox\n                    onChange={(_, checked: boolean) =>\n                      setOtherexpexplain(checked)\n                    }\n                    value=\"otherexp\"\n                  />\n                }\n                label=\"I have other relevant experience.\"\n              />\n              {otherexpexplain && (\n                <TextField\n                  label=\"explain\"\n                  name=\"otherexpexplain\"\n                  onChange={(event: React.ChangeEvent<HTMLInputElement>) => {\n                    event.persist()\n                    event &&\n                      event.target &&\n                      setMemberData((data) => ({\n                        ...data,\n                        otherexpExplain: event.target.value\n                      }))\n                  }}\n                  type=\"text\"\n                  multiline\n                  rowsMax=\"10\"\n                  fullWidth\n                />\n              )}\n            </FormGroup>\n          </FormControl>\n\n          <FormControl component=\"fieldset\" className={classes.formControl}>\n            <FormLabel component=\"legend\">\n              MARSH Cooperative Bylaws and principles\n            </FormLabel>\n            <FormGroup>\n              <FormControlLabel\n                control={\n                  <Checkbox\n                    // checked={false}\n                    name=\"understandBylaws\"\n                    onChange={(_, checked: boolean) =>\n                      setUnderstandBylaws(checked)\n                    }\n                    value=\"agree\"\n                  />\n                }\n                label=\"I understand that the MARSH Cooperative Bylaws and principles are\n            available online or upon request and that these documents guide the\n            co-op and its members.\"\n              />\n            </FormGroup>\n            <FormHelperText>Required</FormHelperText>\n          </FormControl>\n\n          <div className={classes.paymentContainer}>\n            {valid && validEmail ? (\n              <SquarePayment\n                handleNext={doRegister}\n                amount={registrationFee * 100}\n                loading={userService.isFetching}\n              />\n            ) : (\n              <Box color=\"error.main\" className={classes.natValid}>\n                <Typography variant=\"overline\" display=\"block\" gutterBottom>\n                  {validEmail === false\n                    ? 'Oh noz! That email is already registered'\n                    : 'Please fill out all the required fields to complete registration.'}\n                </Typography>\n                <Typography variant=\"body1\" display=\"block\" gutterBottom>\n                  Please contact us if you need help.\n                </Typography>\n              </Box>\n            )}\n          </div>\n\n          {/* <Box color=\"error.main\">\n            {error && (\n            <>\n              <Typography variant=\"overline\" display=\"block\">\n                onoz! an error!\n              </Typography>\n              <Typography variant=\"body1\" display=\"block\" gutterBottom>\n                {error}\n              </Typography>\n            </>\n          )}\n          </Box> */}\n        </form>\n      ) : (\n        <Box>\n          <Typography variant=\"overline\" display=\"block\" gutterBottom>\n            Thank you!\n          </Typography>\n          <Typography variant=\"body2\" display=\"block\" gutterBottom>\n            Registration complete. Please check your email for a confirmation\n            link.\n          </Typography>\n          <div className={classes.continueWrapper}>\n            <Button\n              onClick={() => history.push('/')}\n              variant=\"outlined\"\n              size=\"large\"\n            >\n              Continue to the store\n            </Button>\n          </div>\n        </Box>\n      )}\n    </Container>\n  )\n}\n\nconst mapStateToProps = (states: RootState): UserServiceProps => {\n  return {\n    userService: states.session.userService\n  }\n}\n\nconst mapDispatchToProps = (\n  dispatch: ThunkDispatch<{}, {}, any>,\n  ownProps: OwnProps\n): DispatchProps => {\n  return {\n    register: (user, member, nonce) => dispatch(register(user, member, nonce))\n  }\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(withRouter(Register))\n\n// export default withRouter(Register)\n","import React, { useState } from 'react'\nimport { Container, Button, TextField } from '@material-ui/core'\nimport Box from '@material-ui/core/Box'\nimport Typography from '@material-ui/core/Typography'\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport { API_HOST } from '../constants'\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    width: '100%',\n    // minHeight: '100vh',\n    marginTop: theme.spacing(1),\n    display: 'flex',\n    flexDirection: 'column',\n    justifyContent: 'center'\n  },\n  title: {\n    display: 'flex',\n    justifyContent: 'space-between',\n    alignItems: 'flex-end'\n  },\n  submit: {\n    margin: theme.spacing(3, 0, 2)\n  }\n}))\n\nfunction ForgotPassword() {\n  const classes = useStyles()\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState('')\n  const [success, setSuccess] = useState('')\n  const [email, setEmail] = useState('')\n\n  function requestForgotPassword() {\n    setError('')\n    setSuccess('')\n    setLoading(true)\n    if (email && email.length > 0) {\n      fetch(`${API_HOST}/forgotpassword`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({ email })\n      })\n        .then((r) => r.json())\n        .then((response) => {\n          if (response.msg && response.msg === 'ok') {\n            setSuccess(\n              'Please check your email for link to reset your password.'\n            )\n          } else {\n            if (response.error) {\n              setError(response.error)\n            } else {\n              setError('Unknown email.')\n            }\n          }\n        })\n        .catch((err) => setError('Unknown email.'))\n        .finally(() => setLoading(false))\n    } else {\n      setError('...type your email')\n      setLoading(false)\n    }\n  }\n\n  return (\n    <Container maxWidth=\"sm\">\n      <div className={classes.root}>\n        <div className={classes.title}>\n          <Typography variant=\"h2\" display=\"block\">\n            Forgot Password?\n          </Typography>\n        </div>\n        <TextField\n          label=\"email\"\n          name=\"email\"\n          type=\"text\"\n          value={email}\n          onChange={(event: any) => setEmail(event.target.value)}\n          onKeyPress={(event) => {\n            if (event.key === 'Enter') {\n              requestForgotPassword()\n            }\n          }}\n          autoFocus\n          fullWidth\n          required\n        />\n\n        <div>\n          <Button\n            fullWidth\n            variant=\"contained\"\n            color=\"primary\"\n            className={classes.submit}\n            onClick={() => requestForgotPassword()}\n            disabled={loading}\n          >\n            Send reset email\n          </Button>\n        </div>\n\n        {error && (\n          <Box color=\"error.main\">\n            <Typography variant=\"overline\" display=\"block\">\n              onoz! an error!\n            </Typography>\n            <Typography variant=\"body1\" display=\"block\" gutterBottom>\n              {error}\n            </Typography>\n          </Box>\n        )}\n        {success && (\n          <Box>\n            <Typography variant=\"overline\" display=\"block\">\n              Success!\n            </Typography>\n            <Typography variant=\"body1\" display=\"block\" gutterBottom>\n              {success}\n            </Typography>\n          </Box>\n        )}\n      </div>\n    </Container>\n  )\n}\n\nexport default ForgotPassword\n","import React, { useEffect, useState } from 'react'\nimport { connect } from 'react-redux'\nimport { ThunkDispatch } from 'redux-thunk'\nimport { withRouter, RouteComponentProps, useLocation } from 'react-router-dom'\nimport { Container, Button, TextField } from '@material-ui/core'\nimport Box from '@material-ui/core/Box'\nimport Typography from '@material-ui/core/Typography'\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport { RootState } from '../redux'\nimport { resetPassword } from '../redux/session/actions'\nimport { UserServiceProps } from '../redux/session/reducers'\n\ninterface OwnProps {}\n\ninterface DispatchProps {\n  resetPassword: (regKey: string, password: string) => void\n}\n\ntype Props = UserServiceProps & OwnProps & DispatchProps & RouteComponentProps\n\nconst useStyles = makeStyles((theme) => ({\n  form: {\n    width: '100%',\n    // minHeight: '100vh',\n    marginTop: theme.spacing(1),\n    display: 'flex',\n    flexDirection: 'column',\n    justifyContent: 'center'\n  },\n  title: {\n    display: 'flex',\n    justifyContent: 'space-between',\n    alignItems: 'flex-end'\n  },\n  submit: {\n    margin: theme.spacing(3, 0, 2)\n  },\n  forgotpassword: {\n    marginTop: theme.spacing(3)\n  }\n}))\n\nfunction useQuery() {\n  return new URLSearchParams(useLocation().search)\n}\n\nfunction ResetPassword(props: Props) {\n  const { userService, history } = props\n  const classes = useStyles()\n  const [error, setError] = useState('')\n\n  let query = useQuery()\n  const regKey = query.get('regKey')\n  // console.log('[Register] regKey', regKey)\n\n  const doResetPassword = (event: React.FormEvent) => {\n    event.preventDefault()\n    setError('')\n    const target = event.currentTarget as HTMLFormElement\n    const passwordEl = target.elements.namedItem('password') as HTMLInputElement\n    const passwordConfirmEl = target.elements.namedItem(\n      'password_confirm'\n    ) as HTMLInputElement\n\n    if (\n      passwordEl &&\n      passwordEl.value.length > 0 &&\n      passwordConfirmEl &&\n      passwordConfirmEl.value.length > 0 &&\n      passwordEl.value === passwordConfirmEl.value &&\n      regKey\n    ) {\n      props.resetPassword(regKey, passwordEl.value)\n    } else {\n      setError('Please make sure password match!')\n    }\n  }\n\n  // when userService changes, figure out if the page should redirect if a user is already logged in.\n  useEffect(() => {\n    if (userService.user && !userService.isFetching && userService.user.role) {\n      // console.log('we gotta user!', userService.user)\n      history.push('/')\n    }\n    // else if (userService.user && !userService.isFetching) {\n    //   setError('o noz! error! ...hmm??')\n    // }\n  }, [userService, history])\n\n  return (\n    <Container maxWidth=\"sm\">\n      <form onSubmit={doResetPassword} className={classes.form}>\n        <div className={classes.title}>\n          <Typography variant=\"h2\" display=\"block\">\n            Reset Password\n          </Typography>\n        </div>\n        <TextField\n          label=\"password\"\n          name=\"password\"\n          type=\"password\"\n          fullWidth\n          required\n        />\n        <TextField\n          label=\"confirm password\"\n          name=\"password_confirm\"\n          type=\"password\"\n          fullWidth\n          required\n        />\n        <div>\n          <Button\n            type=\"submit\"\n            fullWidth\n            variant=\"contained\"\n            color=\"primary\"\n            disabled={props.userService.isFetching}\n            className={classes.submit}\n          >\n            Reset Password\n          </Button>\n        </div>\n\n        <Box color=\"error.main\">\n          {props.userService.error && (\n            <>\n              <Typography variant=\"overline\" display=\"block\">\n                onoz! an error!\n              </Typography>\n              <Typography variant=\"body1\" display=\"block\" gutterBottom>\n                {props.userService.error.reason}\n              </Typography>\n            </>\n          )}\n          {error && (\n            <>\n              <Typography variant=\"overline\" display=\"block\">\n                onoz! an error!\n              </Typography>\n              <Typography variant=\"body1\" display=\"block\" gutterBottom>\n                {error}\n              </Typography>\n            </>\n          )}\n        </Box>\n      </form>\n    </Container>\n  )\n}\n\nconst mapStateToProps = (\n  states: RootState,\n  ownProps: OwnProps\n): UserServiceProps => {\n  return {\n    userService: states.session.userService\n  }\n}\n\nconst mapDispatchToProps = (\n  dispatch: ThunkDispatch<{}, {}, any>,\n  ownProps: OwnProps\n): DispatchProps => {\n  return {\n    resetPassword: (regKey, password) =>\n      dispatch(resetPassword(regKey, password))\n  }\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(withRouter(ResetPassword))\n","import React, { useState, useEffect } from 'react'\nimport { withRouter, RouteComponentProps } from 'react-router-dom'\nimport { connect } from 'react-redux'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport Paper from '@material-ui/core/Paper'\nimport Box from '@material-ui/core/Box'\nimport Typography from '@material-ui/core/Typography'\n\nimport { API_HOST } from '../constants'\nimport { RootState } from '../redux'\nimport { UserServiceProps } from '../redux/session/reducers'\nimport { Order } from '../types/Order'\nimport OrderDetailPanel from './OrderDetailPanel'\nimport Login from './Login'\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    margin: `0 ${theme.spacing(2)}px`\n  },\n  error: {\n    display: 'flex',\n    width: '100%',\n    minHeight: '66vh',\n    justifyContent: 'center',\n    textAlign: 'center',\n    alignItems: 'center'\n  }\n}))\n\nfunction MyOrders(\n  props: UserServiceProps & RouteComponentProps<{ id?: string }>\n) {\n  const { userService } = props\n  const classes = useStyles()\n  const [order, setOrder] = useState<Order>()\n  const [refetchOrders, setRefetchOrders] = useState(0)\n  const [error, setError] = useState('')\n\n  const orderId = props.match && props.match.params && props.match.params.id\n\n  useEffect(() => {\n    userService.user &&\n      orderId &&\n      fetch(`${API_HOST}/getorder`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        credentials: 'include',\n        body: JSON.stringify({ OrderId: orderId })\n      })\n        .then((r) => r.json())\n        .then((response) => {\n          if (response && response.order) {\n            setOrder(response.order)\n          } else {\n            setError('Order not found!')\n          }\n        })\n        .catch((err) => setError('Order not found!'))\n  }, [userService, orderId, refetchOrders])\n\n  return (\n    <Paper className={classes.root}>\n      {!userService.isFetching &&\n        !(userService.user && userService.user.id !== undefined) && (\n          <Login\n            showTitle\n            onLoginFn={() => setRefetchOrders((prev) => prev + 1)}\n          />\n        )}\n      {order && !error && (\n        <OrderDetailPanel order={order} setRefetchOrders={setRefetchOrders} />\n      )}\n      {error && (\n        <Box color=\"error.main\" className={classes.error}>\n          <Typography variant=\"h3\" display=\"block\" gutterBottom>\n            {error}\n          </Typography>\n        </Box>\n      )}\n    </Paper>\n  )\n}\n\nconst mapStateToProps = (states: RootState): UserServiceProps => {\n  return {\n    userService: states.session.userService\n  }\n}\n\nexport default connect(mapStateToProps)(withRouter(MyOrders))\n","import React, { ReactNode } from 'react'\nimport { withStyles, Theme } from '@material-ui/core/styles'\nimport Typography, { TypographyProps } from '@material-ui/core/Typography'\nimport Link from '@material-ui/core/Link'\nimport Table from '@material-ui/core/Table'\nimport Paper from '@material-ui/core/Paper'\nimport {\n  TableHead,\n  TableRow,\n  TableCell,\n  TableBody,\n  StyledComponentProps,\n  WithStyles\n} from '@material-ui/core'\n\n// mostly ripped from https://gist.github.com/boganegru/a4da0b0da0b1233d30b10063b10efa8a\n\nconst styles = (theme: Theme) => ({\n  listItem: {\n    marginTop: theme.spacing(1)\n  },\n  header: {\n    marginTop: theme.spacing(2)\n  }\n})\n\ninterface WSProps extends WithStyles<typeof styles> {\n  children: ReactNode\n}\n\nfunction MarkdownParagraph(props: { children: ReactNode }) {\n  return <Typography>{props.children}</Typography>\n}\n\ninterface MdHeadingProps {\n  level: number\n}\n\nconst MarkdownHeading = withStyles(styles)(\n  ({\n    classes,\n    ...props\n  }: StyledComponentProps & TypographyProps & MdHeadingProps) => {\n    let variant: TypographyProps['variant']\n    switch (props.level) {\n      case 1:\n        variant = 'h5'\n        break\n      case 2:\n        variant = 'h6'\n        break\n      case 3:\n        variant = 'subtitle1'\n        break\n      case 4:\n        variant = 'subtitle2'\n        break\n      default:\n        variant = 'h6'\n        break\n    }\n    return (\n      <Typography className={classes?.header} gutterBottom variant={variant}>\n        {props.children}\n      </Typography>\n    )\n  }\n)\n\nconst MarkdownListItem = withStyles(styles)(\n  ({ classes, ...props }: WSProps) => {\n    return (\n      <li className={classes.listItem}>\n        <Typography component=\"span\">{props.children}</Typography>\n      </li>\n    )\n  }\n)\n\nfunction MarkdownTable(props: { children: ReactNode }) {\n  return (\n    <Paper>\n      <Table size=\"small\" aria-label=\"a dense table\">\n        {props.children}\n      </Table>\n    </Paper>\n  )\n}\n\nfunction MarkdownTableCell(props: { children: ReactNode }) {\n  return (\n    <TableCell>\n      <Typography>{props.children}</Typography>\n    </TableCell>\n  )\n}\n\nfunction MarkdownTableRow(props: { children: ReactNode }) {\n  return <TableRow>{props.children}</TableRow>\n}\n\nfunction MarkdownTableBody(props: { children: ReactNode }) {\n  return <TableBody>{props.children}</TableBody>\n}\n\nfunction MarkdownTableHead(props: { children: ReactNode }) {\n  return <TableHead>{props.children}</TableHead>\n}\n\nconst renderers = {\n  heading: MarkdownHeading,\n  paragraph: MarkdownParagraph,\n  link: Link,\n  listItem: MarkdownListItem,\n  table: MarkdownTable,\n  tableHead: MarkdownTableHead,\n  tableBody: MarkdownTableBody,\n  tableRow: MarkdownTableRow,\n  tableCell: MarkdownTableCell\n}\n\nexport default renderers\n","import React, { useState, useRef, useEffect } from 'react'\nimport {\n  createStyles,\n  Theme,\n  withStyles,\n  WithStyles\n} from '@material-ui/core/styles'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport IconButton from '@material-ui/core/IconButton'\nimport CloseIcon from '@material-ui/icons/Close'\nimport Typography from '@material-ui/core/Typography'\nimport ReactMarkdown from 'react-markdown'\nimport gfm from 'remark-gfm'\nimport { useDispatch, useSelector } from 'react-redux'\n\nimport { setPreferences } from '../redux/preferences/actions'\nimport { API_HOST } from '../constants'\nimport renderers from './renderers'\nimport { Preferences } from '../types/Preferences'\nimport { RootState } from '../redux'\nimport {\n  openAnnouncement,\n  closeAnnouncement\n} from '../redux/announcement/actions'\n\ninterface Announcement {\n  id: number\n  slug: string\n  createdAt: string\n  content: string\n}\n\nconst styles = (theme: Theme) =>\n  createStyles({\n    root: {\n      margin: 0,\n      padding: theme.spacing(2)\n    },\n    title: {\n      marginRight: 48\n    },\n    closeButton: {\n      position: 'absolute',\n      right: theme.spacing(1),\n      top: theme.spacing(1),\n      color: theme.palette.grey[500]\n    }\n  })\n\ninterface DialogTitleProps extends WithStyles<typeof styles> {\n  id: string\n  children: React.ReactNode\n  onClose: () => void\n}\n\nconst ADialogTitle = withStyles(styles)((props: DialogTitleProps) => {\n  const { children, classes, onClose, ...other } = props\n  return (\n    <DialogTitle disableTypography className={classes.root} {...other}>\n      <Typography variant=\"h6\" className={classes.title}>\n        {children}\n      </Typography>\n      {onClose ? (\n        <IconButton\n          aria-label=\"close\"\n          className={classes.closeButton}\n          onClick={onClose}\n        >\n          <CloseIcon />\n        </IconButton>\n      ) : null}\n    </DialogTitle>\n  )\n})\n\nexport default function Announcements(props: { preferences: Preferences }) {\n  const { preferences } = props\n  const last_seen_announcement = preferences?.last_seen_announcement\n  const open = useSelector(\n    (state: RootState) => state.announcement.announcementService.open\n  )\n  const dispatch = useDispatch()\n  const [announcement, setAnnouncement] = useState<Announcement | null>()\n\n  const handleClose = () => {\n    dispatch(closeAnnouncement())\n  }\n\n  const descriptionElementRef = useRef<HTMLElement>(null)\n  useEffect(() => {\n    if (open) {\n      const { current: descriptionElement } = descriptionElementRef\n      if (descriptionElement !== null) {\n        descriptionElement.focus()\n      }\n    }\n  }, [open])\n\n  useEffect(() => {\n    fetch(`${API_HOST}/page/latest`)\n      .then((response) => response.json())\n      .then((result) => {\n        setAnnouncement(result)\n\n        // check if need to show this announcement\n        if (!isNaN(parseInt(last_seen_announcement))) {\n          if (result.id <= parseInt(last_seen_announcement)) {\n            return\n          }\n        }\n\n        if (result && result.slug && result.content) {\n          dispatch(openAnnouncement())\n          dispatch(\n            setPreferences({\n              ...preferences,\n              last_seen_announcement: `${result.id}`\n            })\n          )\n        }\n      })\n      .catch(console.warn)\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [last_seen_announcement])\n\n  return (\n    <Dialog\n      open={open}\n      onClose={handleClose}\n      scroll=\"paper\"\n      aria-labelledby=\"scroll-dialog-title\"\n      aria-describedby=\"scroll-dialog-description\"\n    >\n      <ADialogTitle id=\"scroll-dialog-title\" onClose={handleClose}>\n        {announcement && announcement.slug}\n      </ADialogTitle>\n\n      <DialogContent dividers={true}>\n        <ReactMarkdown plugins={[gfm]} renderers={renderers}>\n          {announcement ? announcement.content : ''}\n        </ReactMarkdown>\n      </DialogContent>\n    </Dialog>\n  )\n}\n","import React, { useEffect } from 'react'\nimport { BrowserRouter as Router, Switch, Route } from 'react-router-dom'\nimport { connect } from 'react-redux'\nimport { ThunkDispatch } from 'redux-thunk'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport { ThemeProvider } from '@material-ui/core/styles'\n\nimport { darkTheme, lightTheme } from './theme'\nimport { RootState } from './redux'\n\nimport { UserServiceProps } from './redux/session/reducers'\nimport { checkSession } from './redux/session/actions'\n\nimport { PreferencesServiceProps } from './redux/preferences/reducers'\nimport { getPreferences } from './redux/preferences/actions'\n\nimport DataTable from './components/DataTable'\nimport Landing from './components/Landing'\nimport Checkout from './components/Checkout'\nimport Login from './components/Login'\nimport Register from './components/Register'\nimport NavBar from './components/NavBar'\nimport ForgotPassword from './components/ForgotPassword'\nimport ResetPassword from './components/ResetPassword'\nimport MyOrders from './components/MyOrders'\nimport Order from './components/Order'\nimport Announcements from './components/Announcements'\n\ninterface DispatchProps {\n  checkSession: () => void\n  getPreferences: () => void\n}\n\nexport function App(\n  props: PreferencesServiceProps & UserServiceProps & DispatchProps\n) {\n  const { preferencesService, checkSession, getPreferences } = props\n\n  useEffect(() => {\n    getPreferences && getPreferences()\n  }, [getPreferences])\n\n  useEffect(() => {\n    checkSession && checkSession()\n  }, [checkSession])\n\n  const theme =\n    preferencesService &&\n    preferencesService.preferences &&\n    preferencesService.preferences.dark_mode === 'true'\n      ? darkTheme\n      : lightTheme\n\n  return (\n    <ThemeProvider theme={theme}>\n      <CssBaseline />\n      {preferencesService.preferences && (\n        <Announcements preferences={preferencesService.preferences} />\n      )}\n      <Router>\n        <Switch>\n          <Route path=\"/checkout\" exact component={Checkout} />\n          <Route path=\"/products\" exact component={DataTable} />\n          <Route path=\"/products/onhand/:onhand\" exact component={DataTable} />\n          <Route path=\"/products/:cat/\" exact component={DataTable} />\n          <Route path=\"/products/:cat/:subcat\" component={DataTable} />\n          <Route path=\"/orders\" exact>\n            <>\n              <NavBar />\n              <MyOrders />\n            </>\n          </Route>\n          <Route path=\"/order/:id\" exact>\n            <>\n              <NavBar />\n              <Order />\n            </>\n          </Route>\n          <Route path=\"/forgotpassword\" exact>\n            <>\n              <NavBar />\n              <ForgotPassword />\n            </>\n          </Route>\n          <Route path=\"/resetpassword\" exact>\n            <>\n              <NavBar />\n              <ResetPassword />\n            </>\n          </Route>\n          <Route path=\"/login\" exact>\n            <>\n              <NavBar />\n              <Login showTitle />\n            </>\n          </Route>\n          <Route path=\"/register\" exact>\n            <>\n              <NavBar />\n              <Register />\n            </>\n          </Route>\n          <Route path=\"/\" component={Landing} />\n        </Switch>\n      </Router>\n    </ThemeProvider>\n  )\n}\n\nconst mapStateToProps = (\n  states: RootState\n): UserServiceProps & PreferencesServiceProps => {\n  return {\n    userService: states.session.userService,\n    preferencesService: states.preferences.preferencesService\n  }\n}\n\nconst mapDispatchToProps = (\n  dispatch: ThunkDispatch<{}, {}, any>\n): DispatchProps => {\n  return {\n    checkSession: () => dispatch(checkSession()),\n    getPreferences: () => dispatch(getPreferences())\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App)\n","import { combineReducers } from 'redux'\n\nimport { Action } from './actions'\nimport { User, LoginError } from '../../types/User'\n\nexport interface UserService {\n  isFetching: boolean\n  user?: User\n  error?: LoginError\n}\n\nexport interface UserServiceProps {\n  userService: UserService\n}\n\nconst userService = (\n  state: UserService = { isFetching: false },\n  action: Action\n): UserService => {\n  switch (action.type) {\n    case 'SET':\n      return { ...state, user: action.user, error: undefined }\n    case 'SET_FETCHING':\n      return {\n        ...state,\n        isFetching: action.isFetching\n      }\n    case 'SET_ERROR':\n      return { ...state, user: undefined, error: action.error }\n  }\n  return state\n}\n\nexport default combineReducers<UserServiceProps>({\n  userService\n})\n","import { combineReducers } from 'redux'\n\nimport { Action } from './actions'\nimport { Preferences, PreferencesError } from '../../types/Preferences'\n\nexport interface PreferencesService {\n  isFetching: boolean\n  preferences?: Preferences\n  error?: PreferencesError\n}\n\nexport interface PreferencesServiceProps {\n  preferencesService: PreferencesService\n}\n\nconst preferencesService = (\n  state: PreferencesService = { isFetching: false },\n  action: Action\n): PreferencesService => {\n  switch (action.type) {\n    case 'SET_PREFERENCES':\n      return { ...state, preferences: action.preferences, error: undefined }\n    case 'SET_FETCHING_PREFERENCES':\n      return {\n        ...state,\n        isFetching: action.isFetching\n      }\n    case 'SET_ERROR_PREFERENCES':\n      return { ...state, preferences: undefined, error: action.error }\n  }\n  return state\n}\n\nexport default combineReducers<PreferencesServiceProps>({\n  preferencesService\n})\n","import { combineReducers } from 'redux'\n\nimport { Action } from './actions'\n\nexport interface AnnouncementService {\n  open: boolean\n}\nexport interface AnnouncementServiceProps {\n  announcementService: AnnouncementService\n}\n\nconst announcementService = (\n  state: AnnouncementService = { open: false },\n  action: Action\n): AnnouncementService => {\n  if (action.type === 'OPEN') {\n    return {\n      open: true\n    }\n  } else if (action.type === 'CLOSE') {\n    return {\n      open: false\n    }\n  }\n  return state\n}\n\nexport default combineReducers<AnnouncementServiceProps>({\n  announcementService\n})\n","import { createStore, combineReducers, applyMiddleware } from 'redux'\nimport thunk from 'redux-thunk'\nimport session, { UserServiceProps } from './session/reducers'\nimport preferences, { PreferencesServiceProps } from './preferences/reducers'\nimport announcement, {AnnouncementServiceProps} from './announcement/reducers'\n\nexport interface RootState {\n  session: UserServiceProps\n  preferences: PreferencesServiceProps\n  announcement: AnnouncementServiceProps\n}\n\nexport default createStore(\n  combineReducers<RootState>({\n    session,\n    preferences,\n    announcement\n  }),\n  applyMiddleware(thunk)\n)\n","import React from 'react'\nimport ReactDOM from 'react-dom'\n\nimport { Provider } from 'react-redux'\n\nimport './index.css'\nimport App from './App'\n\nimport store from './redux'\n\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.querySelector('#root')\n)\n\n// import * as serviceWorker from './serviceWorker'\n// // If you want your app to work offline and load faster, you can change\n// // unregister() to register() below. Note this comes with some pitfalls.\n// // Learn more about service workers: https://bit.ly/CRA-PWA\n// serviceWorker.unregister()\n"],"sourceRoot":""}